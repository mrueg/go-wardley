(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{2936:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(8742)}])},8742:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>nw});var n=i(6284),s=i(4232),a=i(5560),o=i.n(a);let l=e=>o()({},r,e),r={className:"plain",containerBackground:"#eee",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"12px",stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"black",mapGridTextColor:"black",pipelineArrowHeight:"5",pipelineArrowWidth:"5",strokeWidth:"1",strokeDasharray:"2,2",anchor:{fontSize:"12px"},attitudes:{strokeWidth:"5px",fontSize:"12px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},market:{stroke:"red",fill:"white"},component:{fontSize:"12px",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fill:"white",stroke:"black",evolved:"red",evolvedFill:"white",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5,textColor:"black",textOffset:8,evolvedTextColor:"red"},submap:{fontSize:"12px",fill:"black",stroke:"black",evolved:"red",evolvedFill:"black",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5,textColor:"black",textOffset:8,evolvedTextColor:"red"},link:{stroke:"grey",strokeWidth:1,evolvedStroke:"red",evolvedStrokeWidth:1,flow:"#99c5ee9e",flowStrokeWidth:10,flowText:"#03a9f4",contextFontSize:"11px"},fluidLink:{stroke:"grey",strokeDasharray:"2,2",strokeWidth:2},annotation:{stroke:"#595959",strokeWidth:2,fill:"white",text:"black",boxStroke:"#595959",fontSize:"11px",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black"},note:{fontWeight:"bold",fontSize:"12px",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fill:"black"}},c=l({className:"handwritten",fontFamily:'"Gloria Hallelujah", cursive',stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"black",component:{fill:"white",stroke:"black",fontFamily:'"Gloria Hallelujah", cursive',evolved:"red",evolvedFill:"white",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5},annotation:{stroke:"#595959",strokeWidth:2,boxStroke:"#595959",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black"}}),m=l({className:"wardley",fontFamily:"Consolas, Lucida Console, monospace",stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"#b8b8b8",component:{fill:"white",stroke:"black",fontFamily:"Consolas, Lucida Console, monospace",evolved:"red",evolvedFill:"white",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5},annotation:{stroke:"#595959",strokeWidth:2,fontFamily:"Consolas, Lucida Console, monospace",boxStroke:"#595959",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black"},note:{fontFamily:"Consolas, Lucida Console, monospace"}}),p=l({className:"dark",containerBackground:"#353347",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",stroke:"white",pipelineArrowStroke:"white",evolutionSeparationStroke:"white",mapGridTextColor:"rgba(255,255,255,.8)",pipelineArrowHeight:"5",pipelineArrowWidth:"5",strokeWidth:"1",strokeDasharray:"2,2",anchor:{fontSize:"14px"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},market:{stroke:"#90caf9",fill:"white"},component:{fontSize:"13px",fill:"rgba(255,255,255,.8)",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',stroke:"white",evolved:"#90caf9",evolvedFill:"white",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5,textColor:"rgba(255,255,255,.8)",textOffset:8,evolvedTextColor:"#90caf9"},submap:{fontSize:"13px",fill:"white",stroke:"white",evolved:"#90caf9",evolvedFill:"white",strokeWidth:"1",pipelineStrokeWidth:"2",radius:5,textColor:"white",textOffset:8,evolvedTextColor:"#90caf9"},link:{stroke:"white",strokeWidth:1,evolvedStroke:"#90caf9",evolvedStrokeWidth:1,flow:"#99c5ee9e",flowStrokeWidth:10,flowText:"#03a9f4"},fluidLink:{stroke:"white",strokeDasharray:"2,2",strokeWidth:2},annotation:{stroke:"#595959",strokeWidth:2,fill:"rgba(255,255,255,.8)",text:"black",boxStroke:"#595959",boxStrokeWidth:1,boxFill:"rgba(255,255,255,.8)",boxTextColour:"black"},note:{fontWeight:"bold",fontSize:"12px",textColor:"rgba(255,255,255,.8)"}}),d=l({className:"colour",stroke:"#c23667",pipelineArrowStroke:"#8cb358",evolutionSeparationStroke:"#b8b8b8",strokeWidth:"3",component:{fill:"white",stroke:"#8cb358",evolved:"#ea7f5b",evolvedFill:"white",strokeWidth:"2",pipelineStrokeWidth:"2",radius:7,textColor:"#486b1a",textOffset:8,evolvedTextColor:"#ea7f5b"},submap:{fill:"#8cb358",stroke:"#8cb358",evolved:"#ea7f5b",evolvedFill:"#8cb358",strokeWidth:"2",pipelineStrokeWidth:"2",radius:7,textColor:"#486b1a",textOffset:8,evolvedTextColor:"#ea7f5b"},link:{stroke:"#5c5c5c",evolvedStroke:"#ea7f5b",flow:"#99c5ee9e"},annotation:{stroke:"#015fa5",strokeWidth:2,fill:"#99c5ee",boxStroke:"#015fa5",boxStrokeWidth:2,boxFill:"#99c5ee",boxTextColour:"black"}}),u="https://api.onlinewardleymaps.com/v1/maps/",h={x:5,y:-10},x={Legacy:"Legacy"},y={custom:3.5,product:8,commodity:14},f={genesis:{l1:"Genesis",l2:""},custom:{l1:"Custom Built",l2:""},product:{l1:"Product",l2:"(+rental)"},commodity:{l1:"Commodity",l2:"(+utility)"}},v={width:500,height:600};var g=i(3028),b=i.n(g);class k{visibilityToY(e,t){return(1-e)*t}maturityToX(e,t){return e*t}xToMaturity(e,t){return(1/t*e).toFixed(2)}yToVisibility(e,t){return(1-1/t*e).toFixed(2)}}var w=i(7876);let j=(0,s.memo)(e=>{let{id:t,x:i,y:n,method:s,styles:a={}}=e,o=a[s]||{};return(0,w.jsx)("g",{id:t,transform:"translate ("+i+","+n+")",children:(0,w.jsx)("circle",{cx:"0",cy:"0",r:"20",fill:o.fill,stroke:o.stroke})})}),S=function(e){let{element:t,mapDimensions:i,method:n,mapStyleDefs:s}=e,a=new k,o=a.maturityToX(t.maturity,i.width),l=a.visibilityToY(t.visibility,i.height);return(0,w.jsx)(j,{id:"method_"+t.id,x:o,y:l,method:n,styles:s.methods})};var E=i(4022);function O(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?O(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):O(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}class D{constructor(e,t,i){let{enableNewPipelines:n}=(0,E.Y)();if(this.mapComponents=e.flatMap(e=>e.collection.map(t=>Object.assign(t,{type:e.type}))),this.evolved=t,this.pipelines=this.processPipelines(i,this.mapComponents),n){let e=this.pipelines.flatMap(e=>e.components.map(t=>C(C({},t),{},{type:"component",pseudoComponent:!0,visibility:e.visibility,offsetY:14})));this.mapComponents=this.mapComponents.concat(e)}}processPipelines(e,t){return void 0===e?[]:e.map(e=>{let i=t.find(t=>t.name===e.name);return null!=i?e.visibility=i.visibility:e.hidden=!0,e}).flat()}getMapPipelines(){return this.pipelines}getEvolvedElements(){return this.getEvolveElements().map(e=>{let t=this.evolved.find(t=>t.name===e.name);return{name:e.name,id:e.id+"ev",maturity:e.evolveMaturity,visibility:e.visibility,evolving:!1,evolved:!0,label:t.label,override:t.override,line:t.line,type:e.type,offsetY:e.offsetY,decorators:t.decorators,increaseLabelSpacing:t.increaseLabelSpacing}})}getEvolveElements(){return void 0===this.evolved?[]:this.evolved.map(e=>this.mapComponents.filter(t=>t.name===e.name).map(t=>(t.evolveMaturity=e.maturity,t.evolving=!0,t))).flat()}getNoneEvolvingElements(){return this.mapComponents.filter(e=>!1===e.evolving)}getNoneEvolvedOrEvolvingElements(){return this.mapComponents.filter(e=>(void 0===e.evolving||!1===e.evolving)&&(void 0===e.evolved||!1===e.evolved))}geEvolvedOrEvolvingElements(){return this.mapComponents.filter(e=>!0===e.evolving||!0===e.evolved)}getNonEvolvedElements(){return this.getNoneEvolvingElements().concat(this.getEvolveElements())}getMergedElements(){let e=this.getEvolveElements(),t=this.getNoneEvolvingElements(),i=this.getEvolvedElements(),n=t.concat(i).concat(e).filter(e=>!0==!e.pseudoComponent);return void 0===this.pipelines?n:n.map(e=>{let t=this.pipelines.find(t=>t.name===e.name);return e.pipeline=null!=t&&void 0!==t,e}).flat()}}let A=function(e){return(0,w.jsxs)("g",{id:"valueChain",transform:"translate(0,"+e.mapDimensions.height+") rotate(270)",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",children:[(0,w.jsx)("line",{x1:"0",y1:"0",x2:e.mapDimensions.height,y2:"0",stroke:e.mapStyleDefs.stroke,strokeWidth:e.mapStyleDefs.strokeWidth,strokeDasharray:e.mapStyleDefs.strokeDasharray}),(0,w.jsx)("line",{x1:"-2em",y1:e.mapDimensions.width/20*e.evolutionOffsets.custom,x2:e.mapDimensions.height,y2:e.mapDimensions.width/20*e.evolutionOffsets.custom,stroke:e.mapStyleDefs.evolutionSeparationStroke,strokeDasharray:e.mapStyleDefs.strokeDasharray}),(0,w.jsx)("line",{x1:"-2em",y1:e.mapDimensions.width/20*e.evolutionOffsets.product,x2:e.mapDimensions.height,y2:e.mapDimensions.width/20*e.evolutionOffsets.product,stroke:e.mapStyleDefs.evolutionSeparationStroke,strokeDasharray:e.mapStyleDefs.strokeDasharray}),(0,w.jsx)("line",{x1:"-2em",y1:e.mapDimensions.width/20*e.evolutionOffsets.commodity,x2:e.mapDimensions.height,y2:e.mapDimensions.width/20*e.evolutionOffsets.commodity,stroke:e.mapStyleDefs.evolutionSeparationStroke,strokeDasharray:e.mapStyleDefs.strokeDasharray}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:e.mapDimensions.height-2,y:"-0.4em",textAnchor:"end",fontWeight:"bold",children:"Value Chain"})]})},T=function(e){var t=e.mapDimensions.width/20*e.evolutionOffsets.custom+2,i=e.mapDimensions.width/20*e.evolutionOffsets.product+2,n=e.mapDimensions.width/20*e.evolutionOffsets.commodity+2;return(0,w.jsxs)("g",{id:"Evolution",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",fontStyle:"italic",transform:"translate(0,"+e.mapDimensions.height+")",children:[(0,w.jsx)("line",{x1:"0",y1:"0",x2:e.mapDimensions.width-2,y2:"0",stroke:e.mapStyleDefs.stroke,strokeWidth:e.mapStyleDefs.strokeWidth,markerEnd:"url(#graphArrow)"}),"wardley"===e.mapStyleDefs.className?(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:"10",y:-e.mapDimensions.height+15,textAnchor:"start",fontStyle:"normal",fontSize:"11px",fontWeight:"bold",children:"Uncharted"}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:e.mapDimensions.width-10,y:-e.mapDimensions.height+15,textAnchor:"end",fontStyle:"normal",fontSize:"11px",fontWeight:"bold",children:"Industrialised"})]}):null,(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:"0",y:"1em",textAnchor:"start",children:e.mapEvolutionStates.genesis.l1}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:"0",y:"2em",textAnchor:"start",children:e.mapEvolutionStates.genesis.l2}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:t+5,y:"1em",textAnchor:"start",children:e.mapEvolutionStates.custom.l1}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:t+5,y:"2em",textAnchor:"start",children:e.mapEvolutionStates.custom.l2}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:i+5,y:"1em",textAnchor:"start",children:e.mapEvolutionStates.product.l1}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:i+5,y:"2em",textAnchor:"start",children:e.mapEvolutionStates.product.l2}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:n+5,y:"1em",textAnchor:"start",children:e.mapEvolutionStates.commodity.l1}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:n+5,y:"2em",textAnchor:"start",children:e.mapEvolutionStates.commodity.l2}),(0,w.jsx)("text",{fill:e.mapStyleDefs.mapGridTextColor,x:e.mapDimensions.width,y:"1.8em",textAnchor:"end",fontWeight:"bold",fontStyle:"normal",children:"Evolution"})]})},F=e=>{let{isModKeyPressed:t}=e;if(t)return"url(#ctrlHighlight)"},L=function(e){var t;let i=(0,s.useCallback)(()=>e.x,[e.x]),n=(0,s.useCallback)(()=>e.y,[e.y]),[a,o]=s.useState(!1),l=null!=(t=e.shouldShowMoving)&&t,[r,c]=s.useState({x:i(),y:n(),coords:{}}),m=(0,s.useCallback)(t=>{c(i=>{let n=e.scaleFactor||1,s=(i.coords.x-t.pageX)/n,a=(i.coords.y-t.pageY)/n;return{x:i.x-s,y:i.y-a,coords:{x:t.pageX,y:t.pageY}}})},[e.scaleFactor]),p=t=>{if(e.isModKeyPressed)return;o(!0);let i=t.pageX,n=t.pageY;c(e=>Object.assign({},e,{coords:{x:i,y:n}})),document.addEventListener("mousemove",m),document.addEventListener("keyup",d)},d=e=>{"Escape"===e.key&&a&&(document.removeEventListener("mousemove",m),document.removeEventListener("keyup",d),o(!1),h(),c({x:i(),y:n()}))},u=()=>{e.isModKeyPressed||(document.removeEventListener("mousemove",m),c(e=>Object.assign({},e,{coords:{}})),o(!1),h())};function h(){let t={x:r.x,y:r.y};e.onMove(t)}(0,s.useEffect)(()=>{c({x:i(),y:n(),coords:{}})},[i,n]);let x=F(e);return(0,w.jsxs)("g",{is:"custom",class:"draggable",style:{cursor:a?"grabbing":"grab"},onMouseDown:e=>p(e),onMouseUp:e=>u(e),id:"movable_"+e.id,filter:x,transform:"translate("+(e.fixedX?i():r.x)+","+(e.fixedY?n():r.y)+")",children:[(0,w.jsx)("rect",{x:"-15",y:"-15",rx:"30",ry:"30",width:"30",height:"30",fillOpacity:l&&a?.2:0}),e.children]})};class N{constructor(e,t,i,n){this.type=e,this.mutator=i,this.mapText=t,this.replacers=n}update(e,t){this.mutator(this.mapText.split("\n").map(i=>{for(let n=0;n<this.replacers.length;n++){let s=this.replacers[n];if(s.matcher(i,t,this.type))return s.action(i,e)}return i}).join("\n"))}}let M={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>e.replace(/\[(.?|.+?)\]/g,"[".concat(t.param1,", ").concat(t.param2,"]"))},P={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>"".concat(e.trim()," [").concat(t.param1,", ").concat(t.param2,"]")},W=(0,s.memo)(e=>{let{id:t,y:i,x1:n,x2:s,stroke:a,styles:o={}}=e,l=a||o.stroke;return(0,w.jsxs)("g",{id:t,transform:"translate("+n+","+i+")",children:[(0,w.jsx)("line",{x1:0,y1:0,x2:s-n,y2:0,strokeWidth:1,stroke:l}),(0,w.jsx)("line",{x1:s-n,y1:0,x2:s-n,y2:22,strokeWidth:1,stroke:l}),(0,w.jsx)("line",{x1:s-n,y1:22,x2:0,y2:22,strokeWidth:1,stroke:l}),(0,w.jsx)("line",{x1:0,y1:22,x2:0,y2:0,strokeWidth:1,stroke:l})]})}),_=(0,s.memo)(e=>{let{id:t,cx:i,cy:n,evolved:s,onClick:a,styles:o={}}=e,l=s?o.evolvedFill:o.fill,r=s?o.evolved:o.stroke;return(0,w.jsx)("circle",{id:t,cx:i,cy:n,strokeWidth:o.strokeWidth,r:o.radius,stroke:r,fill:l,onClick:a})}),Y=function(e){let t=new k,i=new N("pipeline",e.mapText,e.mutateMapText,[M,P]),n=t.maturityToX(e.pipeline.maturity1,e.mapDimensions.width),s=t.maturityToX(e.pipeline.maturity2,e.mapDimensions.width),a=t.visibilityToY(e.pipeline.visibility,e.mapDimensions.height)+2;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(W,{id:"pipeline_box_"+e.pipeline.id,y:a,x1:n,x2:s,styles:e.mapStyleDefs.component}),(0,w.jsx)(L,{id:"pipeline_x1_"+e.pipeline.id,onMove:function(n){i.update({param1:t.xToMaturity(n.x,e.mapDimensions.width),param2:e.pipeline.maturity2},e.pipeline.name)},x:n,y:a,fixedY:!0,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(_,{id:"pipeline_circle_x1_"+e.pipeline.id,cx:"10",cy:"12",styles:e.mapStyleDefs.component,onClick:()=>e.setHighlightLine(e.pipeline.line)})}),(0,w.jsx)(L,{id:"pipeline_x2_"+e.pipeline.id,onMove:function(n){i.update({param1:e.pipeline.maturity1,param2:t.xToMaturity(n.x,e.mapDimensions.width)},e.pipeline.name)},x:s,y:a,fixedY:!0,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(_,{id:"pipeline_circle_x2_"+e.pipeline.id,cx:"-10",cy:"12",styles:e.mapStyleDefs.component,onClick:()=>e.setHighlightLine(e.pipeline.line)})})]})},z={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>e.replace(/\[(.?|.+?)\]/g,"[".concat(parseFloat(t.param1).toFixed(2),"]"))},I={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>"".concat(e.trim()," [").concat(parseFloat(t.param1).toFixed(2),"]")},H=function(e){let[t,i]=s.useState(!1),n=(0,s.useCallback)(()=>e.x,[e.x]),a=(0,s.useCallback)(()=>e.y,[e.y]),[o,l]=s.useState({x:n(),y:a(),coords:{}}),r=(0,s.useCallback)(t=>{l(i=>{let n=e.scaleFactor||1,s=(i.coords.x-t.pageX)/n,a=(i.coords.y-t.pageY)/n;return{x:i.x-s,y:i.y-a,coords:{x:t.pageX,y:t.pageY}}})},[e.scaleFactor]),c=e=>{"Escape"===e.key&&t&&(i(!1),d(),document.removeEventListener("mousemove",r),document.removeEventListener("keyup",c),l({x:n(),y:a()}))},m=e=>{let t=e.pageX,n=e.pageY;i(!0),l(e=>Object.assign({},e,{coords:{x:t,y:n}})),document.addEventListener("mousemove",r),document.addEventListener("keyup",c)},p=()=>{document.removeEventListener("mousemove",r),l(e=>Object.assign({},e,{coords:{}})),i(!1),d()};function d(){let t={x:parseFloat(o.x).toFixed(2),y:parseFloat(o.y).toFixed(2)};e.onMove(t)}return(0,s.useEffect)(()=>{l({x:n(),y:a(),coords:{}})},[n,a]),(0,w.jsx)("g",{className:"draggable",style:{cursor:t?"grabbing":"grab"},onMouseDown:e=>m(e),onMouseUp:e=>p(e),id:"movable_"+e.id,transform:"translate("+(e.fixedX?n():o.x)+","+(e.fixedY?a():o.y)+")",children:e.children},"movable_"+e.id)},X=(e,t)=>t.trim().split(" ").map((t,i)=>(0,w.jsx)("tspan",{x:0,dy:15*(i>0),textAnchor:"middle",children:t.trim()},"component_text_span_"+e+"_"+i)),B=(0,s.memo)(e=>{let{id:t,x:i,y:n,text:s,evolved:a,className:o="label",note:l,fontSize:r,fill:c,fontWeight:m,textAnchor:p,styles:d={},onClick:u,setShowTextField:h=null}=e,x=a?d.evolvedTextColor:d.textColor,y=s&&s.length>14,f=y?X(t,s):s;return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)("text",{is:"custom",id:t,"data-testid":t,"font-weight":m||d.fontWeight||"14px","font-size":r||d.fontSize||"14px",class:o,"text-anchor":p,x:i,y:n,transform:y?"translate(30, 10)":"",fill:c||x,onClick:u||null,onDoubleClick:e=>{e.stopPropagation(),h&&h(!0)},children:l||f})})}),R=(e,t,i,n,s)=>{if(i!==t&&i.length>0){let a=n.split("\n")[e-1],o=n.split("\n");o[e-1]=a.replace(t,i);for(let e=0;e<o.length;e++){let n=o[e].trim();if(n.includes("->")&&2===n.split("->").length){let s=n.split("->"),a=s[0].trim(),l=s[1].trim();if(a==t&&(o[e]=[i,l].join("->")),l==t&&(o[e]=[a,i].join("->")),l.includes(";")&&l.split(";")[0].trim()===t){let t=l.split(";")[1].trim();o[e]=[a,"".concat(i,";").concat(t)].join("->")}}["pipeline","build","buy","outsource"].map(s=>{n.startsWith(s)&&n.split(s).length>1&&n.split(s)[1].trim()==t&&(o[e]="".concat(s," ").concat(n.split(s)[1].trim().replace(t,i)))}),["evolve"].map(s=>{if(n.startsWith(s)&&n.split(s).length>1){n.split(s)[1].trim().split(" ")[0].trim()==t&&(o[e]="".concat(s," ").concat(n.split(s)[1].trim().replace(t,i)));let a=n.split(s)[1].trim().split(" ")[0].trim();a.includes(t)&&a.includes("->")&&(o[e]="".concat(s," ").concat(n.split(s)[1].trim().replace(t,i)))}})}s(o.join("\n"))}};var G=i(7609);let U=function(e){let{enableDoubleClickRename:t}=(0,E.Y)(),{mutateMapText:i,mapText:n,overrideDrag:a,element:o,mapStyleDefs:l,onClick:r,scaleFactor:c}=e,[m,p]=s.useState({rows:0,cols:0}),[d,u]=s.useState(""),[h,x]=s.useState(!1),y=(0,s.useRef)();(0,s.useEffect)(()=>{let e=d.split("\n").length+1,t=Math.max(...d.split("\n").map(e=>e.length));p({rows:e<1?1:e,cols:t<5?5:t})},[d]),(0,s.useEffect)(()=>{t&&h&&(y.current.select(),u(o.name))},[h]);let f=e=>{e.stopPropagation(),"Enter"===e.key&&(console.log("Enter key pressed!"),R(o.line,o.name,d.replace("\n",""),n,i),x(!1)),"Escape"===e.key&&x(!1)};return(0,w.jsx)(s.Fragment,{children:(0,w.jsxs)(H,{id:"rm_element_text_"+o.id,fixedY:!1,fixedX:!1,onMove:a||function(e){i(n.split("\n").map(t=>{if(o.evolved)if(0!==t.replace(/\s/g,"").indexOf("evolve"+o.name.replace(/\s/g,"")+(o.override.length>0?"->"+o.override:"")+o.maturity))return t;else if(t.replace(/\s/g,"").indexOf("label[")>-1)return t.replace(/\slabel\s\[(.?|.+?)\]+/g," label [".concat(parseFloat(e.x).toFixed(2),", ").concat(e.y,"]"));else return t.trim()+" label [".concat(e.x,", ").concat(e.y,"]");return 0!==t.replace(/\s/g,"").indexOf(o.type+o.name.replace(/\s/g,"")+"[")?t:t.replace(/\s/g,"").indexOf("label[")>-1?t.replace(/\slabel\s\[(.?|.+?)\]+/g," label [".concat(parseFloat(e.x).toFixed(2),", ").concat(e.y,"]")):t.trim()+" label [".concat(e.x,", ").concat(e.y,"]")}).join("\n"))},x:o.label.x,y:o.label.y,scaleFactor:c,children:[!1===h&&(0,w.jsx)(B,{id:"element_text_"+o.id,text:o.override?o.override:o.name,evolved:o.evolved,styles:l.component,onClick:r,setShowTextField:t?x:null}),t&&h&&(0,w.jsx)("foreignObject",{x:"0",y:"-20",width:8*m.cols+10,height:16*m.rows,children:(0,w.jsx)(G.A,{variant:"filled",ref:y,color:"primary",autoComplete:"off",size:"small",cols:m.cols,onChange:e=>u(e.target.value),onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},sx:{position:"fixed",zIndex:1e4,boxSizing:"border-box",flex:1,"& textarea":{boxSizing:"border-box",zIndex:10001,position:"relative",flex:1,fontSize:"14px",fontFamily:'Consolas, "Lucida Console", monospace',padding:0,margin:"0",color:"black"}},margin:"dense",onKeyUp:e=>f(e),defaultValue:o.name,onDoubleClick:e=>e.stopPropagation(),onClick:e=>e.stopPropagation()})})]})})},V=s.createContext();function K(e){let{children:t}=e,i=function(){let e=function(e){let{0:t,1:i}=(0,s.useState)([]),n=!1;return(!e||Array.isArray(e)&&0===e.length)&&(n=!0),(0,s.useEffect)(()=>{let t=t=>{let{key:s}=t;(n||e.includes(s))&&i(e=>[...e,s])},s=t=>{let{key:s}=t;(n||e.includes(s))&&i(e=>e.filter(e=>e!==s))};return document.addEventListener("keydown",t),document.addEventListener("keyup",s),()=>{document.removeEventListener("keydown",t),document.removeEventListener("keyup",s)}},[]),t}(["Meta","Control"]),{0:t,1:i}=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let t=/Mac|iPod|iPhone|iPad/.test(window.navigator.platform);i(e.includes(t?"Meta":"Control"))},[e]),t}();return(0,w.jsx)(V.Provider,{value:i,children:t})}function Z(){let e=s.useContext(V);if(void 0===e)throw Error("useModKeyPressedConsumer must be used within a ModKeyPressedProvider");return e}let J=function(e){let t=new k,i=Z(),n=new N("component",e.mapText,e.mutateMapText,[{matcher:(e,t,i)=>z.matcher(e,t,i)&&!z.matcher(e,"","label"),action:(e,t)=>z.action(e,t)},{matcher:(e,t,i)=>z.matcher(e,t,i)&&z.matcher(e,"","label"),action:(e,t)=>{let i=e.split("label");return z.action(i[0],t)+"label"+i[1]}},I]),a=t.maturityToX(e.pipeline.maturity1,e.mapDimensions.width),o=t.maturityToX(e.pipeline.maturity2,e.mapDimensions.width),l=i=>t.maturityToX(i,e.mapDimensions.width),r=(t,i)=>{let n=Object.assign(t,{visibility:e.pipeline.visibility,offsetY:12});e.linkingFunction({el:n,e:i})},c=t.visibilityToY(e.pipeline.visibility,e.mapDimensions.height)+2;return(0,w.jsxs)(s.Fragment,{children:[(0,w.jsx)(W,{y:c,id:"pipeline_box_"+e.pipeline.id,x1:a-10,x2:o+10,styles:e.mapStyleDefs.component}),e.pipeline.components.map((a,o)=>(0,w.jsx)(s.Fragment,{children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(L,{id:"pipeline_"+e.pipeline.id+"_"+o,onMove:i=>{n.update({param1:t.xToMaturity(i.x,e.mapDimensions.width)},a.name)},x:l(a.maturity),y:c+12,fixedY:!0,fixedX:!1,shouldShowMoving:!0,isModKeyPressed:i,scaleFactor:e.scaleFactor,children:(0,w.jsx)(_,{id:"pipeline_circle_"+e.pipeline.id+"_"+o,cx:"0",cy:"0",styles:e.mapStyleDefs.component,onClick:e=>r(a,e)})}),(0,w.jsx)("g",{transform:"translate("+l(a.maturity)+","+c+")",children:(0,w.jsx)(U,{overrideDrag:t=>{e.mutateMapText(e.mapText.split("\n").map(e=>0!==e.replace(/\s/g,"").indexOf("component"+a.name.replace(/\s/g,"")+"[")?e:e.replace(/\s/g,"").indexOf("label[")>-1?e.replace(/\slabel\s\[(.?|.+?)\]+/g," label [".concat(parseFloat(t.x).toFixed(0),", ").concat(parseFloat(t.y).toFixed(0),"]")):e.trim()+" label [".concat(parseFloat(t.x).toFixed(0),", ").concat(parseFloat(t.y).toFixed(0),"]")).join("\n"))},id:"pipelinecomponent_text_"+a.id,mapStyleDefs:e.mapStyleDefs,element:a,mapText:e.mapText,mutateMapText:e.mutateMapText,scaleFactor:e.scaleFactor})})]})},o))]},"pipeline_box_"+e.pipeline.id)};class q{for(e,t,i){if(t.length>0){var n=JSON.parse(t).find(t=>t.name===e?t:null);if(null!==n)return{x:n.x,y:n.y,coords:{}}}return i}update(e,t,i){if(!(t.length>0))return JSON.stringify([{name:e,x:i.x,y:i.y}]);var n=JSON.parse(t);return void 0===n.find(t=>t.name===e)&&n.push({name:e,x:i.x,y:i.y}),JSON.stringify(n.map(t=>(t.name===e&&(t.x=i.x,t.y=i.y),t)))}}let Q=e=>{let{x:t,y:i,startElement:n,endElement:s,metaText:a,link:o,setMetaText:l,mapStyleDefs:r}=e,c=new q,m="flow_text_".concat(n.id,"_").concat(s.id),p=c.for(m,a,{x:0,y:-30});return(0,w.jsx)("g",{id:"flow_"+s.name,transform:"translate("+t+","+i+")",children:(0,w.jsx)(H,{id:m,fixedX:!1,fixedY:!1,onMove:e=>{l(c.update(m,a,e))},y:p.y,x:p.x,scaleFactor:e.scaleFactor,children:(0,w.jsx)(B,{className:"draggable label",id:m,x:"5",y:"5",textAnchor:"start",fill:r.link.flowText,text:o.flowValue})})})},$=(0,s.memo)(e=>{let{id:t,x1:i,x2:n,y1:s,y2:a,flow:o,evolved:l,strokeDasharray:r,markerStart:c,styles:m,filter:p}=e,d=l?m.evolvedStroke:m.stroke,u=l?m.evolvedStrokeWidth:m.strokeWidth;return(0,w.jsxs)("g",{id:t,children:[(0,w.jsx)("line",{x1:i,y1:s,x2:n,y2:a,strokeDasharray:r,stroke:d,strokeWidth:u,markerStart:c,filter:p}),o&&(0,w.jsx)("line",{x1:i,y1:s,x2:n,y2:a,strokeWidth:m.flowStrokeWidth,stroke:m.flow})]})}),ee=function(e){var t;let{enableLinkContext:i}=(0,E.Y)(),{mapStyleDefs:n,mapDimensions:s,startElement:a,endElement:o,link:l}=e,{height:r,width:c}=s,m=new k,p=m.maturityToX(a.maturity,c),d=m.maturityToX(o.maturity,c),u=m.visibilityToY(a.visibility,r)+(a.offsetY?a.offsetY:0),h=m.visibilityToY(o.visibility,r)+(o.offsetY?o.offsetY:0),x=a.evolved||o.evolved,y=l.flow&&(l.future===l.past||!0===l.past&&!1===o.evolving&&!0===a.evolving||!0===l.past&&!0===o.evolving&&!1===a.evolving||!0===l.future&&!0===a.evolving||!0===l.future&&!0===a.evolved||!0===l.future&&!0===o.evolved),f=(p+d)/2,v=(u+h)/2,g=180/Math.PI*Math.atan2(h-u,d-p);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($,{id:"link_".concat(a.id,"_").concat(o.id),x1:p,x2:d,y1:u,y2:h,flow:y,evolved:x,styles:n.link}),l.flowValue&&(0,w.jsx)(Q,{mapStyleDefs:n,startElement:a,endElement:o,link:l,metaText:e.metaText,setMetaText:e.setMetaText,x:d,y:h,scaleFactor:e.scaleFactor}),i&&l.context&&(0,w.jsx)("text",{is:"custom","font-size":null!=(t=n.link.contextFontSize)?t:"10px","text-anchor":"middle",x:f,y:v-5,transform:"rotate(".concat(g>90||g<-90?g+180:g," ").concat(f," ").concat(v,")"),children:l.context})]})},et=function(e){let{mapStyleDefs:t,mapDimensions:i,startElement:n,origClick:a}=e,{height:o,width:l}=i,r=new k,c=r.maturityToX(n.maturity,l),m=r.visibilityToY(n.visibility,o)+(n.offsetY?n.offsetY:0),[p,d]=s.useState({x:c,y:m,coords:{}}),u=(0,s.useCallback)(t=>{d(i=>{let n=e.scaleFactor||1,s=(i.coords.x-t.pageX)/n,a=(i.coords.y-t.pageY)/n;return{x:i.x-s,y:i.y-a,coords:{x:t.pageX,y:t.pageY}}})},[e.scaleFactor]);return(0,s.useEffect)(()=>{let e=a.pageX,t=a.pageY;return d(i=>Object.assign({},i,{coords:{x:e,y:t}})),document.addEventListener("mousemove",u),function(){document.removeEventListener("mousemove",u)}},[a]),(0,w.jsx)($,{id:"link_".concat(n.id,"_fluid"),x1:c,x2:p.x,y1:m,y2:p.y,flow:!1,evolved:!1,styles:t.fluidLink,filter:"url(#ctrlHighlight)",strokeDasharray:t.fluidLink.strokeDasharray})},ei=(0,s.memo)(function(e){let{id:t,x:i,y:n,stroke:s="black",strokeWidth:a="6"}=e;return(0,w.jsx)("line",{id:t,x1:i,y1:n-10,x2:i,y2:Number(n)+10,stroke:s,strokeWidth:a})}),en=function(e){let t=new k;return(0,w.jsx)(ei,{x:t.maturityToX(e.maturity,e.mapDimensions.width),y:t.visibilityToY(e.visibility,e.mapDimensions.height)})},es=(e,t)=>{let{mapDimensions:i,evolutionOffsets:n,startElement:s}=t,a=i.width/20,o=[n.commodity,n.product,n.custom];for(let t=0;t<o.length;t++){let n=e.xToMaturity(a*o[t],i.width);if(s.maturity>=n)return n}return null},ea=function(e){let t,{mapStyleDefs:i,mapDimensions:n,startElement:s,endElement:a}=e,{height:o,width:l}=n,r=new k,c=r.maturityToX(s.maturity,l),m=r.maturityToX(a.maturity,l),p=r.visibilityToY(s.visibility,o)+(s.offsetY?s.offsetY:0),d=r.visibilityToY(a.visibility,o)+(a.offsetY?a.offsetY:0);return a.inertia&&(t=es(r,e)||c),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)($,{x1:c,y1:p,x2:m,y2:d,strokeDasharray:"5 5",markerStart:"url(#arrow)",styles:i.link,evolved:!0}),a.inertia&&(0,w.jsx)(en,{maturity:t,visibility:a.visibility,mapDimensions:n})]})},eo={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")),action:(e,t)=>e.replace(/\s([0-9]?\.[0-9]+[0-9]?)+/g," ".concat(t.param2))},el=function(e){let t=Z(),i=new k,n=i.maturityToX(e.element.maturity,e.mapDimensions.width),s=i.visibilityToY(e.element.visibility,e.mapDimensions.height)+(e.element.offsetY?e.element.offsetY:0),a=new N(e.keyword,e.mapText,e.mutateMapText,[{matcher:(t,i,n)=>void 0===e.element.evolved&&M.matcher(t,i,n)&&!M.matcher(t,"","label"),action:(e,t)=>M.action(e,t)},{matcher:(t,i,n)=>void 0===e.element.evolved&&M.matcher(t,i,n)&&M.matcher(t,"","label"),action:(e,t)=>{let i=e.split("label");return M.action(i[0],t)+"label"+i[1]}},{matcher:(t,i)=>e.element.evolved&&eo.matcher(t,i,"evolve"),action:(e,t)=>eo.action(e,t)},P]);return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(L,{id:"element_"+e.element.id,onMove:function(t){let n=i.yToVisibility(t.y,e.mapDimensions.height),s=i.xToMaturity(t.x,e.mapDimensions.width);a.update({param1:n,param2:s},e.element.name)},x:n,y:s,fixedY:e.element.evolved,fixedX:!1,shouldShowMoving:!0,isModKeyPressed:t,scaleFactor:e.scaleFactor,children:(0,w.jsx)(w.Fragment,{children:e.children})}),(void 0===e.element.evolved||!1===e.element.evolved)&&!1===e.element.evolving&&!0===e.element.inertia&&(0,w.jsx)(en,{maturity:parseFloat(e.element.maturity)+.05,visibility:e.element.visibility,mapDimensions:e.mapDimensions}),(0,w.jsx)("g",{transform:"translate("+n+","+s+")",children:(0,w.jsx)(U,{id:"component_text_"+e.element.id,mapStyleDefs:e.mapStyleDefs,element:e.element,mapText:e.mapText,mutateMapText:e.mutateMapText,onClick:()=>e.setHighlightLine(e.element.line),scaleFactor:e.scaleFactor})})]})},er=(0,s.memo)(function(e){let{annotation:t,styles:i}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("circle",{cx:"-0",cy:"0",className:"draggable",r:"15",fill:i.fill,stroke:i.stroke,strokeWidth:i.strokeWidth}),(0,w.jsx)("text",{x:"-5",y:"5",className:"label draggable",textAnchor:"start",children:t.number})]})}),ec=function(e){let t=new k;return(0,w.jsx)(L,{id:"annotation_element_"+e.annotation.number,onMove:function(i){e.mutateMapText(e.mapText.split("\n").map(n=>{if(-1===n.replace(/\s/g,"").indexOf("annotation"+e.annotation.number+"["))return n;if(!(n.replace(/\s/g,"").indexOf("]]")>-1))return n.replace(/\[(.+?)\]/g,"[".concat(t.yToVisibility(i.y,e.mapDimensions.height),", ").concat(t.xToMaturity(i.x,e.mapDimensions.width),"]"));var s=n.replace(/\s/g,"").split("[[")[1].split("]]")[0].split("],[");s[e.occuranceIndex]=t.yToVisibility(i.y,e.mapDimensions.height)+","+t.xToMaturity(i.x,e.mapDimensions.width);var a=n.split("[")[0].trim(),o=n.substr(n.lastIndexOf("]"),n.length-n.lastIndexOf("]"));return a+" ["+s.map(e=>"["+e+"]").join(",")+" "+o}).join("\n"))},x:t.maturityToX(e.occurance.maturity,e.mapDimensions.width),y:t.visibilityToY(e.occurance.visibility,e.mapDimensions.height),fixedY:!1,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(er,{annotation:e.annotation,styles:e.mapStyleDefs.annotation})})},em=(0,s.memo)(function(e){let{id:t,annotation:i,styles:n}=e;return(0,w.jsxs)("tspan",{id:t,className:"label",textAnchor:"start",fontFamily:n.fontFamily,fontSize:n.fontSize,dy:18,x:0,fill:n.boxTextColour,children:["\xa0",i.number,". ",i.text,"\xa0"]})});class ep{constructor(e,t,i){this.type=e,this.mutator=i,this.mapText=t,this.positionUpdater=null}setSuccessor(e){this.positionUpdater=e}update(e,t){this.mapText.indexOf(this.type+" ")>-1&&null!=this.positionUpdater?this.positionUpdater.update(e,t):this.mutator(this.mapText+"\n"+this.type+" [".concat(e.param1,", ").concat(e.param2,"]"))}}let ed=(0,s.memo)(function(e){let{id:t,dy:i="0",x:n="2",fill:s,textAnchor:a="start",textDecoration:o="underline",className:l="label draggable",children:r}=e;return(0,w.jsxs)("text",{id:t,children:[(0,w.jsx)("tspan",{className:l,textAnchor:a,dy:i,x:n,fill:s,textDecoration:o,children:"Annotations:"}),r]})}),eu=function(e){let t=new k,i="annotations",n=new N(i,e.mapText,e.mutateMapText,[M]),a=new ep(i,e.mapText,e.mutateMapText);a.setSuccessor(n);let o=(0,s.useCallback)(()=>{let t=document.getElementById("annotationsBoxWrap");null!==t&&t.parentNode.removeChild(t);let i=document.getElementById("movable_annotationsBox"),n=i.getBBox(),s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("x",n.x-2),s.setAttribute("id","annotationsBoxWrap"),s.setAttribute("y",n.y-2),s.setAttribute("class","draggable"),s.setAttribute("width",n.width+4),s.setAttribute("height",n.height+4),s.setAttribute("stroke",e.mapStyleDefs.annotation.boxStroke),s.setAttribute("stroke-width",e.mapStyleDefs.annotation.boxStrokeWidth),s.setAttribute("fill",e.mapStyleDefs.annotation.boxFill),i.insertBefore(s,document.getElementById("annotationsBoxTextContainer"))},[e.mapStyleDefs]);return(0,s.useEffect)(()=>{o()},[e.position.maturity,e.position.visibility,e.mapDimensions,e.mapStyleDefs,e.annotations,o]),(0,w.jsx)(L,{id:"annotationsBox",onMove:function(i){let n=t.yToVisibility(i.y,e.mapDimensions.height),s=t.xToMaturity(i.x,e.mapDimensions.width);a.update({param1:n,param2:s},"")},fixedY:!1,fixedX:!1,x:t.maturityToX(e.position.maturity,e.mapDimensions.width),y:t.visibilityToY(e.position.visibility,e.mapDimensions.height),scaleFactor:e.scaleFactor,children:(0,w.jsx)(ed,{id:"annotationsBoxTextContainer",dy:0,x:2,styles:e.mapStyleDefs.annotation,children:e.annotations.map((t,i)=>(0,w.jsx)(em,{annotation:t,parentIndex:i,styles:e.mapStyleDefs.annotation},i))})})},eh=e=>{let t=Z(),i="anchor",n=(t,n)=>"".concat(i,"_").concat(void 0!==t?t+"_":"").concat(e.anchor.id).concat(void 0!==n?"_"+n:""),s=new k,a=new N(i,e.mapText,e.mutateMapText,[M,P]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(L,{id:n(),onMove:function(t){let i=s.yToVisibility(t.y,e.mapDimensions.height),n=s.xToMaturity(t.x,e.mapDimensions.width);a.update({param1:i,param2:n},e.anchor.name)},x:s.maturityToX(e.anchor.maturity,e.mapDimensions.width),y:s.visibilityToY(e.anchor.visibility,e.mapDimensions.height),fixedY:!1,fixedX:!1,isModKeyPressed:t,scaleFactor:e.scaleFactor,children:(0,w.jsx)(B,{id:n("text"),text:e.anchor.name,x:"0",y:"-10",textAnchor:"middle",evolved:e.anchor.evolved,fontSize:e.mapStyleDefs.anchor.fontSize,styles:e.mapStyleDefs.component,onClick:e.onClick})})})};class ex{constructor(e,t,i,n){this.type=e,this.mapText=t,this.mutator=i,this.replacers=n}update(e,t,i){let n=this.mapText.split("\n")[i-1];for(let i=0;i<this.replacers.length;i++){let s=this.replacers[i];s.matcher(n,t,this.type)&&(n=s.action(n,e))}let s=this.mapText.split("\n");s[i-1]=n,this.mutator(s.join("\n"))}}let ey=function(e){var t;let i=new k,n=new ex("note",e.mapText,e.mutateMapText,[M,P]);return(0,w.jsx)(L,{id:"note_"+e.note.id,onMove:function(t){let s=i.yToVisibility(t.y,e.mapDimensions.height),a=i.xToMaturity(t.x,e.mapDimensions.width);n.update({param1:s,param2:a},e.note.text,e.note.line)},x:i.maturityToX(e.note.maturity,e.mapDimensions.width),y:i.visibilityToY(e.note.visibility,e.mapDimensions.height),fixedY:!1,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(B,{id:"note_text_"+e.note.id,note:e.note.text,styles:null==e||null==(t=e.mapStyleDefs)?void 0:t.note,onClick:()=>e.setHighlightLine(e.note.line)})})},ef={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>e.replace(/\[(.?|.+?)\]/g,"[".concat(t.param1,", ").concat(t.param2,", ").concat(t.param3,", ").concat(t.param4,"]"))},ev={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>"".concat(e.trim()," [").concat(t.param1,", ").concat(t.param2,", ").concat(t.param3,", ").concat(t.param4,"]")},eg=(0,s.memo)(function(e){let{id:t,height:i,width:n,fill:s,stroke:a,fillOpacity:o,strokeOpacity:l,attitude:r,styles:c}=e,m=c[r]||c.pioneer||{};return(0,w.jsx)("rect",{id:t,fill:s||m.fill,stroke:a||m.stroke,fillOpacity:o||m.fillOpacity,strokeOpacity:l||m.strokeOpacity,height:i||"100",width:n||"200",strokeWidth:c.strokeWidth})}),eb=e=>{let{attitude:t,mapDimensions:i}=e,{height:n,width:s}=i,a=t.attitude,o=new k,l=new ex(a,e.mapText,e.mutateMapText,[ef,ev]),r=o.maturityToX(t.maturity,s),c=o.maturityToX(t.maturity2,s),m=o.visibilityToY(t.visibility,n),p=o.visibilityToY(t.visibility2,n);return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(L,{id:"attitude_".concat(a,"_movable"),onMove:function(e){let i=o.yToVisibility(e.y,n),a=o.xToMaturity(e.x,s),r=t.visibility2,c=t.maturity2;t.visibility<i&&(r=i-t.visibility+t.visibility2),t.visibility>i&&(r=i-t.visibility+t.visibility2),t.maturity<a&&(c=a-t.maturity+t.maturity2),t.maturity>a&&(c=a-t.maturity+t.maturity2),l.update({param1:parseFloat(i).toFixed(2),param2:parseFloat(a).toFixed(2),param3:parseFloat(r).toFixed(2),param4:parseFloat(c).toFixed(2)},"",t.line)},x:r,y:m,fixedY:!1,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(eg,{id:"attitude_".concat(a),attitude:a,height:p-m,width:c-r,textAnchor:"middle",styles:e.mapStyleDefs.attitudes})})})};class ek{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"links",links:this.links,startElements:this.mapElements.getNoneEvolvedOrEvolvingElements(),endElements:this.mapElements.getNoneEvolvedOrEvolvingElements()}}}class ew{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"evolvingEndLinks",links:this.links.filter(e=>this.mapElements.getEvolvedElements().find(t=>t.name===e.end)&&this.mapElements.getNoneEvolvingElements().find(t=>t.name===e.start)),startElements:this.mapElements.getNoneEvolvingElements(),endElements:this.mapElements.getEvolveElements()}}}class ej{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"evolvingToNoneEvolvingEndLinks",links:this.links.filter(e=>this.mapElements.getEvolveElements().find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvingElements().find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements(),endElements:this.mapElements.getNoneEvolvingElements()}}}class eS{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"evolvedToEvolving",links:this.links.filter(e=>this.mapElements.getEvolvedElements().find(t=>t.name===e.start)&&this.mapElements.getEvolveElements().find(t=>t.name===e.end)),startElements:this.mapElements.getEvolvedElements(),endElements:this.mapElements.getEvolveElements()}}}class eE{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"bothEvolved",links:this.links.filter(e=>this.mapElements.getEvolvedElements().find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements().find(t=>t.name===e.end)),startElements:this.mapElements.getEvolvedElements(),endElements:this.mapElements.getEvolvedElements()}}}class eO{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"evolveStartLinks",links:this.links.filter(e=>this.mapElements.getEvolvedElements().find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvingElements().find(t=>t.name===e.end)),startElements:this.mapElements.getNoneEvolvingElements(),endElements:this.mapElements.getEvolveElements()}}}class eC{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"bothEvolving",links:this.links.filter(e=>this.mapElements.getEvolveElements().find(t=>t.name===e.start)&&this.mapElements.getEvolveElements().find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements(),endElements:this.mapElements.getEvolveElements()}}}class eD{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"evolveToEvolved",links:this.links.filter(e=>this.mapElements.getEvolveElements().find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements().find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements(),endElements:this.mapElements.getEvolvedElements()}}}class eA{constructor(e,t,i){this.links=e,this.mapElements=t,this.anchors=i}getLinks(){return{name:"anchorLinks",links:this.links.filter(e=>this.anchors.find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvedOrEvolvingElements(t=>t.name===e.end)),startElements:this.anchors,endElements:this.mapElements.getNoneEvolvedOrEvolvingElements()}}}class eT{constructor(e,t,i){this.links=e,this.mapElements=t,this.anchors=i}getLinks(){return{name:"anchorNonEvolvedLinks",links:this.links.filter(e=>this.anchors.find(t=>t.name===e.start)&&this.mapElements.getEvolveElements(t=>t.name===e.end)),startElements:this.anchors,endElements:this.mapElements.getEvolveElements()}}}class eF{constructor(e,t){this.links=e,this.mapElements=t}getLinks(){return{name:"noneEvolvingToEvolvedEndLinks",links:this.links.filter(e=>this.mapElements.getNoneEvolvingElements().find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements().find(t=>t.name===e.end)),startElements:this.mapElements.getNoneEvolvingElements(),endElements:this.mapElements.getEvolvedElements()}}}class eL{constructor(e,t,i){this.links=e,this.mapElements=t,this.anchors=i}getLinks(){return{name:"anchorEvolvedLinks",links:this.links.filter(e=>this.anchors.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements(t=>t.name===e.end)),startElements:this.anchors,endElements:this.mapElements.getEvolvedElements()}}}class eN{constructor(e,t,i,n){let s=!0===n?[new eD(e,t),new eO(e,t),new eF(e,t),new eE(e,t),new eS(e,t),new eL(e,t,i)]:[];this.linkStrategies=s.concat([new ek(e,t),new ew(e,t),new eC(e,t),new eA(e,t,i),new eT(e,t,i),new ej(e,t)])}getElementByName(e,t){return e.find(function(e){return e.name===t})}canSatisfyLink(e,t,i){return void 0!==this.getElementByName(t,e.start)&&void 0!==this.getElementByName(i,e.end)}build(){let e=[];return this.linkStrategies.forEach(t=>{let i=t.getLinks(),n=[];i.links.forEach((e,t)=>{if(this.canSatisfyLink(e,i.startElements,i.endElements)){let s={key:t,startElement:this.getElementByName(i.startElements,e.start),endElement:this.getElementByName(i.endElements,e.end),link:e};n.push(s)}}),e.push({name:i.name,links:n})}),e}}let eM=()=>(0,w.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:(0,w.jsx)("path",{d:"M 3,-1 l 2,2 M 0,0 l 4,4 M -1,3 l 2,2 ",stroke:"grey",strokeWidth:"1",opacity:".5"})}),eP=(0,s.memo)(e=>(0,w.jsxs)("defs",{children:[(0,w.jsxs)("linearGradient",{id:"arrowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,w.jsx)("stop",{offset:"0%",style:{stopColor:"#ffffff",stopOpacity:1}}),(0,w.jsx)("stop",{offset:"40%",style:{stopColor:"#808080",stopOpacity:1}}),(0,w.jsx)("stop",{offset:"100%",style:{stopColor:"#808080",stopOpacity:1}})]}),(0,w.jsx)("filter",{id:"ctrlHighlight",children:(0,w.jsx)("feDropShadow",{dx:"0",dy:"0",stdDeviation:"3",floodColor:"blue"})}),(0,w.jsxs)("linearGradient",{gradientUnits:"objectBoundingBox",id:"wardleyGradient",spreadMethod:"pad",x1:"0%",x2:"100%",y1:"0%",y2:"0%",children:[(0,w.jsx)("stop",{offset:"0%",style:{stopColor:"rgb(196, 196, 196)",stopOpacity:1}}),(0,w.jsx)("stop",{offset:"0.3",style:{stopColor:"white",stopOpacity:1}}),(0,w.jsx)("stop",{offset:"0.7",style:{stopColor:"white"}}),(0,w.jsx)("stop",{offset:1,style:{stopColor:"rgb(196, 196, 196)"}})]}),(0,w.jsxs)("linearGradient",{spreadMethod:"pad",id:"accelGradient",x1:"0%",y1:"64%",x2:"76%",y2:"0%",children:[(0,w.jsx)("stop",{offset:"0%",style:{stopColor:"white",stopOpacity:1}}),(0,w.jsx)("stop",{offset:"100%",style:{stopColor:"#8c8995",stopOpacity:1}})]}),eM(),(0,w.jsx)("marker",{id:"arrow",markerWidth:"12",markerHeight:"12",refX:"15",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,w.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.mapStyleDefs.link.evolvedStroke})}),(0,w.jsx)("marker",{id:"graphArrow",markerWidth:12/e.mapStyleDefs.strokeWidth,markerHeight:12/e.mapStyleDefs.strokeWidth,refX:"9",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,w.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.mapStyleDefs.stroke})}),(0,w.jsx)("marker",{id:"pipelineArrow",markerWidth:e.mapStyleDefs.pipelineArrowWidth,markerHeight:e.mapStyleDefs.pipelineArrowHeight,refX:"9",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,w.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.mapStyleDefs.pipelineArrowStroke})})]})),eW=function(e){let{mapTitle:t}=e;return(0,w.jsx)("text",{x:0,y:-10,is:"custom",id:"mapTitle","font-weight":"bold","font-size":"20px","font-family":'"Helvetica Neue",Helvetica,Arial,sans-serif',children:t})},e_=e=>(0,w.jsx)("rect",{x:"0",width:e.mapDimensions.width,y:"0",height:e.mapDimensions.height,id:"fillArea",fill:{wardley:"url(#wardleyGradient)",colour:"none",plain:"none",handwritten:"none",dark:"#353347"}[e.mapStyleClass]}),eY=(0,s.memo)(e=>{let{id:t,cx:i,cy:n,evolved:s,onClick:a,styles:o={},launchUrl:l}=e,r=s?o.evolvedFill:o.fill,c=s?o.evolved:o.stroke;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)("rect",{x:"-20",y:"-6",stroke:"none",width:"30px",fillOpacity:"0",className:"submapLink",onClick:l,height:"12px"}),(0,w.jsx)("g",{transform:"translate(-23, -8)",children:(0,w.jsxs)("svg",{onClick:l,stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 16 16",color:"black",className:"submapLink",height:"18px",width:"18px",xmlns:"http://www.w3.org/2000/svg",style:{color:"black"},children:[(0,w.jsx)("path",{d:"M4.715 6.542L3.343 7.914a3 3 0 104.243 4.243l1.828-1.829A3 3 0 008.586 5.5L8 6.086a1.001 1.001 0 00-.154.199 2 2 0 01.861 3.337L6.88 11.45a2 2 0 11-2.83-2.83l.793-.792a4.018 4.018 0 01-.128-1.287z"}),(0,w.jsx)("path",{d:"M5.712 6.96l.167-.167a1.99 1.99 0 01.896-.518 1.99 1.99 0 01.518-.896l.167-.167A3.004 3.004 0 006 5.499c-.22.46-.316.963-.288 1.46z"}),(0,w.jsx)("path",{d:"M6.586 4.672A3 3 0 007.414 9.5l.775-.776a2 2 0 01-.896-3.346L9.12 3.55a2 2 0 012.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 00-4.243-4.243L6.586 4.672z"}),(0,w.jsx)("path",{d:"M10 9.5a2.99 2.99 0 00.288-1.46l-.167.167a1.99 1.99 0 01-.896.518 1.99 1.99 0 01-.518.896l-.167.167A3.004 3.004 0 0010 9.501z"})]})}),(0,w.jsx)("circle",{id:t,cx:i,cy:n,strokeWidth:o.strokeWidth,r:o.radius,stroke:c,fill:r,onClick:a})]})}),ez=(e,t)=>[Math.round(e*Math.cos(t*Math.PI/180)),Math.round(e*Math.sin(t*Math.PI/180))],eI=()=>{let e=[];for(let t=0;t<3;t++)e.push(ez(10,30+120*t));return e},eH=(e,t)=>e.map((e,i)=>(0,w.jsx)("circle",{cx:e[0],cy:e[1],r:"5",fill:t.fill,strokeWidth:"3",stroke:t.stroke},i)),eX=(0,s.memo)(e=>{let{id:t,styles:i={},onClick:n}=e,s=eI();return(0,w.jsxs)("g",{id:t,onClick:n,children:[(0,w.jsx)("circle",{r:18,fill:i.fill,strokeWidth:"1",stroke:i.stroke}),(0,w.jsx)("path",{strokeWidth:"2",stroke:"black",fill:"none",opacity:".8",d:"M".concat(s[0]," L").concat(s[1]," L").concat(s[2]," Z")}),eH(s,i)]})}),eB=(0,s.memo)(e=>{let{id:t,cx:i,cy:n,onClick:s,styles:a={}}=e;return(0,w.jsxs)("g",{id:t,onClick:s,children:[(0,w.jsx)("circle",{cx:i,cy:n,r:"30",fill:"#d7d7d7",strokeWidth:"1",stroke:a.stroke}),(0,w.jsx)("circle",{cx:i,cy:n,r:"25",fill:"white",strokeWidth:"1",stroke:"#9e9b9e"}),(0,w.jsx)("circle",{cx:i,cy:n,r:"25",fill:"url(#diagonalHatch)"}),(0,w.jsx)("circle",{cx:i,cy:n,r:"10",fill:"white",strokeWidth:"1",stroke:"#6e6e6e"})]})}),eR=(0,s.memo)(e=>{let{id:t,x:i="-5",y:n="-5",width:s="10",height:a="10",evolved:o,onClick:l,styles:r={}}=e,c=o?r.evolvedFill:r.fill,m=o?r.evolved:r.stroke;return(0,w.jsx)("rect",{onClick:l,id:t,x:i,y:n,fill:c,stroke:m,width:s,height:a,strokeWidth:r.pipelineStrokeWidth})}),eG=function(e){let{element:t,mapDimensions:i,mapText:n,mutateMapText:s,children:a}=e,o=new k,l=o.maturityToX(t.maturity,i.width),r=o.visibilityToY(t.visibility,i.height)+(t.offsetY?t.offsetY:0),c=new N(t.deaccelerator?"deaccelerator":"accelerator",n,s,[P,M]);return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(L,{id:"accelerator_element_"+t.id,onMove:function(e){let n=o.yToVisibility(e.y,i.height),s=o.xToMaturity(e.x,i.width);c.update({param1:n,param2:s},t.name)},x:l,y:r,fixedY:t.evolved,fixedX:!1,shouldShowMoving:!1,isModKeyPressed:!1,scaleFactor:e.scaleFactor,children:(0,w.jsx)(w.Fragment,{children:a})})})},eU=(0,s.memo)(e=>{let{id:t,onClick:i,isDeAccelerator:n}=e;return(0,w.jsxs)("g",{transform:["translate(-25, -25)"].concat(n?"rotate(180,25,25)":"").join(" "),id:t,onClick:i,children:[(0,w.jsx)("g",{opacity:"0.8",fill:"url(#arrowGradient)",children:(0,w.jsx)("path",{d:"m25.5 6 18 18 -18 18v-9H9a1.5 1.5 0 0 1 -1.5 -1.5V16.5a1.5 1.5 0 0 1 1.5 -1.5h16.5Z"})}),(0,w.jsx)("path",{d:"m44.561 22.939 -18 -18A1.5 1.5 0 0 0 24 6v7.5H9a3.003 3.003 0 0 0 -3 3v15a3.003 3.003 0 0 0 3 3h15v7.5a1.5 1.5 0 0 0 2.561 1.06l18 -18a1.5 1.5 0 0 0 0 -2.121ZM27 38.379V33a1.5 1.5 0 0 0 -1.5 -1.5H9V16.5h16.5a1.5 1.5 0 0 0 1.5 -1.5V9.621L41.379 24Z"})]})});var eV=i(3563),eK=i(8724),eZ=i(7531),eJ=i(8459),eq=i(7198),eQ=i(5438),e$=i(7438),e0=i(8887),e1=i(4061),e2=i(9810),e5=i(317);let e9=(0,e5.A)(()=>({mapCanvas:{userSelect:"none"}})),e3=function(e){let{enableAccelerators:t,enableNewPipelines:i,showMapToolbar:n,showMiniMap:a,allowMapZoomMouseWheel:o}=(0,E.Y)(),l=e9(),{mapComponents:r,mapSubMaps:c,mapMarkets:m,mapEcosystems:p,mapEvolved:d,mapPipelines:u,setNewComponentContext:h,mapLinks:x,showLinkedEvolved:y,mapMethods:f,mapRef:v,mapEvolutionStates:g,mapAttitudes:b,setMetaText:j,metaText:O,launchUrl:C,mapNotes:F,mapAnnotations:L,mapAnnotationsPresentation:N,mapDimensions:M,mapText:P,mutateMapText:W,mapStyleDefs:z,setHighlightLine:I,mapAnchors:H,evolutionOffsets:X,mapAccelerators:B,mapTitle:R}=e,G=Z(),{0:U,1:V}=(0,s.useState)([]),{0:K,1:q}=(0,s.useState)({x:0,y:0}),Q=(0,s.useRef)(null),{0:$,1:ei}=(0,s.useState)(e0.qD),{0:en,1:es}=(0,s.useState)(1),eo=()=>{Q.current.fitSelection(-35,-45,e.mapDimensions.width+70,e.mapDimensions.height+92)},er=(e,t)=>{ei(t)},em={color:"#90caf9"},ep={color:"rgba(0, 0, 0, 0.54)"};(0,s.useEffect)(()=>{Q.current&&eo()},[]);let ed=new D([{collection:r,type:"component"},{collection:c,type:"submap"},{collection:m,type:"market"},{collection:p,type:"ecosystem"}],d,u);var ex=function(e,t){return e.find(function(e){return e.name===t})};(0,s.useEffect)(()=>{!1===G&&V([])},[G]);let ef=function(e){if(I(e.el.line),!1===G)return;let t=[...U,{el:e.el,e:{pageX:e.e.pageX,pageY:e.e.pageY}}];2===t.length?(W(P+"\r\n"+t.map(e=>e.el.name).join("->")),V([])):V(t)},ev=new eN(x,ed,H,y),eg=(0,s.useMemo)(()=>ev.build(),[ev]),ek=e=>Object.assign({},{name:e.name,maturity:e.maturity,visibility:e.visibility,method:e.decorators.method}),ew=ed.getMergedElements().filter(e=>e.decorators&&e.decorators.method).map(e=>ek(e)),ej=f.filter(e=>ex(ed.getNonEvolvedElements(),e.name)).map(e=>ek(Object.assign(ex(ed.getNonEvolvedElements(),e.name),{decorators:{method:e.method}}))).concat(ew);return(0,w.jsxs)(s.Fragment,{children:[(0,w.jsx)(e0.fP,{ref:Q,id:"wm-svg-pan-zoom",SVGBackground:"white",tool:$,width:e.mapCanvasDimensions.width+90,height:e.mapCanvasDimensions.height+30,detectAutoPan:!1,detectWheel:o,miniatureProps:{position:a?"right":"none"},toolbarProps:{position:"none"},SVGStyle:{x:"-30",y:"-40",height:e.mapDimensions.height+90,width:e.mapDimensions.width+60},fontFamily:z.fontFamily,fontSize:z.fontSize,background:"#eee",onDoubleClick:function(){let e=new k;h({x:e.xToMaturity(K.x,M.width),y:e.yToVisibility(K.y,M.height)})},onMouseMove:e=>{q({x:e.x,y:e.y})},onZoom:e=>{es(e.a)},onZoomReset:()=>es(1),className:[z.className,l.mapCanvas].join(" "),style:{userSelect:"none",fontFamily:z.fontFamily},children:(0,w.jsxs)("svg",{ref:v,id:"svgMap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,w.jsx)(eP,{mapStyleDefs:z}),(0,w.jsxs)("g",{id:"grid",children:[(0,w.jsx)(e_,{mapDimensions:M,mapStyleClass:z.className}),(0,w.jsx)(eW,{mapTitle:R}),(0,w.jsx)(A,{mapDimensions:M,mapStyleDefs:z,evolutionOffsets:X}),(0,w.jsx)(T,{mapDimensions:M,mapEvolutionStates:g,mapStyleDefs:z,evolutionOffsets:X})]}),(0,w.jsxs)("g",{id:"map",children:[(0,w.jsx)("g",{id:"attitudes",children:b.map((e,t)=>(0,w.jsx)(eb,{mapDimensions:M,mapStyleDefs:z,mapText:P,mutateMapText:W,attitude:e,scaleFactor:en},t))}),(0,w.jsx)("g",{id:"methods",children:ej.map((e,t)=>(0,w.jsx)(S,{element:e,mapStyleDefs:z,mapDimensions:M,method:e.method},t))}),(0,w.jsx)("g",{id:"fluids",children:U.map((e,t)=>(0,w.jsx)(et,{mapStyleDefs:z,mapDimensions:M,startElement:e.el,origClick:e.e,scaleFactor:en},t))},"fluids"),eg.map(t=>(0,w.jsx)("g",{id:t.name,children:t.links.map((t,i)=>(0,w.jsx)(ee,{setMetaText:j,metaText:O,mapStyleDefs:z,mapDimensions:M,startElement:t.startElement,endElement:t.endElement,link:t.link,scaleFactor:e.scaleFactor},i))},t.name)),(0,w.jsxs)("g",{id:"evolvedLinks",children:[ed.getEvolveElements().map((e,t)=>(0,w.jsx)(ea,{mapStyleDefs:z,mapDimensions:M,startElement:ex(ed.getEvolvedElements(),e.name),endElement:ex(ed.getEvolveElements(),e.name),link:e,evolutionOffsets:X},t)),";"]}),(0,w.jsx)("g",{id:"anchors",children:H.map((e,t)=>(0,w.jsx)(eh,{mapDimensions:M,anchor:e,mapText:P,mutateMapText:W,mapStyleDefs:z,setHighlightLine:I,onClick:t=>ef({el:e,e:t}),scaleFactor:en},t))}),(0,w.jsx)("g",{id:"accelerators",children:t&&B.map((e,t)=>(0,w.jsx)(eG,{element:e,mapDimensions:M,mapText:P,mutateMapText:W,children:(0,w.jsx)(eU,{id:"market_circle_"+e.id,isDeAccelerator:e.deaccelerator,onClick:()=>I(e.line)})},t))}),(0,w.jsx)("g",{id:"pipelines",children:i&&ed.getMapPipelines().filter(e=>!1==e.hidden).map((e,t)=>(0,w.jsx)(s.Fragment,{children:i&&void 0!=e.components&&e.components.length>0?(0,w.jsx)(J,{mapDimensions:M,pipeline:e,mapText:P,mutateMapText:W,setMetaText:j,metaText:O,mapStyleDefs:z,setHighlightLine:I,linkingFunction:ef,scaleFactor:en},"pipeline_"+t):(0,w.jsx)(Y,{mapDimensions:M,pipeline:e,mapText:P,mutateMapText:W,setMetaText:j,metaText:O,mapStyleDefs:z,setHighlightLine:I,scaleFactor:en},t)},t))}),(0,w.jsx)("g",{id:"elements",children:ed.getMergedElements().map((e,t)=>(0,w.jsxs)(el,{keyword:e.type,launchUrl:C,mapDimensions:M,element:e,mapText:P,mutateMapText:W,setMetaText:j,metaText:O,mapStyleDefs:z,setHighlightLine:I,scaleFactor:en,children:["component"===e.type&&(0,w.jsx)(_,{id:"element_circle_"+e.id,styles:z.component,evolved:e.evolved,onClick:t=>ef({el:e,e:t})}),e.pipeline&&(0,w.jsx)(eR,{id:"element_square_"+e.id,styles:z.component,evolved:e.evolved,onClick:t=>ef({el:e,e:t})}),e.decorators&&e.decorators.ecosystem||"ecosystem"===e.type?(0,w.jsx)(eB,{id:"ecosystem_circle_"+e.id,styles:z.component,onClick:t=>ef({el:e,e:t})}):null,e.decorators&&e.decorators.market||"market"===e.type?(0,w.jsx)(eX,{id:"market_circle_"+e.id,styles:z.component,onClick:t=>ef({el:e,e:t})}):null,"submap"===e.type&&(0,w.jsx)(eY,{id:"element_circle_"+e.id,styles:z.submap,evolved:e.evolved,onClick:t=>ef({el:e,e:t}),launchUrl:()=>C(e.url)})]},t))}),(0,w.jsx)("g",{id:"notes",children:F.map((e,t)=>(0,w.jsx)(ey,{mapDimensions:M,note:e,mapText:P,mutateMapText:W,mapStyleDefs:z,setHighlightLine:I,scaleFactor:en},t))}),(0,w.jsxs)("g",{id:"annotations",children:[L.map((e,t)=>(0,w.jsx)(s.Fragment,{children:e.occurances.map((i,n)=>(0,w.jsx)(ec,{mapStyleDefs:z,annotation:e,occurance:i,occuranceIndex:n,mapDimensions:M,mutateMapText:W,mapText:P,scaleFactor:en},n+"_"+t))},t)),0===L.length?null:(0,w.jsx)(eu,{mapStyleDefs:z,mutateMapText:W,mapText:P,annotations:L,position:N,mapDimensions:M,scaleFactor:en})]})]})]})}),n&&(0,w.jsxs)(e1.A,{orientation:"horizontal","aria-label":"button group",children:[(0,w.jsx)(e2.A,{id:"wm-map-select","aria-label":"Select",onClick:e=>er(e,e0.qD),sx:$===e0.qD?em:ep,children:(0,w.jsx)(eJ.A,{})}),(0,w.jsx)(e2.A,{id:"wm-map-pan","aria-label":"Pan",onClick:e=>er(e,e0.JN),sx:$===e0.JN?em:ep,children:(0,w.jsx)(eZ.A,{})}),(0,w.jsx)(e2.A,{id:"wm-zoom-in","aria-label":"Zoom In",sx:$===e0.p7?em:ep,onClick:e=>er(e,e0.p7),children:(0,w.jsx)(eV.A,{})}),(0,w.jsx)(e2.A,{id:"wm-zoom-out","aria-label":"Zoom Out",sx:$===e0.Wm?em:ep,onClick:e=>er(e,e0.Wm),children:(0,w.jsx)(eK.A,{})}),(0,w.jsx)(e2.A,{id:"wm-map-fit","aria-label":"Fit",sx:ep,onClick:()=>eo(),children:(0,w.jsx)(eq.A,{})}),(0,w.jsx)(e2.A,{id:"wm-map-fullscreen",onClick:e.shouldHideNav,color:{wardley:"black",colour:"black",plain:"black",handwritten:"black",dark:"white"}[e.mapStyleDefs.className],"aria-label":e.hideNav?"Exit Fullscreen":"Fullscreen",children:e.hideNav?(0,w.jsx)(e$.A,{sx:ep}):(0,w.jsx)(eQ.A,{sx:ep})})]})]})};var e8=i(7214),e4=i(3216),e6=i(8175),e7=i(6764);let te="120px",tt="50px",ti="40px",tn=(0,s.memo)(e=>{let{title:t="",style:i={},mapStyleDefs:n,width:s="100%",className:a="",height:o="100%",viewBox:l,children:r,onClick:c}=e;return(0,w.jsxs)("svg",{fontFamily:null==n?void 0:n.fontFamily,fontSize:null==n?void 0:n.fontSize,className:a||(null==n?void 0:n.className),width:s,height:o,style:i,onClick:c,viewBox:l,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,w.jsx)("title",{children:t}),r]})}),ts=e=>(0,w.jsxs)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:[!1===e.hideLabel&&(0,w.jsx)(B,{styles:e.mapStyleDefs.component,text:e.text||"Component",x:"8",y:"15",evolved:e.evolved}),(0,w.jsx)(_,{cx:e.cx?e.cx:"8px",cy:e.cy?e.cy:"25px",evolved:e.evolved,styles:e.mapStyleDefs.component})]}),ta=e=>{var t;return(0,w.jsx)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:(0,w.jsx)(B,{note:"note",styles:null==e||null==(t=e.mapStyleDefs)?void 0:t.note,x:"1",y:"20"})})},to=e=>(0,w.jsx)(ts,{mapStyleDefs:e.mapStyleDefs,evolved:!0,text:"Evolution"}),tl=e=>(0,w.jsxs)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:[!1===e.hideLabel&&(0,w.jsx)(B,{styles:e.mapStyleDefs.component,text:"Inertia",x:"8",y:"15"}),(0,w.jsx)(_,{styles:e.mapStyleDefs.component,cx:"8px",cy:"25px"}),(0,w.jsx)(ei,{x:50,y:25})]}),tr=e=>(0,w.jsxs)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:[!1===e.hideLabel&&(0,w.jsx)(B,{styles:e.mapStyleDefs.component,text:"Market",x:"45",y:"15"}),(0,w.jsx)("g",{transform:"translate(20 20) scale(0.8)",children:(0,w.jsx)(eX,{styles:e.mapStyleDefs.component})})]}),tc=e=>(0,w.jsxs)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:[!1===e.hideLabel&&(0,w.jsx)(B,{styles:e.mapStyleDefs.component,text:e.method,x:"45",y:"15"}),(0,w.jsx)("g",{transform:"translate(21 21) scale(0.8)",children:(0,w.jsx)(j,{method:e.method.toLowerCase(),styles:e.mapStyleDefs.methods,x:"0",y:"0"})}),(0,w.jsx)(_,{styles:e.mapStyleDefs.component,cx:"21px",cy:"21px"})]}),tm=e=>(0,w.jsx)(tc,{method:"Buy",onClick:e.onClick,mapStyleDefs:e.mapStyleDefs,hideLabel:e.hideLabel}),tp=e=>(0,w.jsx)(tc,{method:"Build",onClick:e.onClick,mapStyleDefs:e.mapStyleDefs,hideLabel:e.hideLabel}),td=e=>(0,w.jsx)(tc,{method:"Outsource",onClick:e.onClick,mapStyleDefs:e.mapStyleDefs,hideLabel:e.hideLabel}),tu=e=>(0,w.jsxs)(tn,{width:e.hideLabel?tt:te,height:ti,mapStyleDefs:e.mapStyleDefs,onClick:e.onClick,children:[!1===e.hideLabel&&(0,w.jsx)(B,{styles:e.mapStyleDefs.component,text:"Ecosystem",x:"45",y:"15"}),(0,w.jsx)("g",{transform:"translate(21 21) scale(0.5)",children:(0,w.jsx)(eB,{styles:e.mapStyleDefs.component})})]}),th=(0,e5.A)(()=>({smallerSpeedDial:{"& .MuiSpeedDial-fab":{width:"32px",height:"32px",minHeight:"32px",minWidth:"32px"}}}));function tx(e){let t=th(),{setQuickAdd:i}=e,n=[{name:"Component",icon:(0,w.jsx)(ts,{cx:"20px",cy:"20px",hideLabel:!0,mapStyleDefs:{component:{stroke:"white",fill:"transparent",strokeWidth:"1px",radius:"5"}},evolved:!1}),onClick:(e,t)=>{e({cursor:(0,w.jsx)(_,{styles:t.mapStyleDefs.component,cx:"8px",cy:"8px"}),template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"]")})}},{name:"Component Inertia",icon:(0,w.jsx)(tl,{cx:"20px",cy:"20px",hideLabel:!0,mapStyleDefs:{component:{stroke:"white",fill:"transparent",strokeWidth:"1px",radius:"5"}},evolved:!1}),onClick:(e,t)=>{e({cursor:(0,w.jsx)(_,{styles:t.mapStyleDefs.component,cx:"8px",cy:"8px"}),template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"]")})}},{name:"Market",icon:(0,w.jsx)(tr,{cx:"20px",cy:"20px",hideLabel:!0,mapStyleDefs:{component:{stroke:"white",fill:"transparent",strokeWidth:"1px",radius:"5"}},evolved:!1}),onClick:(e,t)=>{e({cursor:(0,w.jsx)(eX,{styles:t.mapStyleDefs.component,cx:"8px",cy:"8px"}),template:(e,t,i)=>"market ".concat(e," [").concat(t,", ").concat(i,"]")})}},{name:"Ecosystem",icon:(0,w.jsx)(tu,{cx:"20px",cy:"20px",hideLabel:!0,mapStyleDefs:{component:{stroke:"white",fill:"transparent",strokeWidth:"1px",radius:"5"}},evolved:!1}),onClick:(e,t)=>{e({cursor:(0,w.jsx)(eB,{styles:t.mapStyleDefs.component,cx:"8px",cy:"8px"}),template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"]")})}}];return(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(e8.A,{sx:{transform:"translateZ(0px)",flexGrow:1},children:(0,w.jsx)(e4.A,{ariaLabel:"SpeedDial basic example",className:t.smallerSpeedDial,sx:{position:"absolute",top:-10,right:60},icon:(0,w.jsx)(e6.A,{}),direction:"left",children:n.map(t=>(0,w.jsx)(e7.A,{icon:t.icon,tooltipTitle:t.name,onClick:()=>t.onClick(i,e)},t.name))})})})}var ty=i(1454);function tf(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function tv(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tf(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tf(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function tg(e){let t=(0,E.Y)(),{0:i,1:n}=(0,s.useState)("default"),{0:a,1:o}=(0,s.useState)(()=>()=>console.log("nullTemplate")),{0:l,1:r}=(0,s.useState)(!1);return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("div",{ref:e.mapRef,className:e.mapStyleDefs.className,style:{background:{wardley:"url(#wardleyGradient)",colour:"none",plain:"none",handwritten:"none",dark:"#353347"}[e.mapStyleDefs.className],position:"relative",cursor:i},children:[t.enableQuickAdd&&(0,w.jsx)(tx,tv({setQuickAdd:e=>{r(!0);let t=function(e,t,i){console.log(e);let n=btoa('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'.concat(15,'px" height="').concat(15,'px">').concat(e,"</svg>"));return"url('data:image/svg+xml;base64,".concat(n,"')")}(ty.renderToString(e.cursor),15,15);console.log("MapView::setQuickAdd::icon",t),n(t+" 8 8, auto"),o(()=>()=>e.template)}},e)),(0,w.jsx)("div",{id:"map",children:(0,w.jsx)(e3,tv({handleMapCanvasClick:i=>{if(!1!=t.enableQuickAdd&&(console.log("MapView::handleMapCanvasClick",i),l)){console.log("MapView::handleMapCanvasClick::quickAddTemplate",a);let t=a()("text",i.y,i.x);e.mutateMapText(e.mapText+"\r\n".concat(t)),r(!1),n("default")}}},e))})]})})}let tb=["outsource <component>","build <component>","buy <component>",...[...["pioneers","settlers","townplanners"].map(e=>[e,"[<visibility>, <maturity>, <visibility2>, <maturity2>]"]),["note","<note text>","[<visibility>, <maturity>]"],["component","<name>","[<visibility>, <maturity>]"],["accelerator","<name>","[<visibility>, <maturity>]"],["deaccelerator","<name>","[<visibility>, <maturity>]"],["submap","<name>","[<visibility>, <maturity>]","url(<url>)"],["url","<name>","[<address>]"],["size","[<width>, <height>]"]].map(e=>{let t=[];for(let i=0;i<e.length;i++)t.push(e.slice(0,i+1).join(" "));return t}).flat(),"anchor","annotation","annotations","style","style wardley","style colour","style handwritten","style plain","style dark","ecosystem","market","evolve","inertia","pipeline","title","size","evolution","accelerator","deaccelerator"];var tk=i(8847);function tw(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function tj(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tw(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tw(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let tS=i.n(tk)()(()=>i.e(366).then(i.bind(i,4538)),{ssr:!1,loadableGenerated:{webpack:()=>[4538]}}),tE=s.forwardRef((e,t)=>(0,w.jsx)(tS,tj(tj({},e),{},{editorRef:t})));tE.displayName="ForwardedRefComponent";let tO=function(e){let{0:t,1:i}=(0,s.useState)(10),{0:n,1:a}=(0,s.useState)({prefix:tb,elements:[]}),o=s.createRef(),{hideNav:l}=e,r=e=>({getCompletions:function(t,i,n,s,a){let o=e.elements.map(e=>({name:e,value:e,score:1,meta:"Element"}));a(null,e.prefix.map(e=>({name:e,value:e,score:1,meta:"Syntax"})).concat(o))}}),c=()=>window.innerHeight-document.getElementById("top-nav-wrapper").clientHeight+35;(0,s.useEffect)(()=>{let e=()=>{i(c())};return window.addEventListener("load",e),window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e),window.removeEventListener("load",e)}},[]),(0,s.useEffect)(()=>{i(c())},[l]),(0,s.useEffect)(()=>{var t=e.highlightLine;let i=o.current;null!==i&&i.editor.gotoLine(parseInt(t))},[e.highlightLine]),(0,s.useEffect)(()=>{let t=o.current;if(null!==t){let n=t.editor;for(var i=0;i<n.session.getLength();i++)n.session.removeGutterDecoration(i,"ace_error");e.errorLine.length>0&&e.errorLine.forEach(e=>n.session.addGutterDecoration(e,"ace_error"))}},[e.errorLine]),(0,s.useEffect)(()=>{a(m(e.mapComponents.concat(e.mapAnchors).concat(e.mapSubMaps).concat(e.mapMarkets)))},[e.mapComponents,e.mapAnchors,e.mapSubMaps,e.mapMarkets]),(0,s.useEffect)(()=>{let t=o.current;null!==t&&t.editor.setTheme("ace/theme/"+(e.isLightTheme?"eclipse":"dracula"))},[e.isLightTheme,o]),(0,s.useEffect)(()=>{let e=o.current;null!==e&&(e.editor.completers=[r(n)])},[n,o]);let m=e=>({elements:e.map(e=>e.name),prefix:tb});return(0,w.jsx)("div",{id:"htmPane",className:e.invalid?" invalid":"",children:(0,w.jsx)(tE,{ref:o,mode:"owm",keyboardHandler:"vscode",theme:e.isLightTheme?"eclipse":"dracula",onChange:e.mutateMapText,name:"htmEditor",value:e.mapText,showGutter:e.showLineNumbers||e.errorLine.length>0,width:"",height:t+"px",showPrintMargin:!1,debounceChangePeriod:1e3,editorProps:{$blockScrolling:!0},setOptions:{showLineNumbers:e.showLineNumbers,enableBasicAutocompletion:[r(n)],enableLiveAutocompletion:!0}})})};var tC=i(6058),tD=i(6778),tA=i(7434);let tT=e=>{let{currentUrl:t}=e;return(0,w.jsx)(tC.Ay,{container:!0,spacing:2,padding:1,children:(0,w.jsx)(tC.Ay,{item:!0,xs:6,children:(0,w.jsxs)(tD.A,{children:["Your Map:"," ",(0,w.jsx)(tA.A,{href:-1===t.indexOf("#")?"#":t,id:"url","data-testid":"breadcrumb-list-item-your-map",children:-1===t.indexOf("#")?"(unsaved)":t})]})})})};class tF{constructor(e){this.data=e}apply(){if(this.data.trim().length<1)return{title:"Untitled Map"};let e=this.data;for(let t=0;t<e.split("\n").length;t++){let i=e.split("\n")[t];if(0===i.indexOf("title"))return{title:i.split("title ")[1].trim()}}return{title:"Untitled Map"}}}class tL extends Error{constructor(e){super("ParseError on line ".concat(e)),this.name="ParseError",this.line=e}}class tN{constructor(e,t,i){this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.config=t,this.decorators=null!=i?i:[]}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(0===i.trim().indexOf("".concat(this.keyword," "))){let e=o()({id:1+n,line:1+n},this.config.defaultAttributes);this.decorators.forEach(t=>t(e,i,{keyword:this.keyword,containerName:this.containerName,config:this.config})),t.push(e)}}catch(e){console.log(e),i.push[new tL(n)]}return{[this.containerName]:t,errors:i}}}function tM(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}let tP=(e,t,i)=>Object.assign(e,{number:parseInt(t.split("".concat(i.keyword," "))[1].trim().split(" [")[0].trim())}),tW=(e,t)=>{if(-1!==t.indexOf("url("))return Object.assign(e,{url:t.split("url(")[1].split(")")[0].trim()})},t_=(e,t)=>{let i="";if(t.trim().indexOf("]")>-1&&t.trim().indexOf("]")!==t.trim().length-1&&(-1===t.replace(/\s/g,"").indexOf("]]")&&(i=t.split("]")[1].trim()),t.replace(/\s/g,"").indexOf("]]")>-1)){var n=t.lastIndexOf("]");i=t.substr(n+1,t.length-1).trim()}return Object.assign(e,{text:i})},tY=(e,t)=>{let i={visibility:.9,maturity:.1},n=[];return t.replace(/\s/g,"").indexOf("[[")>-1?("["+t.replace(/\s/g,"").split("[[")[1].split("]]")[0]+"]").replace(/\],\[/g,"]|[").split("|").forEach(e=>{n.push(tH(e,i))}):t.indexOf("[")>-1&&t.indexOf("]")>-1&&n.push(tH(t,i)),Object.assign(e,{occurances:n})},tz=(e,t)=>{let i=!0,n={maturity1:.2,maturity2:.8},s=t.split("[");if(t.indexOf("[")>-1&&t.indexOf("]")>-1&&s.length>1&&s[1].indexOf("]")>-1){let e=s[1].split("]")[0].split(",");n.maturity1=parseFloat(e[0].trim()),n.maturity2=parseFloat(e[1].trim()),i=!1}return Object.assign(e,{hidden:i},{maturity2:n.maturity2},{maturity1:n.maturity1})},tI=(e,t)=>{let i={maturity:.2},n=t.split("[");return t.indexOf("[")>-1&&t.indexOf("]")>-1&&n.length>1&&n[1].indexOf("]")>-1&&(i.maturity=parseFloat(n[1].split("]")[0].trim())),Object.assign(e,{maturity:i.maturity})},tH=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{visibility:isNaN(parseFloat(i[0]))?t.visibility:parseFloat(i[0]),maturity:isNaN(parseFloat(i[1]))?t.maturity:parseFloat(i[1])}}},tX=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{width:isNaN(parseFloat(i[0]))?t.width:parseFloat(i[0]),height:isNaN(parseFloat(i[1]))?t.height:parseFloat(i[1])}}},tB=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{visibility:isNaN(parseFloat(i[0]))?t.visibility:parseFloat(i[0]),maturity:isNaN(parseFloat(i[1]))?t.maturity:parseFloat(i[1]),visibility2:isNaN(parseFloat(i[2]))?t.visibility2:parseFloat(i[2]),maturity2:isNaN(parseFloat(i[3]))?t.maturity2:parseFloat(i[3])}}},tR=(e,t,i)=>Object.assign(e,{name:t.split("".concat(i.keyword," "))[1].trim()},{method:i.keyword}),tG=(e,t,i)=>Object.assign(e,{attitude:i.keyword}),tU=(e,t)=>{if(!t.includes("]"))return e;let[i,n]=t.split("]")[1].trim().split(" ");return Object.assign(e,{width:i,height:n})},tV=(e,t)=>{let i=t.split("evolve ")[1].trim(),n="",s=t.match(/\s[0-9]?\.[0-9]+[0-9]?/),a=.85;if(s.length>0){a=parseFloat(s[0]);let e=i.split(a)[0].trim();(i=e.split(a)[0].trim()).indexOf("->")>-1&&(n=e.split("->")[1].trim(),i=e.split("->")[0].trim())}return Object.assign(e,{name:i,override:n},{maturity:a})},tK=(e,t)=>{let i=tH(t,{visibility:.9,maturity:.1});return Object.assign(e,{maturity:i.maturity},{visibility:i.visibility})},tZ=(e,t)=>Object.assign(e,{deaccelerator:0==t.indexOf("deaccelerator")}),tJ=(e,t)=>{let i=tB(t,{visibility:.9,maturity:.1,visibility2:.8,maturity2:.2});return Object.assign(e,{maturity:i.maturity},{visibility:i.visibility},{maturity2:i.maturity2},{visibility2:i.visibility2})},tq=(e,t)=>{let i=["build","buy","outsource"],n={},s={};for(let e=0;e<i.length;e++){let a=i[e];t.indexOf(a)>-1&&t.indexOf("(")<t.indexOf(a)&&t.indexOf(")")>t.indexOf(a)&&(n=Object.assign(n,{method:a}),s=Object.assign(s,{increaseLabelSpacing:2}))}return o()(e,{decorators:n},s)},tQ=(e,t)=>{let i=["market"],n={},s={};for(let e=0;e<i.length;e++){let a=i[e];t.indexOf(a)>-1&&t.indexOf("(")<t.indexOf(a)&&t.indexOf(")")>t.indexOf(a)&&(n=Object.assign(n,{market:!0}),s=Object.assign(s,{increaseLabelSpacing:2}))}return o()(e,{decorators:n},s)},t$=(e,t)=>{let i=["ecosystem"],n={},s={};for(let e=0;e<i.length;e++){let a=i[e];t.indexOf(a)>-1&&t.indexOf("(")<t.indexOf(a)&&t.indexOf(")")>t.indexOf(a)&&(n=Object.assign(n,{ecosystem:!0}),s=Object.assign(s,{increaseLabelSpacing:3}))}return o()(e,{decorators:n},s)},t0=(e,t)=>([tq,tQ,t$].forEach(i=>o()(e,i(e,t))),e),t1=(e,t)=>{let i=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tM(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tM(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({},h);if(e.increaseLabelSpacing&&(i={x:i.x*e.increaseLabelSpacing,y:i.y*e.increaseLabelSpacing}),t.indexOf("label ")>-1){let e=t.split("label [");if(e.length>0&&e[1].indexOf("]")>-1){let t=e[1].split("]")[0].split(",");i.x=parseFloat(t[0].trim()),i.y=parseFloat(t[1].trim())}}return Object.assign(e,{label:i})},t2=(e,t)=>{let i;return t.indexOf("evolve ")>-1&&(i=(i=t.split("evolve ")[1].trim()).replace("inertia","").trim()),Object.assign(e,{evolveMaturity:i},{evolving:null!=i})},t5=(e,t)=>Object.assign(e,{inertia:-1!==t.indexOf("inertia")}),t9=(e,t,i)=>{let n=t.indexOf(i.keyword);return Object.assign(e,{text:t.substr("".concat(i.keyword," ").length+n,t.length-"".concat(i.keyword," ").length+n).trim().split(" [")[0].trim()})},t3=(e,t,i)=>Object.assign(e,{name:t.split("".concat(i.keyword," "))[1].trim().split(" [")[0].trim()}),t8=(e,t)=>Object.assign(e,{url:t.split("[")[1].trim().split("]")[0].trim()});class t4{constructor(e){this.data=e,this.containerName="methods",this.baseStrategies=["buy","outsource","build"].map(t=>new tN(e,{keyword:t,containerName:"methods",defaultAttributes:{}},[tR])).flat()}apply(){let e=this.baseStrategies.map(e=>e.apply()).flat();return{[this.containerName]:e.map(e=>e.methods).flat()}}}class t6{constructor(e){this.data=e}apply(){let e=this.data.split("\n"),t=[];for(let i=0;i<e.length;i++){let n=e[i];try{if(0===n.trim().indexOf("evolution")){let e=n.split("evolution ")[1].trim().split("->");return{evolution:[{line1:e[0],line2:""},{line1:e[1],line2:""},{line1:e[2],line2:""},{line1:e[3],line2:""}]}}}catch(e){t.push(tL(i))}}return{evolution:[{line1:"Genesis",line2:""},{line1:"Custom-Built",line2:""},{line1:"Product",line2:"(+rental)"},{line1:"Commodity",line2:"(+utility)"}],errors:t}}}class t7{constructor(e){this.data=e}apply(){let e={style:"plain",annotations:{visibility:.9,maturity:.1},size:{width:0,height:0}},t=this.data.split("\n");for(let i=0;i<t.length;i++){let n=t[i];0===n.trim().indexOf("style")&&(e.style=n.split("style ")[1].trim()),0===n.trim().indexOf("annotations ")&&(e.annotations=tH(n,{visibility:.9,maturity:.1})),0===n.trim().indexOf("size ")&&(e.size=tX(n,{width:0,height:0}))}return{presentation:e}}}class ie{constructor(e){this.data=e,this.keyword="note",this.containerName="notes",this.baseRunner=new tN(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{}},[t9,tK])}apply(){return this.baseRunner.apply()}}class it{constructor(e){let t={keyword:"annotation",containerName:"annotations",defaultAttributes:{}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.baseRunner=new tN(e,t,[tP,tY,t_])}apply(){let e=this.baseRunner.apply()[this.containerName].filter(e=>e.occurances.length>0);return{[this.containerName]:e}}}class ii{constructor(e,t,i){this.data=e,this.keyword=t.keyword,this.containerName=t.containerName;let n=[t0,tK,t3,t5,t1,t2];null!==i&void 0!==i&&(n=i.concat(n)),this.baseRunner=new tN(e,t,n)}apply(){return this.baseRunner.apply()}}class is{constructor(e){let t={keyword:"component",containerName:"elements"},i=[],n=e.split("\n"),s=!1;for(let e=0;e<n.length;e++){let t=n[e];0===t.trim().indexOf("{")&&(s=!0,i.push(" ")),s&&0===t.trim().indexOf("}")&&(s=!1,i.push(" ")),s&&!1===t.trim().includes("}")&&!1===t.trim().includes("{")&&i.push(" "),!1==s&&-1===t.trim().indexOf("}")&&i.push(t)}let a=i.join("\n");this.data=a,this.keyword=t.keyword,this.containerName=t.containerName,this.parentStrategy=new ii(a,t)}apply(){return this.parentStrategy.apply()}}class ia{constructor(e){let t={keyword:"market",containerName:"markets",defaultAttributes:{increaseLabelSpacing:!0}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.parentStrategy=new ii(e,t)}apply(){return this.parentStrategy.apply()}}class io{constructor(e){let t={keyword:"ecosystem",containerName:"ecosystems",defaultAttributes:{increaseLabelSpacing:3}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.parentStrategy=new ii(e,t)}apply(){return this.parentStrategy.apply()}}class il{constructor(e,t,i,n){this.data=e,this.keyword=t.keyword,this.childKeyword="component",this.containerName=t.containerName,this.config=t,this.decorators=null!=i?i:[],this.childDecorators=n}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(0===i.trim().indexOf("".concat(this.keyword," "))){let s=o()({id:1+n,line:1+n},this.config.defaultAttributes);if(this.decorators.forEach(e=>e(s,i,{keyword:this.keyword,containerName:this.containerName,config:this.config})),((e,t,i,n)=>{let s=[],a=!1;for(let i=1+t;i<e.length;i++){let l=e[i].trim();if(l.indexOf("{")>-1&&!a&&(a=!0),0===l.indexOf("".concat(this.keyword," "))&&!a||a&&l.indexOf("}")>-1)break;if(a&&0===l.indexOf("".concat(this.childKeyword," "))){let e=o()({id:1+t+"-"+i,line:1+i},this.config.defaultAttributes);n.forEach(t=>{t(e,l,{keyword:this.childKeyword})}),s.push(e)}}i.components=s})(e,n,s,this.childDecorators),s.components.length>0){let e=1,t=0;for(let i=0;i<s.components.length;i++){let n=s.components[i];n.maturity<e&&(e=n.maturity),n.maturity>t&&(t=n.maturity)}s.maturity1=e,s.maturity2=t,s.hidden=!1}t.push(s)}}catch(e){i.push[new tL(n)]}return{[this.containerName]:t,errors:i}}}class ir{constructor(e,t){this.data=e,this.keyword="pipeline",this.containerName="pipelines",t.enableNewPipelines?this.baseRunner=new il(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{}},[t3,tz],[t3,tI,t1]):this.baseRunner=new tN(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{}},[t3,tz])}apply(){return this.baseRunner.apply()}}class ic{constructor(e){let t={keyword:"evolve",containerName:"evolved",defaultAttributes:{}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName;let i=[t0,t1,tV];this.baseRunner=new tN(e,t,i)}apply(){return this.baseRunner.apply()}}class im{constructor(e){let t={keyword:"anchor",containerName:"anchors",defaultAttributes:{}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.baseRunner=new tN(e,t,[t3,tK])}apply(){return this.baseRunner.apply()}}class ip{constructor(e){this.data=e,this.notLinks=["evolution","anchor","evolve","component","style","build","buy","outsource","title","annotation","annotations","pipeline","note","pioneers","settlers","townplanners","submap","url","market","ecosystem","{","}","accelerator","deaccelerator","size"]}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(this.canProcessLine(i)){let e,n,s=!0,a=!1,o=!1,l,r;if(i.includes("+>"))[e,n]=i.split("+>");else if(i.includes("+<>"))[e,n]=i.split("+<>"),o=!0;else if(i.includes("+<"))[e,n]=i.split("+<"),a=!0;else if(i.includes("+'")){let r=i.split("+'");e=r[0].trim(),r[1].includes("'>")?([l,n]=r[1].split("'>"),a=!0):r[1].includes("'<>")?([l,n]=r[1].split("'<>"),o=!0,a=!0):r[1].includes("'<")&&([l,n]=r[1].split("'<"),o=!0),t.push({start:e,end:n.trim().split(";")[0].trim(),flow:s,flowValue:l,future:a,past:o})}else i.includes("->")&&([e,n]=i.split("->"),s=!1);i.includes(";")&&(r=i.split(";")[1].trim()),t.push({start:e.trim(),end:n.trim().split(";")[0].trim(),flow:s,future:a,past:o,context:r})}}catch(e){i.push(new tL(n))}return{links:t,errors:i}}canProcessLine(e){if(0===e.trim().length)return!1;let t=!0;for(let i=0;i<this.notLinks.length;i++){let n=this.notLinks[i];(0===e.trim().indexOf(n)||-1!==e.trim().indexOf("("+n+")"))&&(t=!1)}return t}}class id{constructor(e){this.data=e,this.parentStrategy=new ii(e,{keyword:"submap",containerName:"submaps"},[tW])}apply(){return this.parentStrategy.apply()}}class iu{constructor(e){this.data=e,this.keyword="url",this.containerName="urls",this.baseRunner=new tN(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{}},[t3,t8])}apply(){return this.baseRunner.apply()}}class ih{constructor(e){this.data=e,this.containerName="attitudes",this.baseStrategies=["pioneers","settlers","townplanners"].map(t=>new tN(e,{keyword:t,containerName:"attitudes",defaultAttributes:{}},[tG,tK,tJ,tU])).flat()}apply(){let e=this.baseStrategies.map(e=>e.apply()).flat();return{[this.containerName]:e.map(e=>e.attitudes).flat()}}}class ix{constructor(e){this.data=e,this.containerName="accelerators",this.baseStrategies=["accelerator","deaccelerator"].map(t=>new tN(e,{keyword:t,containerName:"accelerators",defaultAttributes:{}},[t3,tK,tZ])).flat()}apply(){let e=this.baseStrategies.map(e=>e.apply()).flat();return{[this.containerName]:e.map(e=>e.accelerators).flat()}}}class iy{constructor(e){this.featureSwitches=e}parse(e){let t=this.stripComments(e),i=[new tF(t),new t4(t),new t6(t),new t7(t),new ie(t),new it(t),new is(t),new ia(t),new io(t),new ir(t,this.featureSwitches),new ic(t),new im(t),new ip(t),new id(t),new iu(t),new ih(t),new ix(t)],n={errors:[]},s={links:[],anchors:[],evolved:[],pipelines:[],elements:[],annotations:[],notes:[],presentation:{},evolution:[],methods:[],title:"",submaps:[],markets:[],ecosystems:[],urls:[],attitudes:[],accelerators:[]};return i.forEach(e=>{let t=e.apply();s=Object.assign(s,t),t.errors&&t.errors.length>0&&(n.errors=n.errors.concat(t.errors))}),Object.assign(s,n)}stripComments(e){var t=e.split("\n").map(e=>0===e.trim().indexOf("url")?e:e.split("//")[0]);let i=[],n=!1;for(let e=0;e<t.length;e++){let s=t[e];s.indexOf("/*")>-1?(n=!0,i.push(s.split("/*")[0].trim())):n?s.indexOf("*/")>-1&&(n=!1,i.push(s.split("*/")[1].trim())):!1===n&&i.push(s)}return i.join("\n")}}var iv=i(384),ig=i(7436),ib=i(1534),ik=i(1204),iw=i(1824),ij=i(8715),iS=i(7324),iE=i(7520),iO=i(3317),iC=i(314),iD=i(1093),iA=i(3533);let iT=(0,s.memo)(function(e){let t=[{Icon:ts,template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"]")},{Icon:tl,template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"] inertia")},{Icon:tr,template:(e,t,i)=>"market ".concat(e," [").concat(t,", ").concat(i,"]")},{Icon:tu,template:(e,t,i)=>"ecosystem ".concat(e," [").concat(t,", ").concat(i,"]")},{Icon:tm,template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"] (buy)")},{Icon:tp,template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"] (build)")},{Icon:td,template:(e,t,i)=>"component ".concat(e," [").concat(t,", ").concat(i,"] (outsource)")},{Icon:ta,template:(e,t,i)=>"note ".concat(e," [").concat(t,", ").concat(i,"]")}],{newComponentContext:i,mutateMapText:n,setNewComponentContext:a,mapText:o,mapStyleDefs:l}=e,{0:r,1:c}=(0,s.useState)(!1),{0:m,1:p}=(0,s.useState)(0),[d,u]=s.useState(""),h=(0,s.useCallback)(()=>{c(!1),a(null)},[c,a]);function x(){if(0===d.trim().length)return;c(!1);let e=t[m].template(d.trim(),i.y,i.x);n(o+"\r\n".concat(e)),u("")}return(0,s.useEffect)(()=>{let e=t=>{"Escape"===t.key&&(document.removeEventListener("keyup",e),h())};return i&&(c(!0),document.addEventListener("keyup",e)),function(){document.removeEventListener("keyup",e)}},[i,h]),(0,w.jsx)(w.Fragment,{children:(0,w.jsx)(iA.A,{theme:iv._,children:(0,w.jsxs)(ib.A,{open:r,onClose:h,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,w.jsx)(ij.A,{id:"alert-dialog-title",children:"Quick Add"}),(0,w.jsxs)(iw.A,{children:[(0,w.jsxs)(iO.A,{sx:{m:1,minWidth:80,".MuiInputBase-root:before":{border:"0"}},children:[(0,w.jsx)(iS.A,{id:"type-autowidth-label",children:"Type"}),(0,w.jsx)(iC.A,{labelId:"type-autowidth-label",id:"demo-simple-select-autowidth",value:m,onChange:e=>{p(e.target.value)},label:"Type",variant:"standard",children:t.map((e,t)=>{let{Icon:i}=e;return(0,w.jsx)(iE.A,{value:t,children:(0,w.jsx)(i,{mapStyleDefs:l,hideLabel:!1})},t)})})]}),(0,w.jsx)(iO.A,{sx:{m:1,minWidth:80},children:(0,w.jsx)(iD.A,{id:"outlined-multiline-flexible",label:"Text",value:d,onChange:e=>{u(e.target.value)},autoFocus:!0,variant:"standard",sx:{"& .MuiInput-input":{height:"40px"}},onKeyPress:e=>{"Enter"===e.key&&x()}})})]}),(0,w.jsxs)(ik.A,{children:[(0,w.jsx)(ig.A,{onClick:h,children:"Cancel"}),(0,w.jsx)(ig.A,{onClick:x,children:"Add"})]})]})})})});var iF=i(3988),iL=i(4441),iN=i(434),iM=i(3915),iP=i(7156),iW=i(6339),i_=i(6843),iY=i(4857),iz=i(3832);function iI(e){let{toggleMenu:t}=e;return(0,w.jsx)(e8.A,{sx:{flexGrow:1},children:(0,w.jsx)(i_.A,{position:"static",children:(0,w.jsxs)(iY.A,{children:[(0,w.jsx)(e2.A,{size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:t,children:(0,w.jsx)(iz.A,{})}),(0,w.jsx)(tD.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:"Wardley Maps"}),e.children]})})})}var iH=i(6145);function iX(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}let iB=(0,iF.Ay)(e=>(0,w.jsx)(iN.A,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?iX(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):iX(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({elevation:0,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"}},e)))(e=>{let{theme:t}=e;return{"& .MuiPaper-root":{borderRadius:6,marginTop:t.spacing(1),minWidth:180,color:"light"===t.palette.mode?"rgb(55, 65, 81)":t.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:t.palette.text.secondary,marginRight:t.spacing(1.5)},"&:active":{backgroundColor:(0,iL.X4)(t.palette.primary.main,t.palette.action.selectedOpacity)}}}}}),iR=function(e){let{saveOutstanding:t,saveMapClick:i,mutateMapText:n,setMetaText:a,newMapClick:o,downloadMapImage:l,currentUrl:r,setShowLineNumbers:c,showLineNumbers:m,setShowLinkedEvolved:p,showLinkedEvolved:d,downloadMapAsSVG:u,setMapOnlyView:h,mapOnlyView:y,toggleMenu:f}=e,{0:v,1:g}=(0,s.useState)(null),{0:b,1:k}=(0,s.useState)(!1),j=(0,s.useRef)(null),S=()=>{let e=r.replace("#","#clone:");navigator.clipboard.writeText(e)},E=!!v,O=e=>{"function"==typeof e&&e(),g(null)},C=(0,w.jsxs)(iB,{id:"more-menu",MenuListProps:{"aria-labelledby":"more-menu-button"},anchorEl:v,open:E,onClose:O,children:[(0,w.jsx)(iE.A,{disableRipple:!0,onClick:()=>O(()=>k(!0)),children:"Get Clone URL"}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>l()),disableRipple:!0,children:"Download as PNG"}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>u()),disableRipple:!0,children:"Download as SVG"}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>c(!m)),disableRipple:!0,children:m?"Hide Line Numbers":"Show Line Numbers"}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>p(!d)),disableRipple:!0,children:d?"Hide Evolved Links":"Show Evolved Links"}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>window.open("https://docs.onlinewardleymaps.com")),disableRipple:!0,children:"Usage Guide"}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iE.A,{onClick:()=>O(()=>window.open("https://www.patreon.com/mapsascode")),disableRipple:!0,children:"Become a Patron ❤️"})]});return(0,w.jsxs)(iI,{toggleMenu:f,children:[(0,w.jsxs)(iP.A,{direction:"row",alignItems:"flex-start",spacing:.5,divider:(0,w.jsx)(iM.A,{orientation:"vertical",flexItem:!0}),children:[(0,w.jsx)(ig.A,{color:"inherit",size:"small",onClick:()=>h(!y),children:y?"Editor Mode":"Presentation Mode"}),(0,w.jsx)(ig.A,{color:"inherit",size:"small",onClick:()=>{n("title Tea Shop\nanchor Business [0.95, 0.63]\nanchor Public [0.95, 0.78]\ncomponent Cup of Tea [0.79, 0.61] label [-85.48, 3.78]\ncomponent Cup [0.73, 0.78]\ncomponent Tea [0.63, 0.81]\ncomponent Hot Water [0.52, 0.80]\ncomponent Water [0.38, 0.82]\ncomponent Kettle [0.43, 0.35] label [-57, 4]\nevolve Kettle->Electric Kettle 0.62 label [16, 5]\ncomponent Power [0.1, 0.7] label [-27, 20]\nevolve Power 0.89 label [-12, 21]\nBusiness->Cup of Tea\nPublic->Cup of Tea\nCup of Tea->Cup\nCup of Tea->Tea\nCup of Tea->Hot Water\nHot Water->Water\nHot Water->Kettle; limited by \nKettle->Power\n\nannotation 1 [[0.43,0.49],[0.08,0.79]] Standardising power allows Kettles to evolve faster\nannotation 2 [0.48, 0.85] Hot water is obvious and well known\nannotations [0.72, 0.03]\n\nnote +a generic note appeared [0.23, 0.33]\n\nstyle wardley"),a("")},children:"Example Map"}),(0,w.jsx)(ig.A,{color:"inherit",size:"small",variant:"text",id:"new-menu-button",onClick:()=>o(x.Legacy),children:"New"}),(0,w.jsx)(ig.A,{color:t?"error":"inherit",size:"small",onClick:i,variant:t?"outlined":"text",sx:t?{backgroundColor:"#d32f2f",color:"white"}:null,children:"Save"}),(0,w.jsx)(ig.A,{color:"inherit",size:"small",variant:"text",onClick:e=>{g(e.currentTarget)},id:"more-menu-button","aria-controls":E?"more-menu":void 0,"aria-haspopup":"true","aria-expanded":E?"true":void 0,children:(0,w.jsx)(iH.A,{})})]}),C,(0,w.jsxs)(ib.A,{open:b,onClose:()=>k(!1),children:[(0,w.jsx)(ij.A,{children:"Clone URL"}),(0,w.jsxs)(iw.A,{children:[(0,w.jsx)(iW.A,{children:"You can share this URL with others to allow them to create a new map using this map as its initial state."}),(0,w.jsx)(iD.A,{autoFocus:!0,margin:"dense",ref:j,id:"name",label:"Url",fullWidth:!0,variant:"standard",value:r.replace("#","#clone:")}),(0,w.jsx)(ig.A,{onClick:()=>S(),children:"Copy"})]}),(0,w.jsxs)(ik.A,{children:[(0,w.jsx)(ig.A,{onClick:()=>k(!1),children:"Cancel"}),(0,w.jsx)(ig.A,{onClick:i,children:"Save Map"})]})]})]})};var iG=i(5550),iU=i(8464),iV=i(5068),iK=i(9353),iZ=i(1845),iJ=i(9099),iq=i.n(iJ),iQ=i(9071),i$=i(6318),i0=i(8816);function i1(e){let{menuVisible:t,toggleMenu:i,submenu:n,toggleTheme:s,isLightTheme:a}=e,o=e=>{iq().push({pathname:e})},l=()=>e=>{("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&i()},r=e=>{i(),"function"==typeof e&&e()},c=[{name:"Editor",icon:(0,w.jsx)(iQ.A,{}),action:()=>r(o("/")),visible:!0},{name:"Use Classic Version",icon:(0,w.jsx)(iQ.A,{}),action:()=>r(o("https://classic.onlinewardleymaps.com")),visible:!0}],m=(0,w.jsxs)(e8.A,{sx:{width:"285px"},role:"presentation",onClick:()=>l(),onKeyDown:()=>l(),children:[(0,w.jsx)(iU.A,{children:c.filter(e=>!0===e.visible).map(e=>(0,w.jsxs)(iV.Ay,{button:!0,onClick:e.action,children:[(0,w.jsx)(iK.A,{children:e.icon}),(0,w.jsx)(iZ.A,{primary:e.name})]},e.name))}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iU.A,{children:n&&n.map(e=>(0,w.jsxs)(iV.Ay,{button:!0,onClick:()=>r(()=>e.action()),children:[(0,w.jsx)(iK.A,{children:e.icon}),(0,w.jsx)(iZ.A,{primary:e.name})]},e.name))}),(0,w.jsx)(iM.A,{}),(0,w.jsx)(iU.A,{children:(0,w.jsxs)(iV.Ay,{button:!0,onClick:()=>r(s()),children:[(0,w.jsx)(iK.A,{children:a?(0,w.jsx)(i0.A,{}):(0,w.jsx)(i$.A,{})}),(0,w.jsx)(iZ.A,{primary:a?"Enable Dark Theme":"Enable Light Theme"})]},"toggleTheme")})]});return(0,w.jsx)("div",{children:(0,w.jsx)(iG.Ay,{anchor:"left",open:t,onClose:i,children:m})})}var i2=i(9774),i5=i(6629),i9=i(3879),i3=i(1246),i8=i(2712),i4=i(950),i6=i(8451),i7=i(6879);function ne(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}let nt=function(e){let{mapIterations:t,setMapText:i,addIteration:a,setMapIterations:o,setCurrentIteration:l,currentIteration:r}=e,c=(0,iF.Ay)(e=>(0,w.jsx)(e8.A,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ne(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}({padding:1},e)))(e=>{let{theme:t}=e;return{width:"100%",boxShadow:t.shadows[4],marginBottom:"2px"}}),[m,p]=s.useState(!1),[d,u]=s.useState(!1),[h,x]=s.useState(""),y=(0,s.useRef)(null),f=e=>{"function"==typeof e&&e(),p(!1)},v=e=>{"function"==typeof e&&e(),u(!1)},g=()=>{let e=[...t];e[r].name=y.current.value,o(e)},b=function(){let e=[...t];e.splice(r,1),r>-1&&(0===e.length?l(-1):r>e.length-1||r===e.length?l(e.length-1):r<=e.length-1?l(0):l(r-1)),o(e)},k=()=>t.length,j=()=>r===k()-1,S=e=>()=>{l(e)};return(0,s.useEffect)(()=>{r>-1&&i(t[r].mapText)},[r]),(0,s.useEffect)(()=>{console.log("mapIterations",t)},[t]),(0,w.jsxs)(c,{children:[(0,w.jsx)(i2.A,{nonLinear:!0,activeStep:r,children:Array.isArray(t)&&t.map((e,t)=>(0,w.jsx)(i5.A,{children:(0,w.jsx)(i9.A,{color:"inherit",onClick:S(t),children:e.name})},t))}),(0,w.jsx)("div",{children:(0,w.jsxs)(e8.A,{sx:{display:"flex",flexDirection:"row",pt:2},children:[(0,w.jsxs)(ig.A,{disabled:r<=0,onClick:()=>{l(e=>e-1)},sx:{mr:1},size:"small",children:[(0,w.jsx)(i4.A,{})," Back"]}),(0,w.jsx)(e8.A,{sx:{flex:"1 1 auto"}}),(t.length>0||r>0)&&(0,w.jsxs)(ig.A,{size:"small",onClick:()=>{u(!0),x(t[r].name)},children:["Delete ",(0,w.jsx)(i8.A,{})]}),(t.length>0||r>0)&&(0,w.jsxs)(ig.A,{size:"small",onClick:()=>{p(!0),x(t[r].name)},children:["Rename ",(0,w.jsx)(i7.A,{})]}),(0,w.jsxs)(ig.A,{size:"small",onClick:function(){a(),-1===r&&l(0)},children:["Add ",(0,w.jsx)(i3.A,{})]}),(0,w.jsx)(e8.A,{sx:{flex:"1 1 auto"}}),(0,w.jsxs)(ig.A,{size:"small",onClick:()=>{l(j()?null:r+1)},sx:{mr:1},disabled:0===t.length||r===t.length-1,children:["Next ",(0,w.jsx)(i6.A,{})]})]})}),(0,w.jsxs)(ib.A,{open:m,onClose:f,children:[(0,w.jsx)(ij.A,{children:"Rename"}),(0,w.jsxs)(iw.A,{children:[(0,w.jsx)(iW.A,{children:"Enter a new name for the current iteration."}),(0,w.jsx)(iD.A,{autoFocus:!0,margin:"dense",id:"name",label:"Iteration Name",type:"text",fullWidth:!0,variant:"standard",defaultValue:h,inputRef:y})]}),(0,w.jsxs)(ik.A,{children:[(0,w.jsx)(ig.A,{onClick:f,children:"Cancel"}),(0,w.jsx)(ig.A,{onClick:()=>f(()=>g()),children:"Update"})]})]}),(0,w.jsxs)(ib.A,{open:d,onClose:v,"aria-labelledby":"alert-dialog-title-delete","aria-describedby":"alert-dialog-description-delete",children:[(0,w.jsx)(ij.A,{id:"alert-dialog-title-delete",children:"Are you sure?"}),(0,w.jsx)(iw.A,{children:(0,w.jsxs)(iW.A,{id:"alert-dialog-description",children:["Are you sure you want to delete iteration '",h,"'? This cannot be undone."]})}),(0,w.jsxs)(ik.A,{children:[(0,w.jsx)(ig.A,{onClick:()=>v(()=>b()),children:"Delete"}),(0,w.jsx)(ig.A,{onClick:v,autoFocus:!0,children:"Cancel"})]})]})]})},ni=[{title:"To set the title",summary:"",examples:["title My Wardley Map"]},{toolbarButtonText:"Create Component",Icon:ts,title:"To create a component",summary:"component Name [Visibility (Y Axis), Maturity (X Axis)]",examples:["component Customer [0.9, 0.5]","component Cup of Tea [0.9, 0.5]"]},{toolbarButtonText:"Inertia",Icon:tl,title:"Inertia - component likely to face resistance to change.",summary:"component Name [Visibility (Y Axis), Maturity (X Axis)] inertia",examples:["component Customer [0.95, 0.5] inertia","component Cup of Tea [0.9, 0.5] inertia","market Cup of Tea [0.9, 0.5] inertia"]},{Icon:to,title:"To evolve a component",summary:"evole Name (X Axis)",examples:["evolve Physical 0.8","evolve Cup of Tea evolve 0.8"]},{Icon:to,title:"To evolve a component with new name",summary:"evole Name->NewName (X Axis)",examples:["evolve Physical->Virtual 0.8"]},{title:"To link components",summary:"",examples:["Start Component->End Component","Customer->Cup of Tea"]},{title:"To indicate flow",summary:"",examples:["Start Component+<>End Component","Customer+<>Cup of Tea"]},{toolbarButtonText:"Create Market",Icon:ts,title:"To create a market",summary:"market Name [Visibility (Y Axis), Maturity (X Axis)]",examples:["market Customer [0.9, 0.5]","market Cup of Tea [0.9, 0.5]","evolve Customer 0.9 (market)"]},{title:"To set component as pipeline:",summary:"pipeline Component Name [X Axis (start), X Axis (end)]",examples:["pipeline Customer [0.15, 0.9]","pipeline Customer"]},{title:"To indicate flow - past components only",summary:"",examples:["Start Component+<End Component","Hot Water+<Kettle"]},{title:"To indicate flow - future components only",summary:"",examples:["Start Component+>End Component","Hot Water+>Kettle"]},{title:"To indicate flow - with label",summary:"",examples:["Start Component+'insert text'>End Component","Hot Water+'$0.10'>Kettle"]},{title:"Pioneers, Settlers, Townplanners area",summary:"Add areas indicating which type of working approach supports component development",examples:["pioneers [<visibility>, <maturity>, <visibility2>, <maturity2>]","settlers [0.59, 0.43, 0.49, 0.63]","townplanners [0.31, 0.74, 0.15, 0.95]"]},{title:"Build, buy, outsource components",summary:"Highlight a component with a build, buy, or outsource method of execution",examples:["build <component>","buy <component>","outsource <component>","component Customer [0.9, 0.2] (buy)","component Customer [0.9, 0.2] (build)","component Customer [0.9, 0.2] (outsource)","evolve Customer 0.9 (outsource)","evolve Customer 0.9 (buy)","evolve Customer 0.9 (build)"]},{title:"Link submap to a component",summary:"Add a reference link to a submap. A component becomes a link to another Wardley Map",examples:["submap Component [<visibility>, <maturity>] url(urlName)","url urlName [URL]","submap Website [0.83, 0.50] url(submapUrl)","url submapUrl [https://onlinewardleymaps.com/#clone:qu4VDDQryoZEnuw0ZZ]"]},{title:"Stages of Evolution",summary:"Change the stages of evolution labels on the map",examples:["evolution First->Second->Third->Fourth","evolution Novel->Emerging->Good->Best"]},{title:"Add notes",summary:"Add text to any part of the map",examples:["note Note Text [0.9, 0.5]","note +future development [0.9, 0.5]"]},{title:"Available styles",summary:"Change the look and feel of a map",examples:["style wardley","style handwritten","style colour","style dark"]},{title:"Accelerator/Deaccelerator",summary:"An attempt to alter the map",examples:["accelerator foobar [0.1, 0.8]","deaccelerator barbaz [0.2, 0.7]"]}],nn=e=>{let{Icon:t,mapStyleDefs:i}=e;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(tD.A,{variant:"h3",children:e.title}),e.summary.length>0?(0,w.jsxs)(tD.A,{variant:"body1",children:[e.summary," "]}):null,(0,w.jsx)(tD.A,{variant:"h5",children:"Example"}),e.examples&&e.examples.map((t,i)=>(0,w.jsx)(s.Fragment,{children:(0,w.jsx)(ns,{addOnClick:e.addOnClick,example:t})},i)),null,(0,w.jsx)(iM.A,{sx:{marginTop:2,marginBottom:2}})]})},ns=e=>(0,w.jsx)(tD.A,{children:(0,w.jsx)(tA.A,{sx:{cursor:"pointer"},onClick:()=>e.addOnClick(e.example),className:"add clickable",children:e.example})}),na=function(e){let t=t=>{let i=e.mapText;i=i+(e.mapText.trim().length>0?"\n":"")+t.trim(),e.mutateMapText(i)};return(0,w.jsx)(w.Fragment,{children:ni.map((i,n)=>(0,w.jsx)(nn,{title:i.title,Icon:i.Icon,mapStyleDefs:e.mapStyleDefs,summary:i.summary,examples:i.examples,addOnClick:t},i.key||n))})};function no(e){let{mapText:t,mutateMapText:i,mapStyleDefs:n}=e;return(0,w.jsx)("div",{className:"row usage no-gutters",children:(0,w.jsx)("div",{className:"col",children:(0,w.jsx)(na,{mapStyleDefs:n,mapText:t,mutateMapText:i})})})}class nl{constructor(e){this.callback=e}async save(e,t){throw Error("Save method must be implemented by subclasses")}}class nr extends nl{async save(e,t){let i=await fetch(u+"save",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:t?t.includes("clone:")?t.split("clone:")[1]:t:"",text:e.mapText,mapIterations:JSON.stringify(e.mapIterations)})}),n=await i.json();this.callback(n.id,n)}}let nc=async(e,t,i,n)=>{let s=new nl(n);e===x.Legacy&&(s=new nr(n)),await s.save(t,i)};class nm{constructor(e){this.callback=e}async load(e){throw Error("Load method must be implemented by subclasses")}}class np extends nm{async load(e){let t=await fetch(u+"fetch?id="+e),i=await t.json(),n={id:i.id,mapText:i.text,mapIterations:i.mapIterations?JSON.parse(i.mapIterations):[]};this.callback(x.Legacy,n)}}let nd=async(e,t,i)=>{let n={[x.Legacy]:()=>new np(t)};await n[e]().load(i)};var nu=i(1477),nh=i(5317),nx=i(9517);function ny(e,t){let i;return()=>{clearTimeout(i),i=setTimeout(()=>{i=null,e.apply(this,arguments)},t)}}let nf=()=>window.innerHeight-document.getElementById("top-nav-wrapper").clientHeight-95,nv=()=>document.getElementById("map").clientWidth-50,ng=function(e){let t=(0,E.Y)(),{toggleMenu:i,menuVisible:n,toggleTheme:a,isLightTheme:o,mapPersistenceStrategy:l,setMapPersistenceStrategy:u,shouldLoad:h,currentId:g,setCurrentId:k,setShoudLoad:j}=e,S=(0,s.useRef)(null),{0:O,1:C}=(0,s.useState)(""),{0:D,1:A}=(0,s.useState)(!1),{0:T,1:F}=(0,s.useState)(""),{0:L,1:N}=(0,s.useState)(""),{0:M,1:P}=(0,s.useState)("Untitled Map"),{0:W,1:_}=(0,s.useState)("Untitled Map"),{0:Y,1:z}=(0,s.useState)([]),{0:I,1:H}=(0,s.useState)([]),{0:X,1:B}=(0,s.useState)([]),{0:R,1:G}=(0,s.useState)([]),{0:U,1:V}=(0,s.useState)([]),{0:Z,1:J}=(0,s.useState)([]),{0:q,1:Q}=(0,s.useState)([]),{0:$,1:ee}=(0,s.useState)([]),{0:et,1:ei}=(0,s.useState)([]),{0:en,1:es}=(0,s.useState)([]),{0:ea,1:eo}=(0,s.useState)([]),{0:el,1:er}=(0,s.useState)([]),{0:ec,1:em}=(0,s.useState)([]),{0:ep,1:ed}=(0,s.useState)([]),{0:eu,1:eh}=(0,s.useState)(!1),{0:ex,1:ey}=(0,s.useState)(null),{0:ef,1:ev}=(0,s.useState)([]),{0:eg,1:eb}=(0,s.useState)([]),{0:ek,1:ew}=(0,s.useState)(v),{0:ej,1:eS}=(0,s.useState)(v),{0:eE,1:eO}=(0,s.useState)(f),{0:eC,1:eD}=(0,s.useState)("plain"),{0:eA,1:eT}=(0,s.useState)({width:0,height:0}),{0:eF,1:eL}=(0,s.useState)(r),{0:eN,1:eM}=(0,s.useState)(!1),{0:eP,1:eW}=(0,s.useState)(0),{0:e_,1:eY}=(0,s.useState)(-1),{0:ez,1:eI}=(0,s.useState)(!1),{0:eH,1:eX}=(0,s.useState)(!1),{0:eB,1:eR}=(0,s.useState)(!1),{0:eG,1:eU}=(0,s.useState)(-1),{0:eV,1:eK}=(0,s.useState)(!1),{0:eZ,1:eJ}=(0,s.useState)(!1),eq=e=>{if(N(e),eM(!0),null!==eG&&eG>-1){let t=[...eg],i=t[eG];i.mapText=e,t.splice(eG,1),t.splice(eG,0,i),eb(t)}},eQ=()=>{A(!D)},e$=async function(e){eK(!0);let t=async function(e,t){if(""===g)switch(console.log("[followOnActions::switch]",{mapPersistenceStrategy:l,currentId:g,id:e}),l){case x.Private:iq().push("/private/"+e,void 0,{shallow:!0});break;case x.Legacy:window.location.hash="#"+e;break;case x.Public:window.location.hash="#public:"+e;break;default:case x.PublicUnauthenticated:iq().push("/public/"+e,void 0,{shallow:!0})}k(e),eK(!1),C(window.location.href),eM(!1),console.log("saveToPrivateDataStore",{mapPersistenceStrategy:l,resultFromAction:t})};await nc(l,{mapText:L,name:M,imageData:"",mapIterations:eg},e,t)},e0=async function(){eK(!0),C("(loading...)"),console.log("--- Set Load Strategy: ",l),await nd(l,(e,t)=>{u(e),j(!1),N(t.mapText),t.mapIterations&&t.mapIterations.length>0&&(eb(t.mapIterations),eU(0),N(t.mapIterations[0].mapText)),C(window.location.href),0===window.location.hash.indexOf("#clone:")&&(C("(unsaved)"),eM(!0),k(""),window.location.hash=""),eM(!1),eK(!1),e===x.Legacy||u(e)},g)};async function e1(){C("(saving...)"),e$(g)}let e2=(e,t)=>{var i=document.createElement("a");document.body.appendChild(i),i.style="display: none";var n=new Blob([e],{type:"data:attachment/xml"}),s=window.URL.createObjectURL(n);i.href=s,i.download=t,i.click(),window.URL.revokeObjectURL(s)};(0,s.useEffect)(()=>{window.addEventListener("beforeunload",e=>{eN&&(e.preventDefault(),e.returnValue="")})}),(0,s.useEffect)(()=>{try{eY([]),eh(!1);var e=new iy(t).parse(L);_(e.title),er(e.annotations),Q(e.anchors),ee(e.notes),z(e.elements),H(e.submaps),B(e.markets),G(e.ecosystems),V(e.evolved),J(e.pipelines),es(e.links),ei(e.urls),ed(e.methods),eo(e.attitudes),eD(e.presentation.style),eT(e.presentation.size),em(e.accelerators),ev(e.presentation.annotations),eO({genesis:{l1:e.evolution[0].line1,l2:e.evolution[0].line2},custom:{l1:e.evolution[1].line1,l2:e.evolution[1].line2},product:{l1:e.evolution[2].line1,l2:e.evolution[2].line2},commodity:{l1:e.evolution[3].line1,l2:e.evolution[3].line2}}),e.errors.length>0&&eY(e.errors.map(e=>e.line))}catch(e){console.log("Error:",e)}},[L]),(0,s.useEffect)(()=>{document.title=M+" - OnlineWardleyMaps - Draw Wardley Maps in seconds using this free online tool"},[M]),(0,s.useEffect)(()=>{ew({width:eA.width>0?eA.width:100+nv(),height:eA.height>0?eA.height:nf()})},[eB,eZ,eA]),(0,s.useEffect)(()=>{console.log("[currentIteration, rawMapTitle, mapIterations]",[eG,W,eg]),eG>-1?P(W+" ["+eg[eG].name+"]"):P(W)},[eG,W,eg]),(0,s.useEffect)(()=>{switch(eC){case"colour":case"color":eL(d);break;case"wardley":eL(m);break;case"dark":eL(p);break;case"handwritten":eL(c);break;default:eL(r)}},[eC]),(0,s.useEffect)(()=>{h&&e0()},[h]),(0,s.useEffect)(()=>{let e=ny(()=>{ew({width:eA.width>0?eA.width:100+nv(),height:eA.height>0?eA.height:nf()})},1);return window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e)}},[eA]),(0,s.useEffect)(()=>{ew({width:eA.width>0?eA.width:100+nv(),height:eA.height>0?eA.height:nf()}),eS({width:nv(),height:nf()})},[eB,eZ]),(0,s.useEffect)(()=>{let e=()=>{eS({width:nv(),height:nf()})},t=ny(()=>{eS({width:nv(),height:nf()})},500);return window.addEventListener("load",e),window.addEventListener("resize",t),function(){window.removeEventListener("resize",t),window.removeEventListener("load",e)}},[]);let e5=[{name:D?"Hide Usage":"Show Usage",icon:(0,w.jsx)(nx.A,{}),action:()=>eQ()}];return(0,w.jsxs)(s.Fragment,{children:[(0,w.jsx)(i1,{toggleMenu:i,menuVisible:n,submenu:e5,toggleTheme:a,isLightTheme:o}),(0,w.jsxs)(e8.A,{id:"top-nav-wrapper",sx:{display:eZ?"none":"block"},children:[(0,w.jsx)(iR,{mapOnlyView:eB,setMapOnlyView:eR,currentUrl:O,saveOutstanding:eN,setMetaText:F,mutateMapText:eq,newMapClick:function(e){N(""),F(""),k(""),C("(unsaved)"),eM(!1),eU(-1),eb([]),u(e),iq().push({pathname:"/"},void 0,{shallow:!0})},saveMapClick:e1,downloadMapImage:function(){let e=S.current.getElementsByTagName("svg")[0].outerHTML,t=document.createElement("div");t.innerHTML=e,t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),b()(t,{useCORS:!0,allowTaint:!0}).then(e=>{let i=e.toDataURL("image/png"),n=document.createElement("a");n.download=M,n.href=i,n.click(),t.remove()}).catch(e=>{console.log(e),t.remove()})},showLineNumbers:ez,setShowLineNumbers:eI,showLinkedEvolved:eH,setShowLinkedEvolved:eX,downloadMapAsSVG:function(){let e=S.current.getElementsByTagName("svg")[0].outerHTML.replace(/&nbsp;/g," ").replace(/<svg([^>]*)>/,'<svg xmlns="http://www.w3.org/2000/svg"$1>');e2('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">'.concat(e),"".concat(M,".svg"))},toggleMenu:i}),(0,w.jsx)(tT,{currentUrl:O,mapPersistenceStrategy:l}),(0,w.jsx)(nt,{mapIterations:eg,setMapIterations:eb,setMapText:N,addIteration:()=>{let e=[...eg];e.push({name:"Iteration ".concat(e.length+1),mapText:L}),eb(e)},currentIteration:eG,setCurrentIteration:eU})]}),(0,w.jsxs)(tC.Ay,{container:!0,spacing:2,id:"main",sx:{marginTop:0},children:[!1===eB&&(0,w.jsx)(tC.Ay,{item:!0,xs:12,sm:4,sx:{paddingTop:"0!important",borderRight:"2px solid rgba(0, 0, 0, 0.12)"},children:(0,w.jsx)(tO,{hideNav:eZ,isLightTheme:o,highlightLine:eP,mapText:L,invalid:eu,mutateMapText:eq,mapComponents:Y,mapAnchors:q,mapDimensions:ek,mapMarkets:X,mapSubMaps:I,errorLine:e_,showLineNumbers:ez})}),(0,w.jsx)(tC.Ay,{item:!0,xs:12,sm:eB?12:8,ml:2*!!eB,className:"map-view",sx:{backgroundColor:eF.containerBackground},children:(0,w.jsx)(K,{children:(0,w.jsx)(tg,{shouldHideNav:()=>{eJ(!eZ)},hideNav:eZ,mapTitle:M,mapComponents:Y,mapMarkets:X,mapEcosystems:R,mapSubMaps:I,mapEvolved:U,mapPipelines:Z,mapAnchors:q,mapLinks:en,mapAttitudes:ea,mapAccelerators:ec,launchUrl:e=>{if(et.find(t=>t.name===e)){let t=et.find(t=>t.name===e).url;window.open(t)}},mapNotes:$,mapAnnotations:el,mapAnnotationsPresentation:ef,mapMethods:ep,mapStyleDefs:eF,mapDimensions:ek,mapCanvasDimensions:ej,mapEvolutionStates:eE,mapRef:S,mapText:L,mutateMapText:eq,setMetaText:F,metaText:T,evolutionOffsets:y,setHighlightLine:eW,setNewComponentContext:ey,showLinkedEvolved:eH})})})]}),(0,w.jsxs)(ib.A,{maxWidth:"lg",open:D,onClose:()=>A(!1),children:[(0,w.jsx)(ij.A,{children:"Usage"}),(0,w.jsxs)(iw.A,{children:[(0,w.jsx)(iW.A,{children:"Quick reference of all available map elements. You can add an example to your map by clicking the available links."}),(0,w.jsx)(e8.A,{marginTop:2,children:(0,w.jsx)(no,{mapStyleDefs:eF,mutateMapText:eq,mapText:L})})]}),(0,w.jsx)(ik.A,{children:(0,w.jsx)(ig.A,{onClick:()=>A(!1),children:"Close"})})]}),(0,w.jsx)(iT,{newComponentContext:ex,mutateMapText:eq,setNewComponentContext:ey,mapText:L,mapStyleDefs:eF}),(0,w.jsx)(nu.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:eV,children:(0,w.jsx)(nh.A,{color:"inherit"})})]})};function nb(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function nk(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?nb(Object(i),!0).forEach(function(t){(0,n.A)(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nb(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let nw=function(e){let{slug:t}=(0,iJ.useRouter)().query,{0:i,1:n}=(0,s.useState)(""),{0:a,1:o}=(0,s.useState)(x.Legacy),{0:l,1:r}=(0,s.useState)(!1);return(0,s.useEffect)(()=>{if(console.log("slug",t),void 0===t){if(window.location.hash.length>0){o(x.Legacy);let e=window.location.hash.replace("#","");e.indexOf(":")>-1&&(e=e.split(":")[1]),n(e),r(!0)}return}if(void 0!==t[0])switch(t[0]){case"public":o(x.PublicUnauthenticated);break;case"user":o(x.Public);break;case"private":o(x.Private)}void 0!==t[1]&&null!==t[1]&&(n(t[1]),r(!0))},[t]),(0,s.useEffect)(()=>{console.log("[slug::useEffect::currentId]",i)},[i]),(0,w.jsx)(s.Fragment,{children:(0,w.jsx)(ng,nk(nk({},e),{},{currentId:i,setCurrentId:n,mapPersistenceStrategy:a,setMapPersistenceStrategy:o,shouldLoad:l,setShoudLoad:r}))})}}},e=>{var t=t=>e(e.s=t);e.O(0,[366,636,792],()=>t(2936)),_N_E=e.O()}]);