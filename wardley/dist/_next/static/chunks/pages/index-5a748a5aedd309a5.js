(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{1675:(e,t,i)=>{"use strict";i.r(t),i.d(t,{__N_SSG:()=>nL,default:()=>nM});var n=i(7328),o=i.n(n),s=i(9099),a=i.n(s),l=i(4232),r=i(2087),m=i(4425),p=i(41),d=i(7417),c=i(4635),h=i(8238),u=i(319),x=i(6427),y=i(1295),v=i(3484),g=i(3028),f=i.n(g);let b="https://api.onlinewardleymaps.com/v1/maps/",k={x:5,y:-10},w={Legacy:"Legacy"},j={custom:3.5,product:8,commodity:14},E={genesis:{l1:"Genesis",l2:""},custom:{l1:"Custom Built",l2:""},product:{l1:"Product",l2:"(+rental)"},commodity:{l1:"Commodity",l2:"(+utility)"}},C={width:500,height:600},S=`title Tea Shop
anchor Business [0.95, 0.63]
anchor Public [0.95, 0.78]
component Cup of Tea [0.79, 0.61] label [-85.48, 3.78]
component Cup [0.73, 0.78]
component Tea [0.63, 0.81]
component Hot Water [0.52, 0.80]
component Water [0.38, 0.82]
component Kettle [0.43, 0.35] label [-57, 4]
evolve Kettle->Electric Kettle 0.62 label [16, 5]
component Power [0.1, 0.7] label [-27, 20]
evolve Power 0.89 label [-12, 21]
Business->Cup of Tea
Public->Cup of Tea
Cup of Tea->Cup
Cup of Tea->Tea
Cup of Tea->Hot Water
Hot Water->Water
Hot Water->Kettle; limited by 
Kettle->Power

annotation 1 [[0.43,0.49],[0.08,0.79]] Standardising power allows Kettles to evolve faster
annotation 2 [0.48, 0.85] Hot water is obvious and well known
annotations [0.72, 0.03]

note +a generic note appeared [0.23, 0.33]

style wardley`,A=e=>Object.assign({},T,e),T={className:"plain",containerBackground:"white",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"black",mapGridTextColor:"black",pipelineArrowHeight:5,pipelineArrowWidth:5,strokeWidth:1,strokeDasharray:"2,2",anchor:{fontSize:"14px"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},market:{stroke:"red",fill:"white"},component:{fill:"white",stroke:"black",evolved:"red",evolvedFill:"white",strokeWidth:1,pipelineStrokeWidth:1,radius:5,textColor:"black",textOffset:8,evolvedTextColor:"red",fontSize:"14px",fontWeight:"normal"},submap:{fontSize:"13px",fill:"black",stroke:"black",evolved:"red",evolvedFill:"black",strokeWidth:1,pipelineStrokeWidth:1,radius:5,textColor:"black",textOffset:8,evolvedTextColor:"red"},link:{stroke:"grey",strokeWidth:1,evolvedStroke:"red",evolvedStrokeWidth:1,flow:"#99c5ee9e",flowStrokeWidth:10,flowText:"#03a9f4",contextFontSize:"11px"},fluidLink:{stroke:"grey",strokeDasharray:"2,2",strokeWidth:2},annotation:{stroke:"#595959",strokeWidth:2,fill:"white",text:"black",boxStroke:"#595959",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black"},note:{fontWeight:"bold",fontSize:"12px",fill:"black",textColor:"black",evolvedTextColor:"red"}},L=A({className:"handwritten",fontFamily:'"Gloria Hallelujah", cursive',stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"black",component:{fill:"white",stroke:"black",evolved:"red",evolvedFill:"white",strokeWidth:1,pipelineStrokeWidth:1,radius:5,evolvedTextColor:"red",textColor:"black",fontWeight:"normal",fontSize:"12px"},annotation:{stroke:"#595959",strokeWidth:2,boxStroke:"#595959",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black",fill:"",text:""},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},note:{evolvedTextColor:"",textColor:"black",fontWeight:"bold"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}}}),M=A({className:"wardley",fontFamily:"Consolas, Lucida Console, monospace",stroke:"black",pipelineArrowStroke:"black",evolutionSeparationStroke:"#b8b8b8",component:{fill:"white",stroke:"black",evolved:"red",evolvedFill:"white",strokeWidth:1,pipelineStrokeWidth:1,radius:5,evolvedTextColor:"red",textColor:"black",fontWeight:"normal",fontSize:"12px"},annotation:{stroke:"#595959",strokeWidth:2,fill:"white",boxStroke:"#595959",boxStrokeWidth:1,boxFill:"#FFFFFF",boxTextColour:"black",text:""},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},note:{evolvedTextColor:"red",textColor:"black",fontWeight:"bold"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}}}),D=A({className:"dark",containerBackground:"#353347",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",stroke:"white",pipelineArrowStroke:"white",evolutionSeparationStroke:"white",mapGridTextColor:"rgba(255,255,255,.8)",pipelineArrowHeight:5,pipelineArrowWidth:5,strokeWidth:1,strokeDasharray:"2,2",anchor:{fontSize:"14px"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},market:{stroke:"#90caf9",fill:"white"},component:{fontSize:"13px",fill:"rgba(255,255,255,.8)",stroke:"white",evolved:"#90caf9",evolvedFill:"white",strokeWidth:1,pipelineStrokeWidth:1,radius:5,textColor:"rgba(255,255,255,.8)",textOffset:8,evolvedTextColor:"#90caf9",fontWeight:"normal"},submap:{fontSize:"13px",fill:"white",stroke:"white",evolved:"#90caf9",evolvedFill:"white",strokeWidth:1,pipelineStrokeWidth:1,radius:5,textColor:"white",textOffset:8,evolvedTextColor:"#90caf9"},link:{stroke:"white",strokeWidth:1,evolvedStroke:"#90caf9",evolvedStrokeWidth:1,flow:"#99c5ee9e",flowStrokeWidth:10,flowText:"#03a9f4"},fluidLink:{stroke:"white",strokeDasharray:"2,2",strokeWidth:2},annotation:{stroke:"#595959",strokeWidth:2,fill:"rgba(255,255,255,.8)",text:"black",boxStroke:"#595959",boxStrokeWidth:1,boxFill:"rgba(255,255,255,.8)",boxTextColour:"black"},note:{fontWeight:"bold",fontSize:"12px",textColor:"rgba(255,255,255,.8)",evolvedTextColor:"red"}}),N=A({className:"colour",stroke:"#c23667",pipelineArrowStroke:"#8cb358",evolutionSeparationStroke:"#b8b8b8",strokeWidth:3,component:{fill:"white",stroke:"#8cb358",evolved:"#ea7f5b",evolvedFill:"white",strokeWidth:2,pipelineStrokeWidth:1,radius:7,textColor:"#486b1a",textOffset:8,evolvedTextColor:"#ea7f5b",fontWeight:"normal"},submap:{fill:"#8cb358",stroke:"#8cb358",evolved:"#ea7f5b",evolvedFill:"#8cb358",strokeWidth:2,pipelineStrokeWidth:1,radius:7,textColor:"#486b1a",textOffset:8,evolvedTextColor:"#ea7f5b"},link:{stroke:"#5c5c5c",evolvedStroke:"#ea7f5b",flow:"#99c5ee9e"},annotation:{stroke:"#015fa5",strokeWidth:2,fill:"#99c5ee",boxStroke:"#015fa5",boxStrokeWidth:2,boxFill:"#99c5ee",boxTextColour:"black",text:""},methods:{buy:{stroke:"#D6D6D6",fill:"#AAA5A9"},build:{stroke:"#000000",fill:"#D6D6D6"},outsource:{stroke:"#444444",fill:"#444444"}},note:{evolvedTextColor:"red",textColor:"black",fontWeight:"bold"},attitudes:{strokeWidth:"5px",fontSize:"14px",pioneers:{stroke:"#3490dd",fill:"#3ccaf8",fillOpacity:.4,strokeOpacity:.7},settlers:{stroke:"#396dc0",fill:"#599afa",fillOpacity:.4,strokeOpacity:.7},townplanners:{stroke:"#4768c8",fill:"#936ff9",fillOpacity:.4,strokeOpacity:.7}}});var O=i(5560),F=i.n(O);let $=(e,t,i)=>{Object.assign(e,{name:t.split(`${i.keyword} `)[1].trim().split(" [")[0].trim()})},W=(e,t)=>{-1!==t.indexOf("url(")&&Object.assign(e,{url:t.split("url(")[1].split(")")[0].trim()})},_=(e,t)=>{let i="";if(t.trim().indexOf("]")>-1&&t.trim().indexOf("]")!==t.trim().length-1&&(-1===t.replace(/\s/g,"").indexOf("]]")&&(i=t.split("]")[1].trim()),t.replace(/\s/g,"").indexOf("]]")>-1)){let e=t.lastIndexOf("]");i=t.substr(e+1,t.length-1).trim()}Object.assign(e,{text:i})},I=(e,t)=>{let i={visibility:.9,maturity:.1},n=[];t.replace(/\s/g,"").indexOf("[[")>-1?("["+t.replace(/\s/g,"").split("[[")[1].split("]]")[0]+"]").replace(/\],\[/g,"]|[").split("|").forEach(e=>{n.push(H(e,i))}):t.indexOf("[")>-1&&t.indexOf("]")>-1&&n.push(H(t,i)),Object.assign(e,{occurances:n})},P=(e,t)=>{let i=!0,n={maturity1:.2,maturity2:.8},o=t.split("[");if(t.indexOf("[")>-1&&t.indexOf("]")>-1&&o.length>1&&o[1].indexOf("]")>-1){let e=o[1].split("]")[0].split(",");n.maturity1=parseFloat(e[0].trim()),n.maturity2=parseFloat(e[1].trim()),i=!1}Object.assign(e,{hidden:i,maturity2:n.maturity2,maturity1:n.maturity1})},z=(e,t)=>{let i={maturity:.2},n=t.split("[");t.indexOf("[")>-1&&t.indexOf("]")>-1&&n.length>1&&n[1].indexOf("]")>-1&&(i.maturity=parseFloat(n[1].split("]")[0].trim())),Object.assign(e,{maturity:i.maturity})},H=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{visibility:isNaN(parseFloat(i[0]))?t.visibility:parseFloat(i[0]),maturity:isNaN(parseFloat(i[1]))?t.maturity:parseFloat(i[1])}}},Y=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{width:isNaN(parseFloat(i[0]))?t.width:parseFloat(i[0]),height:isNaN(parseFloat(i[1]))?t.height:parseFloat(i[1])}}},R=(e,t)=>{if(!(e.indexOf("[")>-1&&e.indexOf("]")>-1))return t;{let i=e.split("[")[1].trim().split("]")[0].replace(/\s/g,"").split(",");return{visibility:isNaN(parseFloat(i[0]))?t.visibility:parseFloat(i[0]),maturity:isNaN(parseFloat(i[1]))?t.maturity:parseFloat(i[1]),visibility2:isNaN(parseFloat(i[2]))?t.visibility2:parseFloat(i[2]),maturity2:isNaN(parseFloat(i[3]))?t.maturity2:parseFloat(i[3])}}},B=(e,t,i)=>{Object.assign(e,{attitude:i.keyword})},U=(e,t)=>{if(!t.includes("]"))return;let[i,n]=t.split("]")[1].trim().split(" ");Object.assign(e,{width:i,height:n})},X=(e,t)=>{let i=t.split("evolve ")[1].trim(),n="",o=t.match(/\s[0-9]?\.[0-9]+[0-9]?/),s=.85;if(o&&o.length>0){s=parseFloat(o[0]);let e=i.split(String(s))[0].trim();(i=e).indexOf("->")>-1&&(n=e.split("->")[1].trim(),i=e.split("->")[0].trim())}Object.assign(e,{name:i,override:n,maturity:s})},V=(e,t)=>{let i=H(t,{visibility:.9,maturity:.1});Object.assign(e,{maturity:i.maturity,visibility:i.visibility})},G=(e,t)=>{Object.assign(e,{deaccelerator:0===t.indexOf("deaccelerator")})},K=(e,t)=>{let i=R(t,{visibility:.9,maturity:.1,visibility2:.8,maturity2:.2});Object.assign(e,{maturity:i.maturity,visibility:i.visibility,maturity2:i.maturity2,visibility2:i.visibility2})},Z=(e,t)=>{let i={ecosystem:!1,market:!1,buy:!1,build:!1,outsource:!1};return e.decorators?e.decorators={...i,...e.decorators}:e.decorators={...i},[ei,en,eo].forEach(i=>F()(e,i(e,t))),e},q=(e,t)=>{let i={...k};if(e.increaseLabelSpacing&&(i={x:i.x*e.increaseLabelSpacing,y:i.y*e.increaseLabelSpacing}),t.indexOf("label ")>-1){let e=t.split("label [");if(e.length>0&&e[1].indexOf("]")>-1){let t=e[1].split("]")[0].split(",");i.x=parseFloat(t[0].trim()),i.y=parseFloat(t[1].trim())}}Object.assign(e,{label:i})},Q=(e,t)=>{let i=null;t.indexOf("evolve ")>-1&&(i=(i=t.split("evolve ")[1].trim()).replace("inertia","").trim()),Object.assign(e,{evolveMaturity:i,evolving:null!=i})},J=(e,t)=>{Object.assign(e,{inertia:-1!==t.indexOf("inertia")||-1!==t.indexOf("(inertia)")})},ee=(e,t,i)=>{let n=t.indexOf(i.keyword);Object.assign(e,{text:t.substr(`${i.keyword} `.length+n,t.length-`${i.keyword} `.length+n).trim().split(" [")[0].trim()})},et=(e,t,i)=>{Object.assign(e,{number:parseInt(t.split(`${i.keyword} `)[1].trim().split(" [")[0].trim())})},ei=(e,t)=>{let i=["build","buy","outsource"],n={},o={};for(let e=0;e<i.length;e++){let s=i[e];if(t.indexOf(s)>-1&&t.indexOf("(")<t.indexOf(s)&&t.indexOf(")")>t.indexOf(s)){n[s]=!0,o={increaseLabelSpacing:2};break}}return{decorators:n,...o}},en=(e,t)=>{let i={},n={};return(t.indexOf("market")>-1&&t.indexOf("(")<t.indexOf("market")&&t.indexOf(")")>t.indexOf("market")||0===t.indexOf("market"))&&(i.market=!0,n={increaseLabelSpacing:2}),{decorators:i,...n}},eo=(e,t)=>{let i={},n={};return(t.indexOf("ecosystem")>-1&&t.indexOf("(")<t.indexOf("ecosystem")&&t.indexOf(")")>t.indexOf("ecosystem")||0===t.indexOf("ecosystem"))&&(i.ecosystem=!0,n={increaseLabelSpacing:3}),{decorators:i,...n}},es=(e,t)=>{Object.assign(e,{url:t.split("[")[1].trim().split("]")[0].trim()})};class ea{constructor(e,t,i){this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.config=t,this.decorators=i}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(0===i.trim().indexOf(`${this.keyword} `)){let e=Object.assign({id:1+n,line:1+n},this.config.defaultAttributes);this.decorators.forEach(t=>t(e,i,{keyword:this.keyword,containerName:this.containerName,config:this.config})),t.push(e)}}catch(e){console.log(e),i.push({line:n,name:e})}return{[this.containerName]:t,errors:i}}}class el{constructor(e){this.data=e,this.containerName="accelerators",this.baseStrategies=["accelerator","deaccelerator"].map(t=>new ea(e,{keyword:t,containerName:"accelerators",defaultAttributes:{increaseLabelSpacing:0}},[$,V,G])).flat()}apply(){let e=this.baseStrategies.map(e=>e.apply()).flat();return{[this.containerName]:e.map(e=>e.accelerators).flat(),errors:[]}}}class er{constructor(e){let t={keyword:"anchor",containerName:"anchors",defaultAttributes:{increaseLabelSpacing:0}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.baseRunner=new ea(e,t,[$,V])}apply(){return this.baseRunner.apply()}}class em{constructor(e){let t={keyword:"annotation",containerName:"annotations",defaultAttributes:{increaseLabelSpacing:0}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName,this.baseRunner=new ea(e,t,[et,I,_])}apply(){let e=this.baseRunner.apply()[this.containerName].filter(e=>e.occurances.length>0);return{[this.containerName]:e,errors:[]}}}class ep{constructor(e){this.data=e,this.containerName="attitudes",this.baseStrategies=["pioneers","settlers","townplanners"].map(t=>new ea(e,{keyword:t,containerName:"attitudes",defaultAttributes:{increaseLabelSpacing:0}},[B,V,K,U])).flat()}apply(){let e=this.baseStrategies.map(e=>e.apply()).flat();return{[this.containerName]:e.map(e=>e.attitudes).flat(),errors:[]}}}class ed{constructor(e,t,i){this.data=e,this.keyword=t.keyword,this.containerName=t.containerName;let n=[Z,V,$,J,q,Q];null!=i&&(n=i.concat(n)),this.baseRunner=new ea(e,t,n)}apply(){return this.baseRunner.apply()}}class ec{constructor(e){let t={keyword:"component",containerName:"elements",defaultAttributes:{increaseLabelSpacing:0}},i=[],n=e.split("\n"),o=!1;for(let e=0;e<n.length;e++){let t=n[e];0===t.trim().indexOf("{")&&(o=!0,i.push(" ")),o&&0===t.trim().indexOf("}")&&(o=!1,i.push(" ")),o&&!1===t.trim().includes("}")&&!1===t.trim().includes("{")&&i.push(" "),o||-1!==t.trim().indexOf("}")||i.push(t)}let s=i.join("\n");this.data=s,this.keyword=t.keyword,this.containerName=t.containerName,this.parentStrategy=new ed(s,t,[])}apply(){return this.parentStrategy.apply()}}class eh{constructor(e){let t={keyword:"evolve",containerName:"evolved",defaultAttributes:{increaseLabelSpacing:0}};this.data=e,this.keyword=t.keyword,this.containerName=t.containerName;let i=[Z,q,X];this.baseRunner=new ea(e,t,i)}apply(){return this.baseRunner.apply()}}class eu extends Error{constructor(e){super(`ParseError on line ${e}`),this.name="ParseError",this.line=e}}class ex{constructor(e){this.data=e,this.notLinks=["evolution","anchor","evolve","component","style","build","buy","outsource","title","annotation","annotations","pipeline","note","pioneers","settlers","townplanners","submap","url","{","}","accelerator","deaccelerator","size"]}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(this.canProcessLine(i)){let e,o,s="",a="",l=!0,r=!1,m=!1;if(i.includes("+>"))[s,a]=i.split("+>");else if(i.includes("+<>"))[s,a]=i.split("+<>"),m=!0;else if(i.includes("+<"))[s,a]=i.split("+<"),r=!0;else if(i.includes("+'")){let n=i.split("+'");s=n[0].trim(),n[1].includes("'>")?([e,a]=n[1].split("'>"),r=!0):n[1].includes("'<>")?([e,a]=n[1].split("'<>"),m=!0,r=!0):n[1].includes("'<")&&([e,a]=n[1].split("'<"),m=!0),t.push({start:s,end:a.trim().split(";")[0].trim(),flow:l,flowValue:e,future:r,past:m})}else i.includes("->")&&([s,a]=i.split("->"),l=!1);if(i.includes(";")&&(o=i.split(";")[1].trim()),0===s.trim().length&&0===a.trim().length)throw new eu(n);t.push({start:s.trim(),end:a.trim().split(";")[0].trim(),flow:l,future:r,past:m,context:o})}}catch{i.push(new eu(n))}return{links:t,errors:i}}canProcessLine(e){if(0===e.trim().length)return!1;let t=!0;for(let i=0;i<this.notLinks.length;i++){let n=this.notLinks[i];(0===e.trim().indexOf(n)||-1!==e.trim().indexOf("("+n+")"))&&(t=!1)}return t}}class ey{constructor(e){this.data=e,this.keyword="note",this.containerName="notes",this.baseRunner=new ea(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{increaseLabelSpacing:0}},[ee,V])}apply(){return this.baseRunner.apply()}}class ev{constructor(e,t,i,n){this.data=e,this.keyword=t.keyword,this.childKeyword="component",this.containerName=t.containerName,this.config=t,this.decorators=null!=i?i:[],this.childDecorators=n}apply(){let e=this.data.split("\n"),t=[],i=[];for(let n=0;n<e.length;n++)try{let i=e[n];if(0===i.trim().indexOf(`${this.keyword} `)){let o=Object.assign({id:1+n,line:1+n,components:[],hidden:!1},this.config.defaultAttributes);if(this.decorators.forEach(e=>e(o,i,{keyword:this.keyword,containerName:this.containerName,config:this.config})),((e,t,i,n)=>{let o=[],s=!1;for(let i=1+t;i<e.length;i++){let a=e[i].trim();if(a.indexOf("{")>-1&&!s&&(s=!0),0===a.indexOf(`${this.keyword} `)&&!s||s&&a.indexOf("}")>-1)break;if(s&&0===a.indexOf(`${this.childKeyword} `)){let e=Object.assign({id:1+t+"-"+i,line:1+i},this.config.defaultAttributes);n.forEach(t=>{t(e,a,{keyword:this.childKeyword})}),o.push(e)}}i.components=o})(e,n,o,this.childDecorators),o.components.length>0){let e=1,t=0;for(let i=0;i<o.components.length;i++){let n=o.components[i];n.maturity<e&&(e=n.maturity),n.maturity>t&&(t=n.maturity)}o.maturity1=e,o.maturity2=t,o.hidden=!1}t.push(o)}}catch{i.push(new eu(n))}return{[this.containerName]:t,errors:i}}}class eg{constructor(e,t){this.data=e,this.keyword="pipeline",this.containerName="pipelines",t.enableNewPipelines?this.baseRunner=new ev(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{increaseLabelSpacing:0}},[$,P],[$,z,q]):this.baseRunner=new ea(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{increaseLabelSpacing:0}},[$,P])}apply(){return this.baseRunner.apply()}}class ef{constructor(e){this.data=e}apply(){let e={style:"plain",annotations:{visibility:.9,maturity:.1},size:{width:0,height:0}},t=this.data.split("\n");for(let i=0;i<t.length;i++){let n=t[i];0===n.trim().indexOf("style")&&(e.style=n.split("style ")[1].trim()),0===n.trim().indexOf("annotations ")&&(e.annotations=H(n,{visibility:.9,maturity:.1})),0===n.trim().indexOf("size ")&&(e.size=Y(n,{width:0,height:0}))}return{presentation:e,errors:[]}}}class eb{constructor(e){this.data=e,this.parentStrategy=new ed(e,{keyword:"submap",containerName:"submaps",defaultAttributes:{increaseLabelSpacing:0}},[W])}apply(){return this.parentStrategy.apply()}}class ek{constructor(e){this.data=e}apply(){if(this.data.trim().length<1)return{title:"Untitled Map",errors:[]};let e=this.data;for(let t=0;t<e.split("\n").length;t++){let i=e.split("\n")[t];if(0===i.indexOf("title"))return{title:i.split("title ")[1].trim(),errors:[]}}return{title:"Untitled Map",errors:[]}}}class ew{constructor(e){this.data=e,this.keyword="url",this.containerName="urls",this.baseRunner=new ea(e,{keyword:this.keyword,containerName:this.containerName,defaultAttributes:{increaseLabelSpacing:0}},[$,es])}apply(){return this.baseRunner.apply()}}class ej{constructor(e){this.data=e}apply(){let e=this.data.split("\n"),t=[];for(let i=0;i<e.length;i++){let n=e[i];try{if(0===n.trim().indexOf("evolution")){let e=n.split("evolution ")[1].trim().split("->");return{evolution:[{line1:e[0],line2:""},{line1:e[1],line2:""},{line1:e[2],line2:""},{line1:e[3],line2:""}]}}}catch{t.push(new eu(i))}}return{evolution:[{line1:"Genesis",line2:""},{line1:"Custom-Built",line2:""},{line1:"Product",line2:"(+rental)"},{line1:"Commodity",line2:"(+utility)"}],errors:t}}}class eE{constructor(e){this.featureSwitches=e}parse(e){let t=this.stripComments(e),i=[new ek(t),new ej(t),new ef(t),new ey(t),new em(t),new ec(t),new eg(t,this.featureSwitches),new eh(t),new er(t),new ex(t),new eb(t),new ew(t),new ep(t),new el(t)],n={errors:[]},o={links:[],anchors:[],evolved:[],pipelines:[],elements:[],annotations:[],notes:[],presentation:{style:"",annotations:{visibility:0,maturity:0},size:{width:0,height:0}},evolution:[],submaps:[],urls:[],attitudes:[],accelerators:[],title:"",errors:[]};return i.forEach(e=>{let t=e.apply();o=Object.assign(o,t),t.errors&&t.errors.length>0&&(n.errors=n.errors.concat(t.errors))}),Object.assign(o,n)}stripComments(e){let t=e.split("\n").map(e=>0===e.trim().indexOf("url")?e:e.split("//")[0]),i=[],n=!1;for(let e=0;e<t.length;e++){let o=t[e];o.indexOf("/*")>-1?(n=!0,i.push(o.split("/*")[0].trim())):n?o.indexOf("*/")>-1&&(n=!1,i.push(o.split("*/")[1].trim())):!1===n&&i.push(o)}return i.join("\n")}}let eC=()=>({title:"",presentation:{},errors:[],components:[],anchors:[],submaps:[],markets:[],ecosystems:[],evolved:[],pipelines:[],evolution:[],links:[],annotations:[],notes:[],methods:[],urls:[],attitudes:[],accelerators:[]}),eS=e=>({components:e.components.filter(e=>"component"===e.type),anchors:e.anchors,submaps:e.submaps,markets:e.markets,ecosystems:e.ecosystems}),eA=e=>{let t={ecosystem:!1,market:!1,buy:!1,build:!1,outsource:!1,...e.decorators||{}};return{maturity:0,visibility:0,label:{x:0,y:0},evolving:!1,evolved:!1,inertia:!1,pseudoComponent:!1,offsetY:0,increaseLabelSpacing:0,pipeline:!1,...e,decorators:t}};class eT{constructor(e){this.legacyConverter=new eE(e)}parse(e){let t=this.legacyConverter.parse(e);return this.transformToUnifiedMap(t)}transformToUnifiedMap(e){let t=eC();return this.copyBasicProperties(e,t),this.transformAllComponentTypes(e,t),t.evolved=this.transformEvolvedElements(e.evolved||[]),t.pipelines=this.transformPipelines(e.pipelines||[],this.getAllComponents(t)),t.links=this.transformLinks(e.links||[]),this.copyAdditionalProperties(e,t),t}copyBasicProperties(e,t){t.title=e.title||"",t.presentation=e.presentation,t.errors=e.errors||[],t.evolution=e.evolution||[]}copyAdditionalProperties(e,t){t.annotations=e.annotations||[],t.notes=e.notes||[],t.urls=e.urls||[],t.attitudes=e.attitudes||[],t.accelerators=e.accelerators||[]}transformAllComponentTypes(e,t){t.components=this.transformComponents(e.elements||[],"component"),t.anchors=this.transformComponents(e.anchors||[],"anchor"),t.submaps=this.transformComponents(e.submaps||[],"submap")}transformComponents(e,t){return e.map(e=>eA({id:e.id||this.generateId(e.name,t),name:e.name||"",type:t,maturity:e.maturity||0,visibility:e.visibility||0,line:e.line,label:e.label,evolving:e.evolving||!1,evolved:e.evolved||!1,evolveMaturity:e.evolveMaturity,inertia:e.inertia||!1,pseudoComponent:e.pseudoComponent||!1,offsetY:e.offsetY||0,decorators:e.decorators,override:e.override,url:e.url,pipeline:e.pipeline||!1,increaseLabelSpacing:e.increaseLabelSpacing}))}transformEvolvedElements(e){return e.map(e=>({name:e.name||"",maturity:e.maturity||0,label:e.label,override:e.override,line:e.line,decorators:e.decorators,increaseLabelSpacing:e.increaseLabelSpacing}))}transformPipelines(e,t){return e.map(e=>{let i={id:e.id||this.generateId(e.name,"pipeline"),name:e.name||"",visibility:e.visibility||0,line:e.line,components:this.transformPipelineComponents(e.components||[]),inertia:e.inertia||!1,hidden:e.hidden||!1,maturity1:e.maturity1,maturity2:e.maturity2};return this.processPipelineVisibility(i,t),i})}transformPipelineComponents(e){return e.map(e=>({id:e.id||this.generateId(e.name,"pipelinecomponent"),name:e.name||"",maturity:e.maturity||0,visibility:e.visibility||0,line:e.line,label:e.label||{x:0,y:0}}))}processPipelineVisibility(e,t){if(!t)return;let i=t.find(t=>t.name===e.name);i?e.visibility=i.visibility:e.hidden=!0}transformLinks(e){return e.map(e=>({start:e.start||"",end:e.end||"",line:e.line,flow:!1!==e.flow,flowValue:e.flowValue,future:e.future||!1,past:e.past||!1,context:e.context}))}generateId(e,t){return`${t}_${e.replace(/\s+/g,"_").toLowerCase()}`}getAllComponents(e){return[...e.components,...e.anchors,...e.submaps,...e.markets,...e.ecosystems]}stripComments(e){return this.legacyConverter.stripComments(e)}}var eL=i(3092);let eM=e=>{let t=new Set;if(e.methods&&e.methods.length>0&&e.methods.forEach(e=>{e.name&&t.add(e.name)}),(e.evolved?.length===0||!e.evolved)&&0===t.size)return e;let i=e.evolved?new Map(e.evolved.map(e=>[e.name,e])):new Map,n=e=>e.map(e=>{let n=i.has(e.name),o=t.has(e.name);if(n||o){let t=Math.max(e.increaseLabelSpacing||0,2),o=e.label||{x:0,y:0};(!o.y||10>=Math.abs(o.y))&&(o={...o,y:10*t});let s=n?i.get(e.name):null;if(!o.x||10>=Math.abs(o.x)){let e=5;s&&s.override&&(e=16),o={...o,x:e}}return{...e,increaseLabelSpacing:t,label:o}}return e}),o=e.evolved.map(e=>{let t=Math.max(e.increaseLabelSpacing||0,2),i=e.label||{x:0,y:0};if((!i.y||10>=Math.abs(i.y))&&(i={...i,y:10*t}),!i.x||10>=Math.abs(i.x)){let t=e.override?16:5;i={...i,x:t}}return{...e,increaseLabelSpacing:t,label:i}});return{...e,components:n(e.components),anchors:n(e.anchors),submaps:n(e.submaps),markets:n(e.markets),ecosystems:n(e.ecosystems),evolved:o}},eD=()=>({mapText:"",map:eC(),highlightedLine:-1,newComponentContext:null,showLinkedEvolved:!1,mapDimensions:{width:500,height:400},mapCanvasDimensions:{width:500,height:400},mapStyleDefs:{},evolutionOffsets:{commodity:0,product:0,custom:0},mapEvolutionStates:E,isLoading:!1,errors:[],showUsage:!1,actionInProgress:!1}),eN=e=>{let[t,i]=(0,l.useState)(()=>({...eD(),...e})),n=(0,l.useMemo)(()=>({setMapText:e=>i(t=>({...t,mapText:e})),setMap:e=>{let t=eM(e);i(e=>({...e,map:t}))},setHighlightedLine:e=>i(t=>({...t,highlightedLine:e})),setNewComponentContext:e=>i(t=>({...t,newComponentContext:e})),setShowLinkedEvolved:e=>i(t=>({...t,showLinkedEvolved:e})),setMapDimensions:e=>i(t=>({...t,mapDimensions:e})),setMapCanvasDimensions:e=>i(t=>({...t,mapCanvasDimensions:e})),setMapStyleDefs:e=>i(t=>({...t,mapStyleDefs:e})),setEvolutionOffsets:e=>i(t=>({...t,evolutionOffsets:e})),setMapEvolutionStates:e=>i(t=>({...t,mapEvolutionStates:e})),setIsLoading:e=>i(t=>({...t,isLoading:e})),setErrors:e=>i(t=>({...t,errors:e})),addError:e=>i(t=>({...t,errors:[...t.errors,e]})),clearErrors:()=>i(e=>({...e,errors:[]})),setShowUsage:e=>i(t=>({...t,showUsage:e})),setActionInProgress:e=>i(t=>({...t,actionInProgress:e}))}),[]),o=(0,l.useMemo)(()=>eS(t.map),[t.map]),s=(0,l.useMemo)(()=>({map:t.map,groupedComponents:o,highlightedLine:t.highlightedLine,newComponentContext:t.newComponentContext,showLinkedEvolved:t.showLinkedEvolved}),[t.map,o,t.highlightedLine,t.newComponentContext,t.showLinkedEvolved]),a=(0,l.useCallback)(()=>[...t.map.components,...t.map.anchors,...t.map.submaps,...t.map.markets,...t.map.ecosystems],[t.map]),r=(0,l.useCallback)(e=>a().filter(t=>t.type===e),[a]),m=(0,l.useCallback)(e=>a().find(t=>t.name===e),[a]),p=(0,l.useCallback)(()=>{i(eD())},[]),d=(0,l.useCallback)(()=>t.map,[t.map]);return{state:t,actions:n,renderState:s,groupedComponents:o,getAllComponents:a,getComponentsByType:r,findComponentByName:m,getUnifiedMap:d,resetToDefaults:p}},eO=e=>({...e,line:e.line??0,evolved:e.evolved??!1,evolving:e.evolving??!1,inertia:e.inertia??!1,pseudoComponent:e.pseudoComponent??!1,offsetY:e.offsetY??0,increaseLabelSpacing:e.increaseLabelSpacing??0,decorators:e.decorators??{}}),eF=e=>e.map(e=>({...e,flow:e.flow??!1,future:e.future??!1,past:e.past??!1,context:e.context??"",flowValue:e.flowValue??""})),e$=e=>t=>{if("function"==typeof t)return void console.warn("Functional state updates not fully supported in legacy adapter");e(t)},eW=e=>{let{state:t,actions:i,groupedComponents:n}=e,o=n.components.map(eO),s=n.anchors.map(eO),a=n.submaps.map(eO),l=n.markets.map(eO),r=n.ecosystems.map(eO),m=eF(t.map.links);return{mapText:t.mapText,mapTitle:t.map.title,mapComponents:o,mapAnchors:s,mapSubMaps:a,mapMarkets:l,mapEcosystems:r,mapEvolved:t.map.evolved,mapPipelines:t.map.pipelines,mapLinks:m,mapAnnotations:t.map.annotations,mapNotes:t.map.notes,mapMethods:t.map.methods,mapUrls:t.map.urls,mapAttitudes:t.map.attitudes,mapAccelerators:t.map.accelerators,highlightedLine:t.highlightedLine,newComponentContext:t.newComponentContext,showLinkedEvolved:t.showLinkedEvolved,mapDimensions:t.mapDimensions,mapCanvasDimensions:t.mapCanvasDimensions,mapStyleDefs:t.mapStyleDefs,evolutionOffsets:t.evolutionOffsets,mapEvolutionStates:t.mapEvolutionStates,mutateMapText:e$(i.setMapText),setHighlightLine:e$(i.setHighlightedLine),setNewComponentContext:e$(i.setNewComponentContext),setShowLinkedEvolved:e$(i.setShowLinkedEvolved)}};class e_{constructor(e){this.callback=e}}class eI extends e_{async load(e){let t=`${b}fetch?id=${e}`,i=await fetch(t),n=await i.json(),o={id:n.id,mapText:n.text,mapIterations:n.mapIterations?JSON.parse(n.mapIterations):[]};this.callback(w.Legacy,o)}}let eP=async(e,t,i)=>{let n={[w.Legacy]:()=>new eI(t)};await n[e]().load(i)};class ez{constructor(e){this.callback=e}async save(e,t){let i=await fetch(b+"save",{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:t?t.includes("clone:")?t.split("clone:")[1]:t:"",text:e.mapText,mapIterations:JSON.stringify(e.mapIterations)})}),n=await i.json();this.callback(n.id,n)}}class eH{constructor(e){this.callback=e}async save(e,t){console.log("NullSaveStrategy executed",{map:e,hash:t})}}let eY=async(e,t,i,n)=>{let o=new eH(n);e===w.Legacy&&(o=new ez(n)),await o.save(t,i)};var eR=i(5206),eB=i(7148),eU=i(7876);let eX=(0,l.memo)(({id:e,cx:t,cy:i,component:n,onClick:o,styles:s})=>{let a=n?.evolved||!1,l=a?s.evolvedFill:s.fill,r=a?s.evolved:s.stroke;return(0,eU.jsx)("circle",{id:e,cx:t,cy:i,strokeWidth:s.strokeWidth,r:s.radius,stroke:r,fill:l,onClick:o})}),eV=(0,l.memo)(({id:e,x:t,y:i,text:n,evolved:o,className:s="label",note:a,textAnchor:l,textTheme:r,onClick:m,setShowTextField:p=null})=>{let d=o?r.evolvedTextColor:r.textColor,c=n&&n.length>14,h=c?n.trim().split(" ").map((t,i)=>(0,eU.jsx)("tspan",{x:0,dy:15*(i>0),textAnchor:"middle",children:t.trim()},"component_text_span_"+e+"_"+i)):n;return(0,eU.jsx)(eU.Fragment,{children:(0,eU.jsx)("text",{id:e,"data-testid":e,fontWeight:r.fontWeight,fontSize:r.fontSize||"14px",className:s,textAnchor:l,x:t,y:i,transform:c?"translate(30, 10)":"",fill:r.textColor||d,onClick:m||(()=>{}),onDoubleClick:e=>{e.stopPropagation(),p&&p(!0)},children:a||h})})}),eG=(0,l.memo)(({id:e,cx:t,cy:i,onClick:n,styles:o,component:s})=>{let a=s?.evolved||!1,l=a?o.evolvedFill:"#d7d7d7",r=a?o.evolved:o.stroke;return(0,eU.jsxs)("g",{id:e,onClick:n,children:[(0,eU.jsx)("circle",{cx:t,cy:i,r:"30",fill:l,strokeWidth:"1",stroke:r}),(0,eU.jsx)("circle",{cx:t,cy:i,r:"25",fill:"white",strokeWidth:"1",stroke:"#9e9b9e"}),(0,eU.jsx)("circle",{cx:t,cy:i,r:"25",fill:"url(#diagonalHatch)"}),(0,eU.jsx)("circle",{cx:t,cy:i,r:"10",fill:"white",strokeWidth:"1",stroke:"#6e6e6e"})]})}),eK=(0,l.memo)(({id:e,x:t,y:i,stroke:n="black",strokeWidth:o=6,className:s=""})=>(0,eU.jsx)("line",{id:e,className:`inertia-symbol ${s}`,x1:t,y1:i-10,x2:t,y2:i+10,stroke:n,strokeWidth:o})),eZ=(e,t)=>[Math.round(e*Math.cos(t*Math.PI/180)),Math.round(e*Math.sin(t*Math.PI/180))],eq=()=>{let e=[];for(let t=0;t<3;t++)e.push(eZ(10,30+120*t));return e},eQ=(e,t)=>e.map((e,i)=>(0,eU.jsx)("circle",{cx:e[0],cy:e[1],r:"5",fill:t.fill,strokeWidth:"3",stroke:t.stroke},i)),eJ=(0,l.memo)(({id:e,styles:t,onClick:i,component:n})=>{let o=eq(),s=n?.evolved?t.evolvedFill:t.fill,a=n?.evolved?t.evolved:t.stroke;return(0,eU.jsxs)("g",{id:e,onClick:i,children:[(0,eU.jsx)("circle",{r:18,fill:s,strokeWidth:"1",stroke:a}),(0,eU.jsx)("path",{strokeWidth:"2",stroke:"black",fill:"none",opacity:".8",d:`M${o[0]} L${o[1]} L${o[2]} Z`}),eQ(o,t)]})}),e0=(0,l.memo)(({id:e,x:t,y:i,buy:n,build:o,outsource:s,styles:a,onClick:l})=>{let r="build";n?r="buy":s?r="outsource":o&&(r="build");let m=a[r]||a.build;return console.log(`Rendering MethodSymbol: ${r}`,m,{build:o,buy:n,outsource:s}),(0,eU.jsx)("g",{id:e,transform:`translate(${t},${i})`,onClick:l,style:{cursor:l?"pointer":"default"},children:(0,eU.jsx)("circle",{cx:"0",cy:"0",r:"15",fill:m.fill,stroke:m.stroke})})}),e1="120px",e2="50px",e5="40px",e9=(0,l.memo)(({title:e="",style:t={},mapStyleDefs:i,width:n="100%",className:o="",height:s="100%",viewBox:a,children:l,onClick:r})=>(0,eU.jsxs)("svg",{fontFamily:i?.fontFamily,fontSize:i?.fontSize,className:o||i?.className,width:n,height:s,style:t,onClick:r,viewBox:a,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,eU.jsx)("title",{children:e}),l]})),e3=({id:e,mapStyleDefs:t,onClick:i,hideLabel:n=!1,text:o,evolved:s})=>(0,eU.jsxs)(e9,{width:n?e2:e1,height:e5,mapStyleDefs:t,onClick:i||(()=>{}),children:[!1===n&&(0,eU.jsx)(eV,{id:e,textTheme:t.component,text:o||"Component",x:"8",y:"15",evolved:s}),(0,eU.jsx)(eX,{cx:"8px",cy:"25px",evolved:s,styles:t.component})]}),e4=({id:e,hideLabel:t,mapStyleDefs:i,onClick:n})=>(0,eU.jsx)(e9,{width:t?e2:e1,height:e5,mapStyleDefs:i,onClick:n,children:(0,eU.jsx)(eV,{id:e,note:"note",textTheme:i.note,x:"1",y:"20"})}),e8=({mapStyleDefs:e,id:t})=>(0,eU.jsx)(e3,{id:t,mapStyleDefs:e,evolved:!0,text:"Evolution"}),e6=({hideLabel:e,mapStyleDefs:t,id:i,onClick:n})=>(0,eU.jsxs)(e9,{width:e?e2:e1,height:e5,mapStyleDefs:t,onClick:n,children:[!1===e&&(0,eU.jsx)(eV,{id:i,textTheme:t.component,text:"Inertia",x:"8",y:"15"}),(0,eU.jsx)(eX,{styles:t.component,cx:"8px",cy:"25px"}),(0,eU.jsx)(eK,{x:50,y:25})]}),e7=({id:e,hideLabel:t,mapStyleDefs:i,onClick:n})=>(0,eU.jsxs)(e9,{width:t?e2:e1,height:e5,mapStyleDefs:i,onClick:n,children:[!1===t&&(0,eU.jsx)(eV,{id:e,textTheme:i.component,text:"Market",x:"45",y:"15"}),(0,eU.jsx)("g",{transform:"translate(20 20) scale(0.8)",children:(0,eU.jsx)(eJ,{styles:{...i.component,fill:i.component.fill??"none",stroke:i.component.stroke??"none"},onClick:()=>{}})})]}),te=({hideLabel:e,id:t,onClick:i,mapStyleDefs:n,buy:o,build:s,outsource:a})=>{let l="Build";return o?l="Buy":a?l="Outsource":s&&(l="Build"),(0,eU.jsxs)(e9,{width:e?e2:e1,height:e5,mapStyleDefs:n,onClick:i,children:[!1===e&&(0,eU.jsx)(eV,{id:t,textTheme:n.component,text:l,x:"45",y:"15"}),(0,eU.jsx)("g",{transform:"translate(21 21) scale(0.8)",children:(0,eU.jsx)(e0,{buy:o,build:s,outsource:a,styles:n.methods,x:"0",y:"0"})}),(0,eU.jsx)(eX,{styles:n.component,cx:"21px",cy:"21px"})]})},tt=({onClick:e,hideLabel:t,id:i,mapStyleDefs:n})=>(0,eU.jsx)(te,{id:i,buy:!0,build:!1,outsource:!1,onClick:e,mapStyleDefs:n,hideLabel:t}),ti=({id:e,onClick:t,mapStyleDefs:i,hideLabel:n})=>(0,eU.jsx)(te,{id:e,buy:!1,build:!0,outsource:!1,onClick:t,mapStyleDefs:i,hideLabel:n}),tn=({id:e,onClick:t,hideLabel:i,mapStyleDefs:n})=>(0,eU.jsx)(te,{id:e,buy:!1,build:!1,outsource:!0,onClick:t,mapStyleDefs:n,hideLabel:i}),to=({hideLabel:e,mapStyleDefs:t,onClick:i,id:n})=>(0,eU.jsxs)(e9,{width:e?e2:e1,height:e5,mapStyleDefs:t,onClick:i,children:[!1===e&&(0,eU.jsx)(eV,{id:n,textTheme:t.component,text:"Ecosystem",x:"45",y:"15"}),(0,eU.jsx)("g",{transform:"translate(21 21) scale(0.5)",children:(0,eU.jsx)(eG,{styles:t.component})})]});var ts=i(4578),ta=i(4031),tl=i(8918),tr=i(4256),tm=i(2305),tp=i(8514),td=i(3318);let tc=(0,l.memo)(({newComponentContext:e,mutateMapText:t,setNewComponentContext:i,mapText:n,mapStyleDefs:o})=>{let{t:s}=(0,eL.s)(),a=[{Icon:e3,template:(e,t,i)=>`component ${e} [${t}, ${i}]`},{Icon:e6,template:(e,t,i)=>`component ${e} [${t}, ${i}] inertia`},{Icon:e7,template:(e,t,i)=>`component ${e} [${t}, ${i}] (market)`},{Icon:to,template:(e,t,i)=>`component ${e} [${t}, ${i}] (ecosystem)`},{Icon:tt,template:(e,t,i)=>`component ${e} [${t}, ${i}] (buy)`},{Icon:ti,template:(e,t,i)=>`component ${e} [${t}, ${i}] (build)`},{Icon:tn,template:(e,t,i)=>`component ${e} [${t}, ${i}] (outsource)`},{Icon:e4,template:(e,t,i)=>`note ${e} [${t}, ${i}]`}],[r,m]=(0,l.useState)(!1),[h,y]=(0,l.useState)(0),[v,g]=l.useState(""),f=(0,l.useCallback)(()=>{m(!1),i(null)},[m,i]);function b(){if(0===v.trim().length||!e)return;m(!1);let i=a[h].template(v.trim(),e.y,e.x);t(n+`\r
${i}`),g("")}return(0,l.useEffect)(()=>{let t=e=>{"Escape"===e.key&&(document.removeEventListener("keyup",t),f())};return e&&(m(!0),document.addEventListener("keyup",t)),function(){document.removeEventListener("keyup",t)}},[e,f]),(0,eU.jsx)(eU.Fragment,{children:(0,eU.jsx)(tp.A,{theme:td._,children:(0,eU.jsxs)(p.A,{open:r,onClose:f,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[(0,eU.jsx)(d.A,{id:"alert-dialog-title",children:s("components.quickAdd","Quick Add")}),(0,eU.jsxs)(c.A,{children:[(0,eU.jsxs)(ta.A,{sx:{m:1,minWidth:80,".MuiInputBase-root:before":{border:"0"}},children:[(0,eU.jsx)(tl.A,{id:"type-autowidth-label",children:s("components.type","Type")}),(0,eU.jsx)(tm.A,{labelId:"type-autowidth-label",id:"demo-simple-select-autowidth",value:h,onChange:e=>{y(parseInt(e.target.value.toString()))},label:s("components.type","Type"),variant:"standard",children:a.map((e,t)=>{let{Icon:i}=e;return(0,eU.jsx)(tr.A,{value:t,children:(0,eU.jsx)(i,{mapStyleDefs:o,hideLabel:!1,id:"",evolved:!1,text:"",onClick:()=>{}})},t)})})]}),(0,eU.jsx)(ta.A,{sx:{m:1,minWidth:80},children:(0,eU.jsx)(ts.A,{id:"outlined-multiline-flexible",label:s("components.text","Text"),value:v,onChange:e=>{g(e.target.value)},autoFocus:!0,variant:"standard",sx:{"& .MuiInput-input":{height:"40px"}},onKeyPress:e=>{"Enter"===e.key&&b()}})})]}),(0,eU.jsxs)(u.A,{children:[(0,eU.jsx)(x.A,{onClick:f,children:s("common.cancel","Cancel")}),(0,eU.jsx)(x.A,{onClick:b,children:s("common.add","Add")})]})]})})})}),th=({leftPanel:e,rightPanel:t,defaultLeftWidth:i=33,minLeftWidth:n=15,maxLeftWidth:o=70,resizerWidth:s=8,onResize:a,storageKey:r="resizableSplitPane_leftWidth",isDarkTheme:p=!1})=>{let d=()=>{if(r){let e=localStorage.getItem(r);if(e){let t=parseFloat(e);if(t>=n&&t<=o)return t}}return i},[c,h]=(0,l.useState)(i),[u,x]=(0,l.useState)(!1),y=(0,l.useRef)(null),v=(0,l.useRef)(0),g=(0,l.useRef)(0),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{let e=d();console.log("ResizableSplitPane: localStorage check",{initialWidth:e,defaultLeftWidth:i,willRestore:e!==i}),e!==i&&(h(e),a?.(e),setTimeout(()=>{console.log("ResizableSplitPane: Dispatching panelResize event");let t=document.getElementById("map");if(t){let i=new CustomEvent("panelResize",{detail:{leftWidthPercent:e,rightWidthPercent:100-e,mapContainerWidth:t.clientWidth,mapContainerHeight:t.clientHeight}});window.dispatchEvent(i),console.log("ResizableSplitPane: panelResize event dispatched")}else console.log("ResizableSplitPane: map container not found")},1e3))},[]);let b=(0,l.useCallback)(e=>{h(e),a?.(e),f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{let t=document.getElementById("map");if(t){let i=new CustomEvent("panelResize",{detail:{leftWidthPercent:e,rightWidthPercent:100-e,mapContainerWidth:t.clientWidth,mapContainerHeight:t.clientHeight}});window.dispatchEvent(i)}},150)},[a]),k=(0,l.useCallback)(e=>{e.preventDefault(),x(!0),v.current=e.clientX,g.current=c},[c]),w=(0,l.useCallback)(e=>{if(!u||!y.current)return;let t=y.current.getBoundingClientRect(),i=(e.clientX-v.current)/t.width*100;b(Math.max(n,Math.min(o,g.current+i)))},[u,n,o,b]),j=(0,l.useCallback)(()=>{x(!1),r&&localStorage.setItem(r,c.toString())},[c,r]);return(0,l.useEffect)(()=>{if(u)return document.addEventListener("mousemove",w),document.addEventListener("mouseup",j),document.body.style.cursor="col-resize",document.body.style.userSelect="none",()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mouseup",j),document.body.style.cursor="",document.body.style.userSelect=""}},[u,w,j]),(0,l.useEffect)(()=>()=>{f.current&&clearTimeout(f.current)},[]),(0,eU.jsxs)(m.A,{ref:y,sx:{display:"flex",width:"100%",height:"100%",overflow:"hidden"},children:[(0,eU.jsx)(m.A,{sx:{width:`${c}%`,height:"100%",overflow:"hidden"},children:e}),(0,eU.jsx)(m.A,{onMouseDown:k,sx:{width:`${s}px`,height:"100%",cursor:"col-resize",backgroundColor:u?"rgba(0, 133, 208, 1)":"rgba(0, 133, 208, 0.1)",transition:u?"none":"all 0.2s ease","&:hover":{backgroundColor:" rgba(0, 133, 208, 1)"},position:"relative",display:"flex",alignItems:"center",justifyContent:"center","&::before":{content:'"⋮"',position:"absolute",fontSize:"24px",color:p?"white":"rgba(0, 0, 0, 0.6)",fontWeight:"bold",lineHeight:1,userSelect:"none",pointerEvents:"none"},"&::after":{content:'""',position:"absolute",width:"2px",height:"40px",backgroundColor:"rgba(0, 133, 208, 0.4)",borderRadius:"1px",opacity:+!!u,transition:"opacity 0.2s ease"},"&:hover::before":{color:p?"rgba(255, 255, 255, 0.9)":"rgba(0, 0, 0, 0.9)"},"&:hover::after":{opacity:1,backgroundColor:"rgb(0, 133, 208)"}}}),(0,eU.jsx)(m.A,{sx:{width:`${100-c}%`,height:"100%",overflow:"hidden"},children:t})]})};var tu=i(4545),tx=i(3662);let ty=({currentUrl:e})=>{let{t}=(0,eL.s)();return(0,eU.jsx)(m.A,{sx:{padding:1},children:(0,eU.jsxs)(tu.A,{children:[t("map.yourMap","Your Map"),":"," ",(0,eU.jsx)(tx.A,{href:-1===e.indexOf("#")?"#":e,id:"url","data-testid":"breadcrumb-list-item-your-map",children:-1===e.indexOf("#")?`(${t("map.unsaved","unsaved")})`:e})]})})};var tv=i(8847),tg=i.n(tv);let tf=["component <name> [<visibility>, <maturity>] (outsource)","component <name> [<visibility>, <maturity>] (build)","component <name> [<visibility>, <maturity>] (buy)",...[...["pioneers","settlers","townplanners"].map(e=>[e,"[<visibility>, <maturity>, <visibility2>, <maturity2>]"]),["note","<note text>","[<visibility>, <maturity>]"],["component","<name>","[<visibility>, <maturity>]"],["accelerator","<name>","[<visibility>, <maturity>]"],["deaccelerator","<name>","[<visibility>, <maturity>]"],["submap","<name>","[<visibility>, <maturity>]","url(<url>)"],["url","<name>","[<address>]"],["size","[<width>, <height>]"]].map(e=>{let t=[];for(let i=0;i<e.length;i++)t.push(e.slice(0,i+1).join(" "));return t}).flat(),"anchor","annotation","annotations","style","style wardley","style colour","style handwritten","style plain","style dark","(ecosystem)","(market)","(build)","(buy)","(outsource)","evolve","inertia","pipeline","title","size","evolution","accelerator","deaccelerator"],tb=tg()(()=>i.e(366).then(i.bind(i,1232)),{ssr:!1}),tk=l.forwardRef((e,t)=>(0,eU.jsx)(tb,{...e,editorRef:t}));tk.displayName="ForwardedRefComponent";let tw=({wardleyMap:e,hideNav:t,highlightLine:i,errorLine:n,isLightTheme:o,invalid:s,mutateMapText:a,mapText:r,showLineNumbers:m})=>{let[p,d]=(0,l.useState)(500),c=(0,l.useRef)(null),h=()=>{let e=window.innerHeight;return e-(document.getElementById("top-nav-wrapper")?.clientHeight??0)-(document.getElementById("title")?.clientHeight??0)+35};(0,l.useEffect)(()=>{let e=()=>{d(h())};return window.addEventListener("load",e),window.addEventListener("resize",e),e(),function(){window.removeEventListener("resize",e),window.removeEventListener("load",e)}},[]),(0,l.useEffect)(()=>{d(h())},[t]),(0,l.useEffect)(()=>{(e=>{let t=c.current;null!==t&&e>0&&t.editor.gotoLine(e,0,!0)})(i)},[i]),(0,l.useEffect)(()=>{let e=c.current;if(null!==e){let t=e.editor;for(let e=0;e<t.session.getLength();e++)t.session.removeGutterDecoration(e,"ace_error");n.length>0&&n.forEach(e=>t.session.addGutterDecoration(e,"ace_error"))}},[n]);let u=[...e.components.map(e=>({caption:e.name,value:e.name,meta:"component"})),...e.anchors.map(e=>({caption:e.name,value:e.name,meta:"anchor"})),...e.markets.map(e=>({caption:e.name,value:e.name,meta:"market"})),...e.ecosystems.map(e=>({caption:e.name,value:e.name,meta:"ecosystem"})),...e.submaps.map(e=>({caption:e.name,value:e.name,meta:"submap"})),...tf.map(e=>({caption:e,value:e,meta:"syntax"}))];return(0,l.useEffect)(()=>{let e=c.current;null!==e&&(e.editor.completers=[{getCompletions:function(e,t,i,n,o){o(null,u.map(e=>({name:e.caption,value:e.value,score:1,meta:e.meta})))}}])},[u]),(0,eU.jsx)("div",{id:"editor-container",style:{width:"100%",height:p,paddingBottom:"10px"},children:(0,eU.jsx)(tk,{ref:c,mode:"owm",theme:o?"eclipse":"dracula",keyboardHandler:"vscode",name:"map_editor",onChange:a,fontSize:13,showPrintMargin:!1,showGutter:m||n.length>0,highlightActiveLine:!1,value:r,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:m,tabSize:2},style:{height:p,width:"100%",border:s?"2px solid red":"0px"},annotations:n.map(e=>({row:e,column:0,type:"error",text:"Map element not found or invalid syntax"}))})})};var tj=i(9436),tE=i(1734),tC=i(3277),tS=i(7420),tA=i(7249),tT=i(2999),tL=i(3150),tM=i(1399),tD=i(4862);let tN=({mapIterations:e,setMapText:t,addIteration:i,setMapIterations:n,setCurrentIteration:o,currentIteration:s})=>{let{t:a,originalT:r,currentLanguage:y}=(0,eL.s)(),v=(0,tD.Ay)(m.A)(({theme:e})=>({width:"100%",boxShadow:e.shadows[4],marginBottom:"2px"})),[g,f]=l.useState(!1),[b,k]=l.useState(!1),[w,j]=l.useState(""),E=(0,l.useRef)(null),C=e=>{e&&e(),f(!1)},S=e=>{e&&e(),k(!1)},A=()=>{let t=[...e];t[s].name=E.current?E.current.value:"",n(t)},T=function(){let t=[...e];t.splice(s,1),s>-1&&(0===t.length?o(-1):s>t.length-1||s===t.length?o(t.length-1):s<=t.length-1?o(0):o(s-1)),n(t)},L=()=>e.length,M=()=>s===L()-1,D=e=>()=>{o(e)};return(0,l.useEffect)(()=>{s>-1&&t(e[s].mapText)},[s]),(0,eU.jsxs)(v,{children:[(0,eU.jsx)(tM.A,{nonLinear:!0,activeStep:s,children:Array.isArray(e)&&e.map((e,t)=>(0,eU.jsx)(tT.A,{children:(0,eU.jsx)(tL.A,{color:"inherit",onClick:D(t),children:e.name})},t))}),(0,eU.jsx)("div",{children:(0,eU.jsxs)(m.A,{sx:{display:"flex",flexDirection:"row",pt:2},children:[(0,eU.jsxs)(x.A,{disabled:s<=0,onClick:()=>{o(e=>e-1)},sx:{mr:1},size:"small",children:[(0,eU.jsx)(tS.A,{})," ",a("common.back","Back")]}),(0,eU.jsx)(m.A,{sx:{flex:"1 1 auto"}}),(e.length>0||s>0)&&(0,eU.jsxs)(x.A,{size:"small",onClick:()=>{k(!0),j(e[s].name)},children:[a("common.delete","Delete")," ",(0,eU.jsx)(tE.A,{})]}),(e.length>0||s>0)&&(0,eU.jsxs)(x.A,{size:"small",onClick:()=>{f(!0),j(e[s].name)},children:[a("common.rename","Rename")," ",(0,eU.jsx)(tC.A,{})]}),(0,eU.jsxs)(x.A,{size:"small",onClick:function(){i(),-1===s&&o(0)},children:[a("common.add","Add")," ",(0,eU.jsx)(tj.A,{})]}),(0,eU.jsx)(m.A,{sx:{flex:"1 1 auto"}}),(0,eU.jsxs)(x.A,{size:"small",onClick:()=>{o(M()?-1:s+1)},sx:{mr:1},disabled:0===e.length||s===e.length-1,children:[a("common.next","Next")," ",(0,eU.jsx)(tA.A,{})]})]})}),(0,eU.jsxs)(p.A,{open:g,onClose:()=>C(),children:[(0,eU.jsx)(d.A,{children:a("common.rename","Rename")}),(0,eU.jsxs)(c.A,{children:[(0,eU.jsx)(h.A,{children:a("iterations.renamePrompt","Enter a new name for the current iteration.")}),(0,eU.jsx)(ts.A,{autoFocus:!0,margin:"dense",id:"name",label:a("iterations.iterationName","Iteration Name"),type:"text",fullWidth:!0,variant:"standard",defaultValue:w,inputRef:E})]}),(0,eU.jsxs)(u.A,{children:[(0,eU.jsx)(x.A,{onClick:()=>C(),children:a("common.cancel","Cancel")}),(0,eU.jsx)(x.A,{onClick:()=>C(()=>A()),children:a("common.update","Update")})]})]}),(0,eU.jsxs)(p.A,{open:b,onClose:()=>S(),"aria-labelledby":"alert-dialog-title-delete","aria-describedby":"alert-dialog-description-delete",children:[(0,eU.jsx)(d.A,{id:"alert-dialog-title-delete",children:a("dialogs.areYouSure","Are you sure?")}),(0,eU.jsx)(c.A,{children:(0,eU.jsx)(h.A,{id:"alert-dialog-description",children:r("iterations.deleteConfirmation",{name:w})||`Are you sure you want to delete iteration '${w}'? This cannot be undone.`})}),(0,eU.jsxs)(u.A,{children:[(0,eU.jsx)(x.A,{onClick:()=>S(()=>T()),children:a("common.delete","Delete")}),(0,eU.jsx)(x.A,{onClick:()=>S(),autoFocus:!0,children:a("common.cancel","Cancel")})]})]})]},`iterations-${y}`)};var tO=i(1454),tF=i(3304),t$=i(6817),tW=i(2097);let t_=(0,i(4092).A)(()=>({smallerSpeedDial:{"& .MuiSpeedDial-fab":{width:"32px",height:"32px",minHeight:"32px",minWidth:"32px"}}}));function tI(e){let t=t_(),{setQuickAdd:i}=e,n=e.mapStyleDefs;n.component=Object.assign(n.component,{stroke:"white",fill:"transparent",strokeWidth:1,radius:5});let o=[{name:"Component",icon:(0,eU.jsx)(e3,{id:"component-icon",text:"",hideLabel:!0,mapStyleDefs:n,evolved:!1}),onClick:(e,t)=>{e({cursor:(0,eU.jsx)(eX,{styles:t.mapStyleDefs.component,cx:"8px",cy:"8px"}),template:(e,t,i)=>`component ${e} [${t}, ${i}]`})}}];return(0,eU.jsx)(eU.Fragment,{children:(0,eU.jsx)(m.A,{sx:{transform:"translateZ(0px)",flexGrow:1},children:(0,eU.jsx)(tF.A,{ariaLabel:"SpeedDial basic example",className:t.smallerSpeedDial,sx:{position:"absolute",top:-10,right:60},icon:(0,eU.jsx)(tW.A,{}),direction:"left",children:o.map(t=>(0,eU.jsx)(t$.A,{icon:t.icon,tooltipTitle:t.name,onClick:()=>t.onClick(i,e)},t.name))})})})}var tP=i(8887);class tz{constructor(e){this.allComponents=[...e.components,...e.anchors,...e.submaps,...e.markets,...e.ecosystems],this.evolvedElements=e.evolved,this.pipelines=e.pipelines,this.markEvolvingComponents(),this.markPipelineComponents()}markEvolvingComponents(){let e=new Set;this.allComponents.forEach(t=>{t.decorators&&(t.decorators.buy||t.decorators.build||t.decorators.outsource)&&t.name&&e.add(t.name)}),this.allComponents=this.allComponents.map(t=>{if(this.evolvedElements.length>0){let e=this.evolvedElements.some(e=>e.name===t.name),i=this.evolvedElements.find(e=>e.name===t.name);if(e){let e=Math.max(t.increaseLabelSpacing||0,i?.increaseLabelSpacing||0,2),n=t.label||{x:0,y:0};if((!n.y||10>=Math.abs(n.y))&&(n={...n,y:10*e}),!n.x||10>=Math.abs(n.x)){let e=i?.override?16:5;n={...n,x:e}}return{...t,evolving:!0,evolveMaturity:i?.maturity,override:i?.override,increaseLabelSpacing:e,label:n}}}if(e.has(t.name)){let e=Math.max(t.increaseLabelSpacing||0,2),i=t.label||{x:0,y:0};return(!i.y||10>=Math.abs(i.y))&&(i={...i,y:10*e}),(!i.x||10>=Math.abs(i.x))&&(i={...i,x:5}),{...t,increaseLabelSpacing:e,label:i}}return t})}markPipelineComponents(){this.allComponents=this.allComponents.map(e=>this.pipelines.some(t=>t.name===e.name)?{...e,pipeline:!0}:e)}getAllComponents(){return this.allComponents}getComponentsByType(e){return this.allComponents.filter(t=>t.type===e)}getEvolvingComponents(){return this.allComponents.filter(e=>e.evolving)}getEvolvedComponents(){return this.getEvolvingComponents().map(e=>{let t=this.evolvedElements.find(t=>t.name===e.name);if(!t)throw Error(`Evolved element not found for ${e.name}`);let i=Math.max(t.increaseLabelSpacing||0,e.increaseLabelSpacing||0,2),n=t.label||e.label||{x:0,y:0};return(!n.x||10>=Math.abs(n.x))&&t.override&&(n={...n,x:16}),eA({...e,id:e.id+"_evolved",maturity:t.maturity,evolving:!1,evolved:!0,label:n,override:t.override||e.override,line:t.line||e.line,decorators:e.decorators,increaseLabelSpacing:i})})}getStaticComponents(){return this.allComponents.filter(e=>!e.evolved)}getInertiaComponents(){return this.allComponents.filter(e=>!0===e.inertia)}getNeitherEvolvedNorEvolvingComponents(){return this.allComponents.filter(e=>!e.evolving&&!e.evolved)}getNonEvolvingComponents(){return this.allComponents.filter(e=>!e.evolving)}getNonEvolvedComponents(){return this.allComponents.filter(e=>!e.evolved)}getEitherEvolvedOrEvolvingComponents(){return this.allComponents.filter(e=>e.evolving||e.evolved)}getMergedComponents(){return[...this.getStaticComponents(),...this.getEvolvedComponents()]}getPipelineComponents(){return this.pipelines}getLegacyAdapter(){return{getAllComponents:()=>this.getAllComponents(),getComponentsByType:e=>this.getComponentsByType(e),getEvolvingComponents:()=>this.getEvolvingComponents(),getEvolvedComponents:()=>this.getEvolvedComponents(),getMergedComponents:()=>this.getMergedComponents(),getPipelineComponents:()=>this.getPipelineComponents(),getInertiaComponents:()=>this.getInertiaComponents(),getEvolveElements:()=>this.getEvolvingComponents(),getEvolvedElements:()=>this.getEvolvedComponents(),getMergedElements:()=>this.getMergedComponents(),getMapPipelines:()=>this.getPipelineComponents(),getNoneEvolvedOrEvolvingElements:()=>this.getNeitherEvolvedNorEvolvingComponents(),getNoneEvolvingElements:()=>this.getNonEvolvingComponents(),getNeitherEvolvedNorEvolvingComponents:()=>this.getNeitherEvolvedNorEvolvingComponents(),convertToMapElement:e=>e,convertToMapElements:e=>e,getEvolvedUnifiedComponents:()=>this.getEvolvedComponents()}}}class tH{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){if(!this.links||!this.mapElements)return{name:"empty",links:[],startElements:[],endElements:[]};let e=this.mapElements.getNoneEvolvedOrEvolvingElements();return{name:"links",links:this.links,startElements:e,endElements:e}}}class tY{constructor(e=[],t={},i=[]){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t,this.anchors=i}getLinks(){return{name:"anchorEvolvedLinks",links:this.links.filter(e=>this.anchors?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements().filter(t=>t.name===e.end)),startElements:this.anchors.map(e=>({...e})),endElements:this.mapElements.getEvolvedElements()}}}class tR{constructor(e=[],t={},i=[]){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t,this.anchors=i}getLinks(){return this.links&&this.mapElements?{name:"anchorLinks",links:this.links.filter(e=>this.anchors?.find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvedOrEvolvingElements()?.find(t=>t.name===e.end)),startElements:this.anchors.map(e=>e),endElements:this.mapElements.getNoneEvolvedOrEvolvingElements().map(e=>({...e,decorators:e.decorators||{ecosystem:!1,market:!1}}))}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tB{constructor(e=[],t={},i=[]){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t,this.anchors=i}getLinks(){return this.links&&this.mapElements?{name:"anchorNonEvolvedLinks",links:this.links.filter(e=>this.anchors?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)),startElements:this.anchors.map(e=>e),endElements:this.mapElements.getEvolvedElements()}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tU{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"bothEvolved",links:this.links.filter(e=>this.mapElements.getEvolvedElements()?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getEvolvedElements(),endElements:this.mapElements.getEvolvedElements()}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tX{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return{name:"evolvedToEvolving",links:this.links.filter(e=>this.mapElements.getEvolvedElements()?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getEvolvedElements(),endElements:this.mapElements.getEvolvedElements()}}}class tV{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"evolveStartLinks",links:this.links.filter(e=>this.mapElements.getEvolvedElements()?.find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvingElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getNoneEvolvingElements()||[],endElements:this.mapElements.getEvolveElements()||[]}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tG{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return{name:"evolveToEvolved",links:this.links.filter(e=>this.mapElements.getEvolveElements()?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements(),endElements:this.mapElements.getEvolvedElements()}}}class tK{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"evolvingEndLinks",links:this.links.filter(e=>this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)&&this.mapElements.getNoneEvolvingElements()?.find(t=>t.name===e.start)),startElements:this.mapElements.getNoneEvolvingElements()||[],endElements:this.mapElements.getEvolveElements()||[]}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tZ{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"bothEvolving",links:this.links.filter(e=>this.mapElements.getEvolveElements()?.find(t=>t.name===e.start)&&this.mapElements.getEvolveElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements(),endElements:this.mapElements.getEvolveElements()}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tq{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"evolvingToNoneEvolvingEndLinks",links:this.links.filter(e=>this.mapElements.getEvolveElements()?.find(t=>t.name===e.start)&&this.mapElements.getNoneEvolvingElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getEvolveElements()||[],endElements:this.mapElements.getNoneEvolvingElements()||[]}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tQ{constructor(e=[],t={}){this.links=e||[],this.mapElements=t?.getLegacyAdapter?t.getLegacyAdapter():t}getLinks(){return this.links&&this.mapElements?{name:"noneEvolvingToEvolvedEndLinks",links:this.links.filter(e=>this.mapElements.getNoneEvolvingElements()?.find(t=>t.name===e.start)&&this.mapElements.getEvolvedElements()?.find(t=>t.name===e.end)),startElements:this.mapElements.getNoneEvolvingElements()||[],endElements:this.mapElements.getEvolvedElements()||[]}:{name:"empty",links:[],startElements:[],endElements:[]}}}class tJ{constructor(e=[],t={},i=[],n=!1){e=e||[];let o=n?[new tG(e,t),new tV(e,t),new tQ(e,t),new tU(e,t),new tX(e,t),new tY(e,t,i)]:[];this.linkStrategies=o.concat([new tH(e,t),new tK(e,t),new tZ(e,t),new tR(e,t,i),new tB(e,t,i),new tq(e,t)])}getElementByName(e,t){return e?.find(e=>e.name===t)}canSatisfyLink(e,t,i){return void 0!==this.getElementByName(t,e.start)&&void 0!==this.getElementByName(i,e.end)}build(){let e=[];return this.linkStrategies.forEach(t=>{let i=t.getLinks(),n=[];i.links.forEach((e,t)=>{if(this.canSatisfyLink(e,i.startElements,i.endElements)){let o={key:t,startElement:this.getElementByName(i.startElements,e.start),endElement:this.getElementByName(i.endElements,e.end),link:e};n.push(o)}}),e.push({name:i.name,links:n})}),e}}var t0=i(5793),t1=i(8684),t2=i(6656),t5=i(8456),t9=i(8589),t3=i(2257),t4=i(1462),t8=i(7457),t6=i(9302);let t7=({shouldHideNav:e,hideNav:t,tool:i,handleChangeTool:n,_fitToViewer:o})=>{let s={color:"#90caf9"},a={color:"rgba(0, 0, 0, 0.54)"},{t:l}=(0,eL.s)();return(0,eU.jsxs)(t8.A,{orientation:"horizontal","aria-label":l("map.toolbar.group","button group"),children:[(0,eU.jsx)(t6.A,{id:"wm-map-select","aria-label":l("map.toolbar.select","Select"),onClick:e=>n(e,tP.qD),sx:i===tP.qD?s:a,children:(0,eU.jsx)(t9.A,{})}),(0,eU.jsx)(t6.A,{id:"wm-map-pan","aria-label":l("map.toolbar.pan","Pan"),onClick:e=>n(e,tP.JN),sx:i===tP.JN?s:a,children:(0,eU.jsx)(t0.A,{})}),(0,eU.jsx)(t6.A,{id:"wm-zoom-in","aria-label":l("map.toolbar.zoomIn","Zoom In"),sx:i===tP.p7?s:a,onClick:e=>n(e,tP.p7),children:(0,eU.jsx)(t3.A,{})}),(0,eU.jsx)(t6.A,{id:"wm-zoom-out","aria-label":l("map.toolbar.zoomOut","Zoom Out"),sx:i===tP.Wm?s:a,onClick:e=>n(e,tP.Wm),children:(0,eU.jsx)(t4.A,{})}),(0,eU.jsx)(t6.A,{id:"wm-map-fit","aria-label":l("map.toolbar.fit","Fit"),sx:a,onClick:()=>o(),children:(0,eU.jsx)(t1.A,{})}),(0,eU.jsx)(t6.A,{id:"wm-map-fullscreen",onClick:()=>e(),"aria-label":t?l("map.toolbar.exitFullscreen","Exit Fullscreen"):l("map.toolbar.fullscreen","Fullscreen"),children:t?(0,eU.jsx)(t5.A,{sx:a}):(0,eU.jsx)(t2.A,{sx:a})})]})},ie={wardley:"url(#wardleyGradient)",colour:"none",plain:"none",handwritten:"none",dark:"#353347"},it=({mapStyleClass:e,mapDimensions:t})=>(0,eU.jsx)("rect",{x:"0",width:t.width,y:"0",height:t.height,id:"fillArea",fill:ie[e]}),ii=({mapDimensions:e,evolutionOffsets:t,mapStyleDefs:i,mapEvolutionStates:n})=>{let o=e.width/20*t.custom+2,s=e.width/20*t.product+2,a=e.width/20*t.commodity+2;return(0,eU.jsxs)("g",{id:"Evolution",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",fontStyle:"italic",transform:"translate(0,"+e.height+")",children:[(0,eU.jsx)("line",{x1:"0",y1:"0",x2:e.width-2,y2:"0",stroke:i.stroke,strokeWidth:i.strokeWidth,markerEnd:"url(#graphArrow)"}),"wardley"===i.className?(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:"10",y:-e.height+15,textAnchor:"start",fontStyle:"normal",fontSize:"11px",fontWeight:"bold",children:"Uncharted"}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:e.width-10,y:-e.height+15,textAnchor:"end",fontStyle:"normal",fontSize:"11px",fontWeight:"bold",children:"Industrialised"})]}):null,(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:"0",y:"1em",textAnchor:"start",children:n.genesis.l1}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:"0",y:"2em",textAnchor:"start",children:n.genesis.l2}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:o+5,y:"1em",textAnchor:"start",children:n.custom.l1}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:o+5,y:"2em",textAnchor:"start",children:n.custom.l2}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:s+5,y:"1em",textAnchor:"start",children:n.product.l1}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:s+5,y:"2em",textAnchor:"start",children:n.product.l2}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:a+5,y:"1em",textAnchor:"start",children:n.commodity.l1}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:a+5,y:"2em",textAnchor:"start",children:n.commodity.l2}),(0,eU.jsx)("text",{fill:i.mapGridTextColor,x:e.width,y:"1.8em",textAnchor:"end",fontWeight:"bold",fontStyle:"normal",children:"Evolution"})]})},io=()=>(0,eU.jsx)("pattern",{id:"diagonalHatch",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:(0,eU.jsx)("path",{d:"M 3,-1 l 2,2 M 0,0 l 4,4 M -1,3 l 2,2 ",stroke:"grey",strokeWidth:"1",opacity:".5"})}),is=(0,l.memo)(({mapStyleDefs:e})=>(0,eU.jsxs)("defs",{children:[(0,eU.jsxs)("linearGradient",{id:"arrowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[(0,eU.jsx)("stop",{offset:"0%",style:{stopColor:"#ffffff",stopOpacity:1}}),(0,eU.jsx)("stop",{offset:"40%",style:{stopColor:"#808080",stopOpacity:1}}),(0,eU.jsx)("stop",{offset:"100%",style:{stopColor:"#808080",stopOpacity:1}})]}),(0,eU.jsx)("filter",{id:"ctrlHighlight",children:(0,eU.jsx)("feDropShadow",{dx:"0",dy:"0",stdDeviation:"3",floodColor:"blue"})}),(0,eU.jsxs)("linearGradient",{gradientUnits:"objectBoundingBox",id:"wardleyGradient",spreadMethod:"pad",x1:"0%",x2:"100%",y1:"0%",y2:"0%",children:[(0,eU.jsx)("stop",{offset:"0%",style:{stopColor:"rgb(196, 196, 196)",stopOpacity:1}}),(0,eU.jsx)("stop",{offset:"0.3",style:{stopColor:"white",stopOpacity:1}}),(0,eU.jsx)("stop",{offset:"0.7",style:{stopColor:"white"}}),(0,eU.jsx)("stop",{offset:1,style:{stopColor:"rgb(196, 196, 196)"}})]}),(0,eU.jsxs)("linearGradient",{spreadMethod:"pad",id:"accelGradient",x1:"0%",y1:"64%",x2:"76%",y2:"0%",children:[(0,eU.jsx)("stop",{offset:"0%",style:{stopColor:"white",stopOpacity:1}}),(0,eU.jsx)("stop",{offset:"100%",style:{stopColor:"#8c8995",stopOpacity:1}})]}),io(),(0,eU.jsx)("marker",{id:"arrow",markerWidth:"12",markerHeight:"12",refX:"15",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,eU.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.link?.evolvedStroke})}),(0,eU.jsx)("marker",{id:"graphArrow",markerWidth:12/(e.strokeWidth??0),markerHeight:12/(e.strokeWidth??0),refX:"9",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,eU.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.stroke})}),(0,eU.jsx)("marker",{id:"pipelineArrow",markerWidth:e.pipelineArrowWidth,markerHeight:e.pipelineArrowHeight,refX:"9",refY:"0",viewBox:"0 -5 10 10",orient:"0",children:(0,eU.jsx)("path",{d:"M0,-5L10,0L0,5",fill:e.pipelineArrowStroke})})]})),ia=({mapDimensions:e,mapStyleDefs:t,evolutionOffsets:i})=>(0,eU.jsxs)("g",{id:"valueChain",transform:"translate(0,"+e.height+") rotate(270)",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',fontSize:"13px",children:[(0,eU.jsx)("line",{x1:"0",y1:"0",x2:e.height,y2:"0",stroke:t.stroke,strokeWidth:t.strokeWidth,strokeDasharray:t.strokeDasharray}),(0,eU.jsx)("line",{x1:"-2em",y1:e.width/20*i.custom,x2:e.height,y2:e.width/20*i.custom,stroke:t.evolutionSeparationStroke,strokeDasharray:t.strokeDasharray}),(0,eU.jsx)("line",{x1:"-2em",y1:e.width/20*i.product,x2:e.height,y2:e.width/20*i.product,stroke:t.evolutionSeparationStroke,strokeDasharray:t.strokeDasharray}),(0,eU.jsx)("line",{x1:"-2em",y1:e.width/20*i.commodity,x2:e.height,y2:e.width/20*i.commodity,stroke:t.evolutionSeparationStroke,strokeDasharray:t.strokeDasharray}),(0,eU.jsx)("text",{fill:t.mapGridTextColor,x:e.height-2,y:"-0.4em",textAnchor:"end",fontWeight:"bold",children:"Value Chain"})]}),il=function(e){let{mapTitle:t}=e;return(0,eU.jsx)("text",{x:0,y:-10,id:"mapTitle",fontWeight:"bold",fontSize:"20px",fontFamily:'"Helvetica Neue",Helvetica,Arial,sans-serif',children:t})},ir=({mapStyleDefs:e,mapDimensions:t,mapTitle:i,evolutionOffsets:n,mapEvolutionStates:o})=>(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(is,{mapStyleDefs:e}),(0,eU.jsxs)("g",{id:"grid",children:[(0,eU.jsx)(it,{mapDimensions:t,mapStyleClass:e.className||""}),(0,eU.jsx)(il,{mapTitle:i}),(0,eU.jsx)(ia,{mapDimensions:t,mapStyleDefs:e,evolutionOffsets:n}),(0,eU.jsx)(ii,{mapDimensions:t,mapEvolutionStates:o,mapStyleDefs:e,evolutionOffsets:n})]})]});class im{visibilityToY(e,t){return(1-e)*t}maturityToX(e,t){return e*t}xToMaturity(e,t){return(1/t*e).toFixed(2)}yToVisibility(e,t){return(1-1/t*e).toFixed(2)}}let ip=(0,l.memo)(({id:e,onClick:t,component:i})=>{let n=i?.type==="deaccelerator";return(0,eU.jsxs)("g",{transform:["translate(-25, -25)"].concat(n?"rotate(180,25,25)":"").join(" "),id:e,onClick:t,children:[(0,eU.jsx)("g",{opacity:"0.8",fill:"url(#arrowGradient)",children:(0,eU.jsx)("path",{d:"m25.5 6 18 18 -18 18v-9H9a1.5 1.5 0 0 1 -1.5 -1.5V16.5a1.5 1.5 0 0 1 1.5 -1.5h16.5Z"})}),(0,eU.jsx)("path",{d:"m44.561 22.939 -18 -18A1.5 1.5 0 0 0 24 6v7.5H9a3.003 3.003 0 0 0 -3 3v15a3.003 3.003 0 0 0 3 3h15v7.5a1.5 1.5 0 0 0 2.561 1.06l18 -18a1.5 1.5 0 0 0 0 -2.121ZM27 38.379V33a1.5 1.5 0 0 0 -1.5 -1.5H9V16.5h16.5a1.5 1.5 0 0 0 1.5 -1.5V9.621L41.379 24Z"})]})}),id=(0,l.memo)(({id:e,x:t="-5",y:i="-5",width:n="10",height:o="10",onClick:s,styles:a,component:l})=>{let r=l?.evolved||!1,m=r?a.evolvedFill:a.fill,p=r?a.evolved:a.stroke;return(0,eU.jsx)("rect",{onClick:s,id:e,x:t,y:i,fill:m,stroke:p,width:n,height:o,strokeWidth:a.pipelineStrokeWidth})}),ic=(0,l.memo)(({id:e,cx:t,cy:i,onClick:n,styles:o,launchUrl:s,component:a})=>{let l=a?.evolved||!1,r=l?o.evolvedFill:o.fill,m=l?o.evolved:o.stroke;return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)("rect",{x:"-20",y:"-6",stroke:"none",width:"30px",fillOpacity:"0",className:"submapLink",onClick:s,height:"12px"}),(0,eU.jsx)("g",{transform:"translate(-23, -8)",children:(0,eU.jsxs)("svg",{onClick:s,stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 16 16",color:"black",className:"submapLink",height:"18px",width:"18px",xmlns:"http://www.w3.org/2000/svg",style:{color:"black"},children:[(0,eU.jsx)("path",{d:"M4.715 6.542L3.343 7.914a3 3 0 104.243 4.243l1.828-1.829A3 3 0 008.586 5.5L8 6.086a1.001 1.001 0 00-.154.199 2 2 0 01.861 3.337L6.88 11.45a2 2 0 11-2.83-2.83l.793-.792a4.018 4.018 0 01-.128-1.287z"}),(0,eU.jsx)("path",{d:"M5.712 6.96l.167-.167a1.99 1.99 0 01.896-.518 1.99 1.99 0 01.518-.896l.167-.167A3.004 3.004 0 006 5.499c-.22.46-.316.963-.288 1.46z"}),(0,eU.jsx)("path",{d:"M6.586 4.672A3 3 0 007.414 9.5l.775-.776a2 2 0 01-.896-3.346L9.12 3.55a2 2 0 012.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 00-4.243-4.243L6.586 4.672z"}),(0,eU.jsx)("path",{d:"M10 9.5a2.99 2.99 0 00.288-1.46l-.167.167a1.99 1.99 0 01-.896.518 1.99 1.99 0 01-.518.896l-.167.167A3.004 3.004 0 0010 9.501z"})]})}),(0,eU.jsx)("circle",{id:e,cx:t,cy:i,strokeWidth:o.strokeWidth,r:o.radius,stroke:m,fill:r,onClick:n})]})});class ih{visibilityToY(e,t){return(1-e)*t}maturityToX(e,t){return e*t}xToMaturity(e,t){return(1/t*e).toFixed(2)}yToVisibility(e,t){return(1-1/t*e).toFixed(2)}}let iu=({isModKeyPressed:e})=>{if(e)return"url(#ctrlHighlight)"},ix=e=>{let t=(0,l.useCallback)(()=>e.x,[e.x]),i=(0,l.useCallback)(()=>e.y,[e.y]),[n,o]=l.useState(!1),s=e.shouldShowMoving??!1,[a,r]=l.useState({x:t(),y:i(),coords:{}}),m=(0,l.useCallback)(t=>{r(i=>{let n=e.scaleFactor||1,o=(i.coords.x-t.pageX)/n,s=(i.coords.y-t.pageY)/n;return{x:i.x-o,y:i.y-s,coords:{x:t.pageX,y:t.pageY}}})},[e.scaleFactor]),p=t=>{if(e.isModKeyPressed)return;o(!0);let i=t.pageX,n=t.pageY;r(e=>Object.assign({},e,{coords:{x:i,y:n}})),document.addEventListener("mousemove",m),document.addEventListener("keyup",d)},d=e=>{"Escape"===e.key&&n&&(document.removeEventListener("mousemove",m),document.removeEventListener("keyup",d),o(!1),h(),r({x:t(),y:i(),coords:{}}))},c=()=>{e.isModKeyPressed||(document.removeEventListener("mousemove",m),r(e=>Object.assign({},e,{coords:{}})),o(!1),h())};function h(){let t={x:a.x,y:a.y};e.onMove(t)}(0,l.useEffect)(()=>{r({x:t(),y:i(),coords:{}})},[t,i]);let u=iu(e);return(0,eU.jsxs)("g",{className:"draggable",style:{cursor:n?"grabbing":"grab"},onMouseDown:e=>p(e),onMouseUp:()=>c(),id:`modern_movable_${e.id}`,filter:u,transform:"translate("+(e.fixedX?t():a.x)+","+(e.fixedY?i():a.y)+")",children:[(0,eU.jsx)("rect",{x:"-15",y:"-15",rx:"30",ry:"30",width:"30",height:"30",fillOpacity:s&&n?.2:0}),e.children]})};class iy{constructor(e,t,i,n){this.type=e,this.mapText=t,this.mutator=i,this.replacers=n}setSuccessor(e){throw Error("Method not implemented.")}update(e,t){let i=this.mapText.split("\n").map(i=>{for(let n=0;n<this.replacers.length;n++){let o=this.replacers[n];if(o.matcher(i,t,this.type))return o.action(i,e)}return i}).join("\n");this.mutator(i)}}let iv={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>{let i="number"==typeof t.param1?t.param1.toString():parseFloat(t.param1).toString(),n="number"==typeof t.param2?t.param2.toString():parseFloat(t.param2).toString();return e.replace(/\[([^[\]]+)\]/g,`[${i}, ${n}]`)}},ig={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>`${e.trim()} [${t.param1}, ${t.param2}]`},ib=l.memo(({anchor:e,mapText:t,mutateMapText:i,mapDimensions:n,mapStyleDefs:o,onClick:s})=>{let a=(0,eB.VH)(),l="anchor",r=(t="",i="")=>`${l}_${void 0!==t?t+"_":""}${e.id}${void 0!==i?"_"+i:""}`,m=new ih,p=new iy(l,t,i,[iv,ig]);return(0,eU.jsx)(eU.Fragment,{children:(0,eU.jsx)(ix,{id:r(),onMove:function(t){let i=m.yToVisibility(t.y,n.height),o=m.xToMaturity(t.x,n.width);p.update({param1:i,param2:o},e.name)},x:m.maturityToX(e.maturity,n.width),y:m.visibilityToY(e.visibility,n.height),fixedY:!1,fixedX:!1,isModKeyPressed:a,children:(0,eU.jsx)(eV,{id:r("text"),text:e.name,x:"0",y:"-10",textAnchor:"middle",evolved:e.evolved,textTheme:o.component,onClick:s})})})}),ik=(0,l.memo)(({id:e,dy:t="0",x:i="2",textAnchor:n="start",textDecoration:o="underline",className:s="label draggable",theme:a,children:l})=>(0,eU.jsxs)("text",{id:e,children:[(0,eU.jsx)("tspan",{className:s,textAnchor:n,dy:t,x:i,fill:a.text,textDecoration:o,children:"Annotations:"}),l]})),iw=(0,l.memo)(({id:e,annotation:t,styles:i})=>(0,eU.jsxs)("tspan",{id:e,className:"label",textAnchor:"start",dy:18,x:0,fill:i.boxTextColour,children:["\xa0",t.number,". ",t.text,"\xa0"]}));class ij{constructor(e,t,i){this.type=e,this.mutator=i,this.mapText=t,this.positionUpdater=null}setSuccessor(e){this.positionUpdater=e}update(e,t){this.mapText.indexOf(this.type+" ")>-1&&null!=this.positionUpdater?this.positionUpdater.update(e,t):this.mutator(this.mapText+"\n"+this.type+` [${e.param1}, ${e.param2}]`)}}let iE=e=>{let t=new ih,i="annotations",[,n]=(0,l.useState)(null),o=new iy(i,e.mapText,e.mutateMapText,[iv]),s=new ij(i,e.mapText,e.mutateMapText);s.setSuccessor(o);let a=(0,l.useCallback)(()=>{let t=document.getElementById("annotationsBoxWrap");null!==t&&t.parentNode?.removeChild(t);let i=document.getElementById("movable_annotationsBox");if(!i)return void console.warn('Element with ID "movable_annotationsBox" not found');let o=i.getBBox();n(o);let s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.setAttribute("x",(o.x-2).toString()),s.setAttribute("id","annotationsBoxWrap"),s.setAttribute("y",(o.y-2).toString()),s.setAttribute("class","draggable"),s.setAttribute("width",(o.width+4).toString()),s.setAttribute("height",(o.height+4).toString()),s.setAttribute("stroke",e.mapStyleDefs.annotation.boxStroke),s.setAttribute("stroke-width",e.mapStyleDefs.annotation.boxStrokeWidth.toString()),s.setAttribute("fill",e.mapStyleDefs.annotation.boxFill),i.firstChild?i.insertBefore(s,i.firstChild):i.appendChild(s)},[e.mapStyleDefs]);return(0,l.useEffect)(()=>{let e=setTimeout(()=>{a()},50);return()=>clearTimeout(e)},[e.position.maturity,e.position.visibility,e.mapDimensions,e.mapStyleDefs,e.annotations,a]),(0,eU.jsx)(ix,{id:"annotationsBox",onMove:function(i){let n=parseFloat(t.yToVisibility(i.y,e.mapDimensions.height)),o=parseFloat(t.xToMaturity(i.x,e.mapDimensions.width));s.update({param1:n,param2:o},""),e.mutateMapText(e.mapText.split("\n").map(e=>0===e.trim().indexOf("annotations")?e.replace(/\[(.+?)\]/g,`[${n.toFixed(2)}, ${o.toFixed(2)}]`):e).join("\n"))},fixedY:!1,fixedX:!1,x:t.maturityToX(e.position.maturity,e.mapDimensions.width),y:t.visibilityToY(e.position.visibility,e.mapDimensions.height),scaleFactor:e.scaleFactor,children:(0,eU.jsx)("g",{id:"movable_annotationsBox",children:(0,eU.jsx)(ik,{id:"annotationsBoxTextContainer",dy:0,x:2,theme:e.mapStyleDefs.annotation,children:e.annotations&&e.annotations.map((t,i)=>(0,eU.jsx)(iw,{annotation:t,styles:e.mapStyleDefs.annotation},i))})})})},iC=(0,l.memo)(({id:e,annotation:t,styles:i})=>(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)("circle",{id:e,cx:"-0",cy:"0",className:"draggable",r:"15",fill:i.fill,stroke:i.stroke,strokeWidth:i.strokeWidth}),(0,eU.jsx)("text",{x:"-5",y:"5",className:"label draggable",textAnchor:"start",children:t.number})]}),(e,t)=>e.annotation.number===t.annotation.number&&e.styles===t.styles),iS=({occurance:e,annotation:t,mapDimensions:i,mutateMapText:n,mapText:o,occuranceIndex:s,scaleFactor:a,mapStyleDefs:l})=>{let r=new ih;return(0,eU.jsx)(ix,{id:`modern_annotation_element_${t.number}`,onMove:function(e){n(o.split("\n").map(n=>{let o=n.replace(/\s/g,""),a=`annotation${t.number}[`;if(-1!==o.indexOf(a)){if(o.indexOf("]]")>-1){let t=n.replace(/\s/g,"").split("[[")[1].split("]]")[0].split("],["),o=r.yToVisibility(e.y,i.height),a=r.xToMaturity(e.x,i.width);t[s]=`${o},${a}`;let l=n.split("[")[0].trim(),m=n.substr(n.lastIndexOf("]"),n.length-n.lastIndexOf("]")),p=`[${t.map(e=>`[${e.trim()}]`).join(",")}`;return`${l} ${p}${m}`}return n.replace(/\[(.+?)\]/g,`[${r.yToVisibility(e.y,i.height)}, ${r.xToMaturity(e.x,i.width)}]`)}return n}).join("\n"))},x:r.maturityToX(e.maturity,i.width),y:r.visibilityToY(e.visibility,i.height),fixedY:!1,fixedX:!1,scaleFactor:a,children:(0,eU.jsx)(iC,{id:`modern_annotation_element_symbol_${t.number}`,annotation:t,styles:l.annotation})})},iA=(0,l.memo)(({id:e,height:t,width:i,fill:n,stroke:o,fillOpacity:s,strokeOpacity:a,attitude:l,styles:r})=>{let m=r[l]||r.pioneers;return(0,eU.jsx)("rect",{id:e,fill:n||m.fill,stroke:o||m.stroke,fillOpacity:s||m.fillOpacity,strokeOpacity:a||m.strokeOpacity,height:t||"100",width:i||"200",strokeWidth:r.strokeWidth})}),iT={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>e.replace(/\[([^[\]]+)\]/g,`[${t.param1}, ${t.param2}, ${t.param3}, ${t.param4}]`)};class iL{constructor(e,t,i,n){this.type=e,this.mapText=t,this.mutator=i,this.replacers=n}update(e,t,i){let n=this.mapText.split("\n");if(i>n.length){let e=i-n.length;for(let t=0;t<e-1;t++)n.push("");n.push("undefined"),this.mutator(n.join("\n"));return}let o=i-1,s=n[o];for(let i of this.replacers)if(i.matcher(s,t,this.type)){s=i.action(s,e),n[o]=s;break}this.mutator(n.join("\n"))}}let iM={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>`${e.trim()} [${t.param1}, ${t.param2}, ${t.param3}, ${t.param4}]`},iD=({attitude:e,mapDimensions:t,mapText:i,mutateMapText:n,mapStyleDefs:o,scaleFactor:s})=>{let{height:a,width:l}=t,r=e.attitude,m=new ih,p=new iL(r,i,n,[iT,iM]),d=m.maturityToX(e.maturity,l),c=m.maturityToX(e.maturity2,l),h=m.visibilityToY(e.visibility,a),u=m.visibilityToY(e.visibility2,a);return(0,eU.jsx)(eU.Fragment,{children:(0,eU.jsx)(ix,{id:`modern_attitude_${r}_movable`,onMove:function(t){let i=parseFloat(m.yToVisibility(t.y,a)),n=parseFloat(m.xToMaturity(t.x,l)),o=e.visibility2,s=e.maturity2;e.visibility<i&&(o=i-e.visibility+e.visibility2),e.visibility>i&&(o=i-e.visibility+e.visibility2),e.maturity<n&&(s=n-e.maturity+e.maturity2),e.maturity>n&&(s=n-e.maturity+e.maturity2),p.update({param1:parseFloat(i.toFixed(2)),param2:parseFloat(n.toFixed(2)),param3:parseFloat(o.toFixed(2)),param4:parseFloat(s.toFixed(2))},"",e.line)},x:d,y:h,fixedY:!1,fixedX:!1,scaleFactor:s,children:(0,eU.jsx)(iA,{id:`modern_attitude_${r}`,attitude:r,height:u-h,width:c-d,styles:o.attitudes})})})},iN={evolvedStroke:"#000000",stroke:"#000000",evolvedStrokeWidth:2,strokeWidth:1,flowStrokeWidth:1,flow:"none"},iO=(0,l.memo)(({id:e,x1:t,x2:i,y1:n,y2:o,flow:s,evolved:a,strokeDasharray:l,isMarkerStart:r,marker:m,styles:p={},filter:d})=>{let c={...iN,...p},h=a?c.evolvedStroke:c.stroke,u=a?c.evolvedStrokeWidth:c.strokeWidth;return(0,eU.jsxs)("g",{id:e,children:[(0,eU.jsx)("line",{x1:t,y1:n,x2:i,y2:o,strokeDasharray:l,stroke:h,strokeWidth:u,markerStart:r?m:void 0,markerEnd:r?void 0:m,filter:d}),s&&(0,eU.jsx)("line",{x1:t,y1:n,x2:i,y2:o,strokeWidth:c.flowStrokeWidth,stroke:c.flow})]})}),iF=e=>{let[t,i]=l.useState(!1),n=(0,l.useCallback)(()=>e.x,[e.x]),o=(0,l.useCallback)(()=>e.y,[e.y]),[s,a]=l.useState({x:n(),y:o(),coords:{}}),r=(0,l.useCallback)(t=>{a(i=>{let n=e.scaleFactor||1,o=(i.coords.x-t.pageX)/n,s=(i.coords.y-t.pageY)/n;return{x:i.x-o,y:i.y-s,coords:{x:t.pageX,y:t.pageY}}})},[e.scaleFactor]),m=e=>{"Escape"===e.key&&t&&(i(!1),c(),document.removeEventListener("mousemove",r),document.removeEventListener("keyup",m),a({x:n(),y:o(),coords:{}}))},p=e=>{let t=e.pageX,n=e.pageY;i(!0),a(e=>Object.assign({},e,{coords:{x:t,y:n}})),document.addEventListener("mousemove",r),document.addEventListener("keyup",m)},d=()=>{document.removeEventListener("mousemove",r),a(e=>Object.assign({},e,{coords:{}})),i(!1),c()};function c(){if(e.onMove){let t={x:parseInt(s.x.toString(),10),y:parseInt(s.y.toString(),10)};console.log("RelativeMovable endDrag:",{id:e.id,rawPosition:s,movedResult:t}),e.onMove(t)}}return(0,l.useEffect)(()=>{a({x:n(),y:o(),coords:{}})},[n,o]),(0,eU.jsx)("g",{className:"draggable",style:{cursor:t?"grabbing":"grab"},onMouseDown:e=>p(e),onMouseUp:()=>d(),id:`modern_movable_${e.id}`,transform:"translate("+(e.fixedX?n():s.x)+","+(e.fixedY?o():s.y)+")",children:e.children},`modern_movable_${e.id}`)},i$=({mapStyleDefs:e,startElement:t,endElement:i,link:n,x:o,y:s,scaleFactor:a})=>{let l=`flow_text_${t.id}_${i.id}`;if(!n.flowValue)return null;let r={fontWeight:e.component.fontWeight,evolvedTextColor:e.component.evolvedTextColor,textColor:e.component.textColor};return(0,eU.jsx)("g",{id:"flow_"+i.name,transform:`translate(${o},${s})`,children:(0,eU.jsx)(iF,{id:l,x:0,y:0,scaleFactor:a,relativeToElementId:`link_${t.id}_${i.id}`,children:(0,eU.jsx)(eV,{id:`flow_text_symbol_${t.id}_${i.id}`,evolved:i.evolved||t.evolved,text:n.flowValue||"",textTheme:r})})})},iW=(e,t,i,n)=>180/Math.PI*Math.atan2(n-t,i-e),i_=({mapStyleDefs:e,mapDimensions:t,startElement:i,endElement:n,link:o,scaleFactor:s})=>{let{enableLinkContext:a}=(0,eR.YY)(),{height:l,width:r}=t,m=new ih,p=!1!==o.flow,d=i.evolved||n.evolved,c=i.maturity??i.evolveMaturity??0,h=n.maturity??n.evolveMaturity??0,u=m.maturityToX(c,r),x=m.maturityToX(h,r),y=m.visibilityToY("string"==typeof i.visibility?parseFloat(i.visibility):i.visibility,l)+(i.offsetY??0),v=m.visibilityToY("string"==typeof n.visibility?parseFloat(n.visibility):n.visibility,l)+(n.offsetY??0),g=(u+x)/2,f=(y+v)/2,b=iW(u,y,x,v);return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(iO,{id:`modern_link_${i.id}_${n.id}`,x1:u,x2:x,y1:y,y2:v,flow:p,evolved:d,styles:e.link}),o.flowValue&&(0,eU.jsx)(i$,{mapStyleDefs:e,startElement:i,endElement:n,link:o,x:x,y:v,scaleFactor:s}),a&&o.context&&(0,eU.jsx)("text",{className:"link-context",fontSize:e.link?.contextFontSize??"10px",textAnchor:"middle",x:g,y:f-5,transform:`rotate(${b>90||b<-90?b+180:b} ${g} ${f})`,children:o.context})]})},iI=({maturity:e,visibility:t,mapDimensions:i})=>{let n=new im,o=n.maturityToX(e,i.width),s=n.visibilityToY("string"==typeof t?parseFloat(t):t,i.height);return(0,eU.jsx)(eK,{x:o,y:s})},iP=(e,{mapDimensions:t,evolutionOffsets:i,startElement:n,endElement:o})=>{let s=t.width/20,a=[i.custom,i.product,i.commodity];for(let i=0;i<a.length;i++){let l=parseFloat(e.xToMaturity(s*a[i],t.width));if((n.maturity??0)<=l&&(o.maturity??0)>=l)return l}return(n.maturity??0)+.05},iz=({startElement:e,endElement:t,mapDimensions:i,evolutionOffsets:n,mapStyleDefs:o})=>{let s;if(!e||!t)return null;let{height:a,width:l}=i,r=new ih,m=r.maturityToX(e.maturity??0,l),p=r.maturityToX(t.maturity??0,l),d=r.visibilityToY("string"==typeof e.visibility?parseFloat(e.visibility):e.visibility,a)+(e.offsetY??0),c=r.visibilityToY("string"==typeof t.visibility?parseFloat(t.visibility):t.visibility,a)+(t.offsetY??0);return e.inertia&&(s=iP(r,{mapDimensions:i,evolutionOffsets:n,startElement:e,endElement:t})||m),(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(iO,{id:`modern_evolving_link_${e.id}_${t.id}`,x1:m,y1:d,x2:p,y2:c,strokeDasharray:"5 5",marker:"url(#arrow)",isMarkerStart:!1,styles:o.link,evolved:!0}),t.inertia&&void 0!==s&&(0,eU.jsx)(iI,{maturity:s,visibility:t.visibility,mapDimensions:i})]})},iH=({mapStyleDefs:e,mapDimensions:t,startElement:i,origClick:n,scaleFactor:o=1})=>{let{height:s,width:a}=t,r=new ih,m=i.maturity??i.evolveMaturity??0,p=r.maturityToX(m,a),d=r.visibilityToY("string"==typeof i.visibility?parseFloat(i.visibility):i.visibility,s)+(i.offsetY??0),[c,h]=(0,l.useState)({x:p,y:d,coords:{}}),u=(0,l.useCallback)(e=>{h(t=>{let i=(t.coords.x-e.pageX)/o,n=(t.coords.y-e.pageY)/o;return{x:t.x-i,y:t.y-n,coords:{x:e.pageX,y:e.pageY}}})},[o]);return(0,l.useEffect)(()=>{let e=n.nativeEvent.pageX,t=n.nativeEvent.pageY;return h(i=>Object.assign({},i,{coords:{x:e,y:t}})),document.addEventListener("mousemove",u),function(){document.removeEventListener("mousemove",u)}},[n,u]),(0,eU.jsx)(iO,{id:`modern_link_${i.id}_fluid`,x1:p,x2:c.x,y1:d,y2:c.y,flow:!1,evolved:!1,styles:e.fluidLink,filter:"url(#ctrlHighlight)",strokeDasharray:e.fluidLink?.strokeDasharray})};class iY{constructor(e,t,i,n){this.type=e,this.mapText=t,this.mutator=i,this.replacers=n}setSuccessor(e){throw Error("Method not implemented.")}update(e,t){let i=this.mapText.split("\n").map(i=>{for(let n=0;n<this.replacers.length;n++){let o=this.replacers[n];if(o.matcher(i,t,this.type))return o.action(i,e)}return i}).join("\n");this.mutator(i)}}let iR={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>{let i="number"==typeof t.param1?t.param1.toString():parseFloat(t.param1).toString(),n="number"==typeof t.param2?t.param2.toString():parseFloat(t.param2).toString();return e.replace(/\[([^[\]]+)\]/g,`[${i}, ${n}]`)}},iB={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>`${e.trim()} [${t.param1}, ${t.param2}]`},iU=({element:e,mapDimensions:t,mapText:i,mutateMapText:n,children:o,scaleFactor:s})=>{let a=new im,l=a.maturityToX(e.maturity,t.width),r=a.visibilityToY(e.visibility,t.height)+(e.offsetY?e.offsetY:0),m=new iY("deaccelerator"===e.type?"deaccelerator":"accelerator",i,n,[iB,iR]);return(0,eU.jsx)(ix,{id:"accelerator_element_"+e.id,onMove:i=>{let n=a.yToVisibility(i.y,t.height),o=a.xToMaturity(i.x,t.width);m.update({param1:n,param2:o},e.name)},x:l,y:r,fixedY:e.evolved,fixedX:!1,shouldShowMoving:!1,isModKeyPressed:!1,scaleFactor:s,children:(0,eU.jsx)(eU.Fragment,{children:o})})};var iX=i(6047);let iV=(e,t,i,n,o)=>{if(i!==t&&i.length>0){let s=n.split("\n"),a=s[e-1];s[e-1]=a.replace(t,i);for(let e=0;e<s.length;e++){let n=s[e].trim();if(n.includes("->")&&2===n.split("->").length){let o=n.split("->"),a=o[0].trim(),l=o[1].trim();if(a===t&&(s[e]=[i,l].join("->")),l===t&&(s[e]=[a,i].join("->")),l.includes(";")&&l.split(";")[0].trim()===t){let t=l.split(";")[1].trim();s[e]=[a,`${i};${t}`].join("->")}}["pipeline","build","buy","outsource"].forEach(o=>{n.startsWith(o)&&n.split(o).length>1&&n.split(o)[1].trim()===t&&(s[e]=`${o} ${n.split(o)[1].trim().replace(t,i)}`)}),["evolve"].forEach(o=>{if(n.startsWith(o)&&n.split(o).length>1){n.split(o)[1].trim().split(" ")[0].trim()===t&&(s[e]=`${o} ${n.split(o)[1].trim().replace(t,i)}`);let a=n.split(o)[1].trim().split(" ")[0].trim();a.includes(t)&&a.includes("->")&&(s[e]=`${o} ${n.split(o)[1].trim().replace(t,i)}`)}})}o(s.join("\n"))}},iG=({component:e,cx:t,cy:i,styles:n,mutateMapText:o,mapText:s,onLabelMove:a,scaleFactor:r=1,mapStyleDefs:m,onClick:p,id:d,element:c})=>{let{enableDoubleClickRename:h}=(0,eR.YY)(),[u,x]=(0,l.useState)(!1),y=c?{name:c.name}:e,[v,g]=(0,l.useState)(y.name),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{g(y.name)},[y.name]),(0,l.useEffect)(()=>{u&&f.current&&(f.current.focus(),f.current.select())},[u]);let b=()=>e.label?.x||0,k=()=>e.label?.y||0,w=e.evolved?n.evolvedText:n.text,j=n?.fontSize||"14px";return(0,eU.jsx)(eU.Fragment,{children:u?(0,eU.jsx)("foreignObject",{x:Number(t)+b()-50,y:Number(i)+k()-25,width:"100",height:"50",style:{overflow:"visible"},children:(0,eU.jsx)(iX.A,{ref:f,value:v,onChange:e=>{g(e.target.value)},onBlur:()=>{x(!1),o&&s&&v!==e.name&&e.line&&iV(e.line,e.name,v,s,o)},onKeyDown:t=>{"Enter"===t.key&&(t.preventDefault(),x(!1),o&&s&&v!==e.name&&e.line&&iV(e.line,e.name,v,s,o))},style:{width:"100%",resize:"none",fontFamily:"Arial",fontSize:j,border:"1px solid #ccc",padding:"2px"}})}):(0,eU.jsx)(iF,{id:`${e.id}-text-movable`,x:b(),y:k(),scaleFactor:r,onMove:function(t){if(a)return void a(e.pipeline?{x:Math.round(t.x),y:Math.round(t.y)}:t);if(!o||!s||!e.line)return void console.warn("Cannot update label position: missing required props");let i=(e,t)=>` label [${e.toFixed(2)}, ${t.toFixed(2)}]`,n=(n,o)=>{let s="evolve"+e.name.replace(/\s/g,"")+(e.override?.length&&e.override.length>0?"->"+e.override.replace(/\s/g,""):"")+(e.maturity||"");return 0===o.indexOf(s)?o.indexOf("label[")>-1?n.replace(/\slabel\s\[([^[\]]+)\]/g,i(t.x,t.y)):n.trim()+i(t.x,t.y):n},l=(n,o)=>{let s=(e.type||"")+e.name.replace(/\s/g,"");return 0===o.indexOf(s+"[")?o.indexOf("label[")>-1?n.replace(/\slabel\s\[([^[\]]+)\]/g,i(t.x,t.y)):n.trim()+i(t.x,t.y):n};o(s.split("\n").map(t=>{let i=t.replace(/\s/g,"");return e.evolved?n(t,i):l(t,i)}).join("\n"))},children:(0,eU.jsx)(eV,{id:`${e.id}-text`,text:e.name,textTheme:{fontSize:j,fontWeight:"normal",evolvedTextColor:w,textColor:w},onClick:()=>{p?p():h&&s&&x(!0)},setShowTextField:h&&s?x:void 0})})})},iK=({launchUrl:e,mapDimensions:t,component:i,mapText:n,mutateMapText:o,mapStyleDefs:s,setHighlightLine:a,scaleFactor:l,children:r})=>{let m=(0,eB.VH)(),p=new ih,d=p.maturityToX(i.maturity,t.width),c=p.visibilityToY(i.visibility,t.height)+(i.offsetY?i.offsetY:0);return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(ix,{id:`element_${i.id}`,x:d,y:c,onMove:e=>{if(void 0===i.line)return;let s=new ih,a=parseFloat(s.xToMaturity(e.x,t.width)),l=parseFloat(s.yToVisibility(e.y,t.height)),r=n.split("\n");if(i.evolved)return void o(r.map(e=>{let t=e.replace(/\s/g,""),n=i.name.replace(/\s/g,"");return 0===t.indexOf(`evolve${n}`)?e.replace(/\s([0-9]?\.[0-9]+[0-9]?)+/g,` ${a.toFixed(2)}`):e}).join("\n"));o(r.map((e,t)=>{if(t+1===i.line&&RegExp(`component\\s+${i.name}\\b`,"i").test(e))if(!e.includes("label"))return e.replace(/\[([^[\]]+)\]/,`[${l.toFixed(2)}, ${a.toFixed(2)}]`);else{let t=e.split(/\blabel\b/);return t[0].replace(/\[([^[\]]+)\]/,`[${l.toFixed(2)}, ${a.toFixed(2)}]`)+"label"+t[1]}return e}).join("\n"))},fixedY:i.evolved,fixedX:!1,shouldShowMoving:!0,isModKeyPressed:!i.evolved&&m,scaleFactor:l,children:(0,eU.jsx)("g",{id:i.id,onClick:t=>{t.preventDefault(),t.stopPropagation(),i.line&&a(i.line),i.url&&e&&("string"==typeof i.url?e(i.url):i.url.url&&e(i.url.url))},style:{cursor:"pointer"},children:r})}),i.inertia&&!i.evolved&&!1===i.evolving&&(0,eU.jsx)(iI,{maturity:i.maturity+.02,visibility:i.visibility,mapDimensions:t}),(0,eU.jsx)("g",{transform:`translate(${d},${c})`,children:(0,eU.jsx)(iG,{component:i,cx:0,cy:0,styles:s?.component,id:`component_text_${i.id}`,element:{id:i.id,name:i.name,type:i.type,line:i.line,evolved:i.evolved,evolving:i.evolving,override:i.override,maturity:i.maturity,label:i.label},mapStyleDefs:s,scaleFactor:l,mapText:n,mutateMapText:o,onClick:()=>{i.line&&a(i.line)}})})]})},iZ=(0,l.memo)(({id:e,y:t,x1:i,x2:n,stroke:o,styles:s={}})=>{let a=o||s.stroke||"black",l=s.pipelineStrokeWidth||1;return(0,eU.jsxs)("g",{id:e,transform:`translate(${i},${t})`,children:[(0,eU.jsx)("line",{x1:0,y1:0,x2:n-i,y2:0,strokeWidth:l,stroke:a}),(0,eU.jsx)("line",{x1:n-i,y1:0,x2:n-i,y2:22,strokeWidth:l,stroke:a}),(0,eU.jsx)("line",{x1:n-i,y1:22,x2:0,y2:22,strokeWidth:l,stroke:a}),(0,eU.jsx)("line",{x1:0,y1:22,x2:0,y2:0,strokeWidth:l,stroke:a})]})}),iq=l.memo(function(e){let t=new im,i=new iY("pipeline",e.mapText,e.mutateMapText,[iR,iB]),n=t.maturityToX(e.pipeline.maturity1||0,e.mapDimensions.width),o=t.maturityToX(e.pipeline.maturity2||0,e.mapDimensions.width),s=t.visibilityToY(e.pipeline.visibility,e.mapDimensions.height)+2,a=s+11;return isNaN(n)||isNaN(o)||isNaN(s)||n===o?(console.warn(`Pipeline ${e.pipeline.name} has invalid coordinates: x1=${n}, x2=${o}, y=${s}`),(0,eU.jsx)(eU.Fragment,{})):(console.log(`Pipeline ${e.pipeline.name} box: x1=${n}, x2=${o}, y=${s}`),(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(iZ,{id:"pipeline_box_"+e.pipeline.id,y:s,x1:n-15,x2:o+15,styles:e.mapStyleDefs.component,stroke:e.mapStyleDefs.component.stroke}),(0,eU.jsx)(ix,{id:"pipeline_x1_"+e.pipeline.id,onMove:function(n){i.update({param1:t.xToMaturity(n.x,e.mapDimensions.width),param2:e.pipeline.maturity2||0},e.pipeline.name)},x:n,y:a,fixedY:!0,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,eU.jsx)(eX,{id:"pipeline_circle_x1_"+e.pipeline.id,styles:e.mapStyleDefs.component,component:{id:`pipeline_circle_x1_${e.pipeline.id}`,name:e.pipeline.name,maturity:e.pipeline.maturity1||0,visibility:e.pipeline.visibility,line:e.pipeline.line,label:{x:0,y:0}},onClick:()=>e.setHighlightLine(e.pipeline.line)})}),(0,eU.jsx)(ix,{id:"pipeline_x2_"+e.pipeline.id,onMove:function(n){i.update({param1:e.pipeline.maturity1||0,param2:t.xToMaturity(n.x,e.mapDimensions.width)},e.pipeline.name)},x:o,y:a,fixedY:!0,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,eU.jsx)(eX,{id:"pipeline_circle_x2_"+e.pipeline.id,styles:e.mapStyleDefs.component,component:{id:`pipeline_circle_x2_${e.pipeline.id}`,name:e.pipeline.name,maturity:e.pipeline.maturity2||0,visibility:e.pipeline.visibility,line:e.pipeline.line,label:{x:0,y:0}},onClick:()=>e.setHighlightLine(e.pipeline.line)})})]}))}),iQ={matcher:(e,t,i)=>-1!==e.replace(/\s/g,"").indexOf(i+t.replace(/\s/g,"")+"["),action:(e,t)=>e.replace(/\[([^[\]]+)\]/g,`[${parseFloat(t.param1.toString()).toFixed(2)}]`)},iJ={matcher:(e,t,i)=>e.replace(/\s/g,"")===i+t.replace(/\s/g,""),action:(e,t)=>`${e.trim()} [${parseFloat(t.param1.toString()).toFixed(2)}]`},i0=l.memo(function(e){let t=new im,i=(0,eB.VH)(),n=new iY("component",e.mapText,e.mutateMapText,[{matcher:(e,t,i)=>iQ.matcher(e,t,i)&&!iQ.matcher(e,"","label"),action:(e,t)=>iQ.action(e,t)},{matcher:(e,t,i)=>iQ.matcher(e,t,i)&&iQ.matcher(e,"","label"),action:(e,t)=>{let i=e.split("label");return iQ.action(i[0],t)+"label"+i[1]}},iJ]),o=e.pipeline.components.filter(e=>""!==e.name).map(i=>{let n=t.maturityToX(i.maturity,e.mapDimensions.width);return{pipelineComponent:i,x:n,y:t.visibilityToY(e.pipeline.visibility,e.mapDimensions.height)+11}}).sort((e,t)=>e.x-t.x),s=o.map((o,s)=>{let a={id:o.pipelineComponent.id||`pipeline_comp_${s}`,name:o.pipelineComponent.name,type:"component",maturity:o.pipelineComponent.maturity,visibility:e.pipeline.visibility,line:o.pipelineComponent.line,label:o.pipelineComponent.label||{x:0,y:0},pipeline:!0};return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(ix,{id:`pipeline_v2_${o.pipelineComponent.name}_${s}`,onMove:i=>(function(i,o){let s=t.xToMaturity(o.x,e.mapDimensions.width);n.update({param1:s},i.name)})(o.pipelineComponent,i),x:o.x,y:o.y,fixedY:!0,fixedX:!1,scaleFactor:e.scaleFactor,children:(0,eU.jsx)(eX,{id:`pipeline_v2_circle_${e.pipeline.id}_${s}`,styles:e.mapStyleDefs.component,component:a,onClick:t=>{if(i)return void e.linkingFunction({el:a,e:t});e.setHighlightLine(o.pipelineComponent.line)}})},s),o.pipelineComponent.label&&(0,eU.jsx)("g",{transform:`translate(${o.x},${o.y})`,children:(0,eU.jsx)(iG,{component:a,cx:0,cy:0,styles:e.mapStyleDefs.component,mapText:e.mapText,mutateMapText:e.mutateMapText,onLabelMove:t=>(function(t,i){let n=Math.round(i.x),o=Math.round(i.y);e.mutateMapText(e.mapText.split("\n").map(e=>RegExp(`component\\s+${t.name.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\\b`,"i").test(e)?(console.log("Found line to update:",e),e.includes("label"))?e.replace(/\slabel\s\[([^[\]]+)\]/g,` label [${n}, ${o}]`):e+` label [${n}, ${o}]`:e).join("\n"))})(o.pipelineComponent,t),scaleFactor:e.scaleFactor})})]})});if(0===o.length)return(0,eU.jsx)(eU.Fragment,{});let a=o.length>0?o[0].x:t.maturityToX(0,e.mapDimensions.width),l=o.length>0?o[o.length-1].x:t.maturityToX(0,e.mapDimensions.width),r=t.visibilityToY(e.pipeline.visibility,e.mapDimensions.height);return isNaN(a)||isNaN(l)||isNaN(r)||a===l?(0,eU.jsx)(eU.Fragment,{}):(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(iZ,{id:`pipeline_v2_box_${e.pipeline.id}`,y:r,x1:a-15,x2:l+15,styles:e.mapStyleDefs.component,stroke:e.mapStyleDefs.component.stroke}),s]})}),i1=l.memo(({mapDimensions:e,mapText:t,mutateMapText:i,mapStyleDefs:n,setHighlightLine:o,mapElements:s,pipelines:a,enableNewPipelines:r=!0,scaleFactor:m=1,clicked:p})=>{let d=e=>{void 0!==e&&o(e)},c=a||s.getPipelineComponents();if(0===c.length)return;console.log(`Rendering ${c.length} pipelines:`,c.map(e=>({name:e.name,visibility:e.visibility,components:e.components?.length||0})));let h=p?e=>{p({el:{...e.el,visibility:e.el.visibility||0},e:e.e})}:void 0;return(0,eU.jsx)("g",{id:"pipelines",children:r&&c.filter(e=>!0!==e.hidden).map((o,s)=>(0,eU.jsx)(l.Fragment,{children:o.components&&o.components.length>0?(0,eU.jsx)(i0,{mapDimensions:e,pipeline:o,mapText:t,mutateMapText:i,mapStyleDefs:n,setHighlightLine:d,linkingFunction:h||(()=>{}),scaleFactor:m},"pipeline_"+s):(0,eU.jsx)(iq,{mapDimensions:e,pipeline:o,mapText:t,mutateMapText:i,mapStyleDefs:n,setHighlightLine:d,scaleFactor:m},s)},s))})}),i2=({methodComponent:e,mapDimensions:t,mapStyleDefs:i,setHighlightLine:n})=>{let o=new ih,s=o.maturityToX(e.maturity,t.width),a=o.visibilityToY(e.visibility,t.height);return(0,eU.jsx)(e0,{id:`method_${e.id}`,x:s,y:a,buy:e.decorators.buy||!1,build:e.decorators.build||!1,outsource:e.decorators.outsource||!1,styles:i.methods,onClick:()=>{n&&e.line&&n(e.line)}})},i5=({note:e,mapDimensions:t,mapText:i,mutateMapText:n,mapStyleDefs:o,setHighlightLine:s,scaleFactor:a})=>{let l=new ih,r=new iL("note",i,n,[iv,iB]);return(0,eU.jsx)(ix,{id:`modern_note_${e.id}`,onMove:function(i){let n=l.yToVisibility(i.y,t.height),o=l.xToMaturity(i.x,t.width);r.update({param1:parseFloat(n),param2:parseFloat(o)},e.text,e.line)},x:l.maturityToX(e.maturity,t.width),y:l.visibilityToY(e.visibility,t.height),fixedY:!1,fixedX:!1,scaleFactor:a,children:(0,eU.jsx)(eV,{id:`modern_note_text_${e.id}`,note:e.text,textTheme:o?.note,onClick:()=>s(e.line)})})},i9=e=>{let{mapDimensions:t,mapStyleDefs:i,mapText:n,mutateMapText:o,scaleFactor:s,mapElements:a,setHighlightLine:r,clicked:m,enableAccelerators:p,launchUrl:d}=e,c=e=>{"function"==typeof e?r(e(0)):r(e)},h=a.getAllComponents().filter(e=>"anchor"===e.type),u=(e,t)=>e.find(e=>e.name===t),x=e=>e;return(0,eU.jsxs)("g",{id:"mapContent",children:[(0,eU.jsx)("g",{id:"attitudes",children:e.mapAttitudes&&e.mapAttitudes.map((e,a)=>(0,eU.jsx)(iD,{attitude:e,mapDimensions:t,mapText:n,mutateMapText:o,mapStyleDefs:i,scaleFactor:s},a))}),(0,eU.jsx)("g",{id:"links",children:e.links.map(e=>(0,eU.jsx)("g",{id:e.name,children:e.links.map((e,n)=>(0,eU.jsx)(i_,{mapStyleDefs:i,mapDimensions:t,startElement:e.startElement,endElement:e.endElement,link:e.link,scaleFactor:s},n))},e.name))}),(0,eU.jsx)("g",{id:"evolvedLinks",children:a.getEvolvingComponents().map((n,o)=>u(a.getEvolvingComponents(),n.name)&&(0,eU.jsx)(iz,{mapStyleDefs:i,mapDimensions:t,endElement:(()=>{let e=u(a.getEvolvedComponents(),n.name);return e?x(e):void 0})(),startElement:(()=>{let e=u(a.getEvolvingComponents(),n.name);return e?x(e):void 0})(),evolutionOffsets:e.evolutionOffsets||{commodity:0,product:0,custom:0}},o))}),(0,eU.jsx)("g",{id:"anchors",children:h.map((e,s)=>(0,eU.jsx)(ib,{mapDimensions:t,anchor:e,mapText:n,mutateMapText:o,mapStyleDefs:i,onClick:()=>r(e.line||0)},s))}),(0,eU.jsx)("g",{id:"fluidLinks",children:e.mapElementsClicked&&e.mapElementsClicked.map((e,n)=>(0,eU.jsx)(iH,{mapStyleDefs:i,mapDimensions:t,startElement:x(e.el),origClick:e.e,scaleFactor:s},`fluid-${n}`))}),(0,eU.jsx)("g",{id:"accelerators",children:p&&e.mapAccelerators&&e.mapAccelerators.map((e,i)=>(0,eU.jsx)(iU,{element:e,mapDimensions:t,mapText:n,mutateMapText:o,scaleFactor:s,children:(0,eU.jsx)(ip,{id:"accelerator_circle_"+e.id,component:e,onClick:()=>m({el:x(e),e:null})})},i))}),e.mapAnnotations&&e.mapAnnotations.length>0&&(0,eU.jsx)(iE,{mapStyleDefs:i,mutateMapText:o,mapText:n,annotations:e.mapAnnotations,position:e.mapAnnotationsPresentation,mapDimensions:t,scaleFactor:s,setHighlightLine:c}),(0,eU.jsx)(i1,{enableNewPipelines:e.enableNewPipelines||!1,mapElements:a,mapDimensions:t,mapText:n,mutateMapText:o,mapStyleDefs:i,setHighlightLine:c,clicked:m,scaleFactor:s}),(0,eU.jsx)("g",{id:"methods",children:a.getMergedComponents().filter(e=>!!e.decorators&&(e.decorators.buy||e.decorators.build||e.decorators.outsource)).map((e,n)=>(0,eU.jsx)(i2,{methodComponent:e,mapDimensions:t,mapStyleDefs:i,setHighlightLine:c},`method_${n}`))}),(0,eU.jsx)("g",{id:"elements",children:a.getMergedComponents().filter(e=>"anchor"!==e.type).map((e,a)=>(0,eU.jsxs)(iK,{launchUrl:d,mapDimensions:t,component:x(e),mapText:n,mutateMapText:o,mapStyleDefs:i,setHighlightLine:c,scaleFactor:s,children:["component"===e.type&&!e.pipeline&&(0,eU.jsx)(eX,{id:`element_circle_${e.id}`,styles:i.component,component:e,onClick:t=>m({el:x(e),e:t})}),e.pipeline&&(0,eU.jsx)(id,{id:`element_square_${e.id}`,styles:i.component,component:e,onClick:t=>m({el:x(e),e:t})}),(e.decorators?.ecosystem||"ecosystem"===e.type)&&(0,eU.jsx)(eG,{id:`ecosystem_circle_${e.id}`,styles:i.component,component:e,onClick:t=>m({el:x(e),e:t})}),(e.decorators?.market||"market"===e.type)&&(0,eU.jsx)(eJ,{id:`market_circle_${e.id}`,styles:i.component,component:e,onClick:t=>m({el:x(e),e:t})}),"submap"===e.type&&(0,eU.jsx)(ic,{styles:i.component,component:e,onClick:t=>m({el:x(e),e:t}),launchUrl:e.url&&"object"==typeof e.url&&"url"in e.url&&e.url.url?()=>d?.(e.url.url):void 0})]},a))}),(0,eU.jsx)("g",{id:"notes",children:e.mapNotes.map((e,a)=>(0,eU.jsx)(i5,{mapDimensions:t,note:e,mapText:n,mutateMapText:o,mapStyleDefs:i,scaleFactor:s,setHighlightLine:c},a))}),(0,eU.jsx)("g",{id:"annotations",children:e.mapAnnotations&&e.mapAnnotations.map((e,a)=>(0,eU.jsx)(l.Fragment,{children:e.occurances?.map((l,r)=>(0,eU.jsx)(iS,{mapStyleDefs:i,occurance:l,annotation:e,occuranceIndex:r,mapDimensions:t,mutateMapText:o,mapText:n,scaleFactor:s},"mapAnnotation_"+a+"_"+r))},a))})]})},i3=function(e){let{enableAccelerators:t,showMapToolbar:i,allowMapZoomMouseWheel:n}=(0,eR.YY)(),{wardleyMap:o,mapText:s,mutateMapText:a,setHighlightLine:r,setNewComponentContext:m,showLinkedEvolved:p,launchUrl:d,mapDimensions:c,mapCanvasDimensions:h,mapStyleDefs:u,evolutionOffsets:x,mapEvolutionStates:y,mapAnnotationsPresentation:v}=e,g=(0,eB.VH)(),f=(0,l.useRef)(null),b=(0,l.useMemo)(()=>new tz(o),[o]),k=(0,l.useMemo)(()=>{var e;return e=o.links.map(e=>({start:e.start,end:e.end,line:e.line??0,flow:e.flow??!1,flowValue:e.flowValue??"",future:e.future??!1,past:e.past??!1,context:e.context??""})),new tJ(e,b,o.anchors.map(e=>({...e,line:e.line??0,evolved:e.evolved??!1,inertia:e.inertia??!1,increaseLabelSpacing:e.increaseLabelSpacing??0,pseudoComponent:e.pseudoComponent??!1,offsetY:e.offsetY??0,evolving:e.evolving??!1,decorators:e.decorators??{buy:!1,build:!1,outsource:!1,ecosystem:!1,market:!1}})),p).build().map(e=>({name:e.name,links:e.links.filter(e=>e.startElement&&e.endElement)}))},[o.links,b,o.anchors,p]),[w]=(0,l.useState)(!0),[j,E]=(0,l.useState)(tP.qD),[C,S]=(0,l.useState)(1),[A,T]=(0,l.useState)({version:2,mode:tP.qD,focus:!1,a:1,b:0,c:0,d:1,e:0,f:0,viewerWidth:h.width,viewerHeight:h.height,SVGWidth:c.width+105,SVGHeight:c.height+137,miniatureOpen:!1}),[L,M]=(0,l.useState)([]);(0,l.useEffect)(()=>{!g&&L.length>0&&M([])},[g,L]),(0,l.useEffect)(()=>{if(f.current){let e=f.current;e&&e.setState&&e.setState(A)}},[A]),(0,l.useEffect)(()=>{if(c.width>0&&c.height>0){console.log("Initial fit effect triggered",{width:c.width,height:c.height,components:o.components.length});let e=()=>{if(console.log("performDelayedFit called"),f.current&&f.current.fitSelection){let t=document.getElementById("map"),i=t?.querySelectorAll("circle, rect");console.log("Checking rendered components:",i?.length),i&&i.length>0?(console.log("Components found, scheduling fit"),setTimeout(()=>{f.current&&f.current.fitSelection&&(console.log("EXECUTING INITIAL FIT TO SELECTION"),f.current.fitSelection(-60,-70,c.width+80,c.height+90))},1500)):(console.log("Components not rendered yet, retrying..."),setTimeout(e,300))}else console.log("Viewer.current or fitSelection not available")},t=setTimeout(e,800);return()=>clearTimeout(t)}console.log("Initial fit conditions not met",{width:c.width,height:c.height,components:o.components.length})},[c.width,c.height]);let D="wardley"===u.className?"white":({wardley:"url(#wardleyGradient)",colour:"white",plain:"white",handwritten:"white",dark:"#353347"})[u.className]||"white";return(0,eU.jsxs)("div",{id:"map-canvas",style:{width:"100%",height:"100%",position:"relative"},children:[(0,eU.jsx)(tP.fP,{ref:f,SVGBackground:D,background:"white",tool:j,width:h.width||window.innerWidth-100,height:h.height||window.innerHeight-200,detectAutoPan:!1,detectWheel:n,miniatureProps:{position:"none",background:"#eee",width:200,height:200},toolbarProps:{position:"none"},preventPanOutside:!1,onClick:t=>{if(w&&e.handleMapCanvasClick){let i={x:t.x||0,y:t.y||0};e.handleMapCanvasClick(i)}},onDoubleClick:e=>{if(w){let t={x:e.x||0,y:e.y||0},i=new im,n=parseFloat(i.xToMaturity(t.x,c.width)),o=parseFloat(i.yToVisibility(t.y,c.height));console.log("Double-click coordinates:",{svgX:t.x,svgY:t.y,maturity:n,visibility:o}),m({x:n.toFixed(2),y:o.toFixed(2)})}},onMouseMove:()=>{},onZoom:e=>{T(e),S(e.a)},scaleFactorOnWheel:n?1.1:1,style:{userSelect:"none",fontFamily:u.fontFamily,width:"100%",height:"100%",display:"block"},children:(0,eU.jsxs)("svg",{className:[u.className,"mapCanvas"].join(" "),width:c.width+105,height:c.height+137,viewBox:`-35 -45 ${c.width+105} ${c.height+137}`,id:"svgMap",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,eU.jsx)(ir,{mapDimensions:c,mapStyleDefs:u,mapEvolutionStates:y,evolutionOffsets:x,mapTitle:o.title}),(0,eU.jsx)(i9,{mapElements:b,mapDimensions:c,mapStyleDefs:u,launchUrl:d,mapAttitudes:o.attitudes,mapText:s,mutateMapText:a,scaleFactor:C,mapElementsClicked:L,links:k,evolutionOffsets:x,enableNewPipelines:!0,setHighlightLine:r,clicked:function(e){if(console.log("mapElementsClicked::clicked",e),r(e.el.line||0),!1===g||null===e.e)return;let t=[...L,{el:e.el,e:e.e}];2===t.length?(a(s+"\r\n"+t.map(e=>e.el.name).join("->")),M([])):M(t)},enableAccelerators:t,mapAccelerators:o.accelerators.map(e=>({...e,type:e.deaccelerator?"deaccelerator":"accelerator",label:e.label||{x:0,y:0}})),mapNotes:o.notes,mapAnnotations:o.annotations,mapAnnotationsPresentation:v,mapMethods:o.methods})]})}),i&&(0,eU.jsx)("div",{style:{position:"absolute",bottom:"20px",left:"20px",zIndex:1e3,backgroundColor:"rgba(255, 255, 255, 0.95)",borderRadius:"8px",padding:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",border:"1px solid rgba(0,0,0,0.1)"},children:(0,eU.jsx)(t7,{shouldHideNav:e.shouldHideNav||(()=>{}),hideNav:e.hideNav||!1,tool:j,handleChangeTool:(e,t)=>E(t),_fitToViewer:()=>{f.current&&f.current.fitSelection&&f.current.fitSelection(-60,-70,c.width+80,c.height+90)}})})]})},i4=e=>{let t=(0,eR.YY)(),[i,n]=(0,l.useState)(()=>()=>console.log("nullTemplate")),[o,s]=(0,l.useState)(!1),a={backgroundColor:{wardley:"url(#wardleyGradient)",colour:"none",plain:"none",handwritten:"none",dark:"#353347"}[e.mapStyleDefs.className],position:"relative",width:"100%",height:"100%",overflow:"hidden"},r=e.mapRef;return(0,eU.jsxs)("div",{ref:r,className:e.mapStyleDefs.className,style:a,children:[t.enableQuickAdd&&(0,eU.jsx)(tI,{setQuickAdd:e=>{s(!0),function(e,t,i){console.log(e),btoa(`<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="15px" height="15px">${e}</svg>`)}(tO.renderToString(e.cursor),0,0),n(()=>()=>e.template)},mapStyleDefs:e.mapStyleDefs}),(0,eU.jsx)("div",{id:"map",style:{width:"100%",height:"100%",overflow:"hidden",position:"relative"},children:(0,eU.jsx)(i3,{wardleyMap:e.wardleyMap,mapDimensions:e.mapDimensions,mapCanvasDimensions:e.mapCanvasDimensions,mapStyleDefs:e.mapStyleDefs,mapEvolutionStates:e.mapEvolutionStates,evolutionOffsets:e.evolutionOffsets,mapText:e.mapText,mutateMapText:e.mutateMapText,setHighlightLine:e.setHighlightLine,setNewComponentContext:e.setNewComponentContext,launchUrl:e.launchUrl,showLinkedEvolved:e.showLinkedEvolved,shouldHideNav:e.shouldHideNav,hideNav:e.hideNav,mapAnnotationsPresentation:e.mapAnnotationsPresentation,handleMapCanvasClick:()=>{!1!=t.enableQuickAdd&&o&&(i(),s(!1))}})})]})};var i8=i(6842),i6=i(3346),i7=i(3803),ne=i(6512),nt=i(7416),ni=i(5201),nn=i(8639),no=i(6409),ns=i(5551),na=i(873),nl=i(7071),nr=i(4067),nm=i(7843);let np=({menuVisible:e,toggleMenu:t,submenu:i,toggleTheme:n,isLightTheme:o})=>{let{enableDashboard:s}=(0,eR.YY)(),{t:r,currentLanguage:p,changeLanguage:d,supportedLanguages:c}=(0,eL.s)(),[h,u]=(0,l.useState)(null),x={push:e=>{a().push({pathname:e})}},y=()=>e=>{("keydown"!==e.type||"Tab"!==e.key&&"Shift"!==e.key)&&t()},v=e=>{t(),e&&e()},g=async e=>{await d(e),u(null),t()},f=(0,l.useMemo)(()=>[{name:r("navigation.dashboard","Dashboard"),icon:(0,eU.jsx)(i7.A,{}),action:()=>v(()=>x.push("/dashboard")),visible:s},{name:r("navigation.editor","Editor"),icon:(0,eU.jsx)(ni.A,{}),action:()=>v(()=>x.push("/")),visible:!0},{name:r("navigation.classicVersion","Use Classic Version"),icon:(0,eU.jsx)(ni.A,{}),action:()=>v(()=>x.push("https://classic.onlinewardleymaps.com")),visible:!0}],[r,s]),b=(0,l.useMemo)(()=>o?r("navigation.enableDarkTheme","Enable Dark Theme"):r("navigation.enableLightTheme","Enable Light Theme"),[r,o]),k=(0,eU.jsxs)(m.A,{sx:{width:"285px"},role:"presentation",onClick:()=>y(),onKeyDown:()=>y(),children:[(0,eU.jsx)(na.A,{children:f.filter(e=>!0===e.visible).map(e=>(0,eU.jsxs)(nn.A,{onClick:e.action,children:[(0,eU.jsx)(nl.A,{children:e.icon}),(0,eU.jsx)(nr.A,{primary:e.name})]},e.name))}),(0,eU.jsx)(no.A,{}),(0,eU.jsx)(na.A,{children:i&&i.map(e=>(0,eU.jsxs)(nn.A,{onClick:()=>v(()=>e.action()),children:[(0,eU.jsx)(nl.A,{children:e.icon}),(0,eU.jsx)(nr.A,{primary:e.name})]},e.name))}),(0,eU.jsx)(no.A,{}),(0,eU.jsxs)(na.A,{children:[(0,eU.jsxs)(nn.A,{onClick:()=>v(()=>n()),children:[(0,eU.jsx)(nl.A,{children:o?(0,eU.jsx)(i6.A,{}):(0,eU.jsx)(nt.A,{})}),(0,eU.jsx)(nr.A,{primary:b})]},"toggleTheme"),(0,eU.jsxs)(nn.A,{onClick:e=>{u(e.currentTarget)},children:[(0,eU.jsx)(nl.A,{children:(0,eU.jsx)(ne.A,{})}),(0,eU.jsx)(nr.A,{primary:r("navigation.language","Language")}),(0,eU.jsx)(i8.A,{})]},"language")]})]}),w=(0,eU.jsx)(nm.A,{anchorEl:h,open:!!h,onClose:()=>{u(null)},anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"left"},children:c.map(e=>(0,eU.jsx)(tr.A,{onClick:()=>g(e.code),selected:p===e.code,children:e.nativeName},e.code))});return(0,eU.jsxs)("div",{children:[(0,eU.jsx)(ns.Ay,{anchor:"left",open:e,onClose:t,children:k}),w]},`navigation-${p}`)};var nd=i(9447),nc=i(89),nh=i(2181),nu=i(7002),nx=i(7527),ny=i(1090);let nv=({children:e,toggleMenu:t})=>{let{t:i}=(0,eL.s)();return(0,eU.jsx)(m.A,{sx:{flexGrow:1},children:(0,eU.jsx)(nx.A,{position:"static",children:(0,eU.jsxs)(ny.A,{children:[(0,eU.jsx)(t6.A,{size:"large",edge:"start",color:"inherit","aria-label":i("navigation.menu","menu"),sx:{mr:2},onClick:t,children:(0,eU.jsx)(nu.A,{})}),(0,eU.jsx)(tu.A,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:i("app.title","Wardley Maps")}),e]})})})},ng=(0,tD.Ay)(nm.A)(({theme:e})=>({"& .MuiPaper-root":{borderRadius:6,marginTop:e.spacing(1),minWidth:180,color:"light"===e.palette.mode?"rgb(55, 65, 81)":e.palette.grey[300],boxShadow:"rgb(255, 255, 255) 0px 0px 0px 0px, rgba(0, 0, 0, 0.05) 0px 0px 0px 1px, rgba(0, 0, 0, 0.1) 0px 10px 15px -3px, rgba(0, 0, 0, 0.05) 0px 4px 6px -2px","& .MuiMenu-list":{padding:"4px 0"},"& .MuiMenuItem-root":{"& .MuiSvgIcon-root":{fontSize:18,color:e.palette.text.secondary,marginRight:e.spacing(1.5)},"&:active":{backgroundColor:(0,nh.X4)(e.palette.primary.main,e.palette.action.selectedOpacity)}}}})),nf=({saveOutstanding:e,saveMapClick:t,mutateMapText:i,newMapClick:n,downloadMapImage:o,currentUrl:s,setShowLineNumbers:a,showLineNumbers:r,setShowLinkedEvolved:m,showLinkedEvolved:y,downloadMapAsSVG:v,setMapOnlyView:g,mapOnlyView:f,toggleMenu:b})=>{let[k,j]=(0,l.useState)(),[E,C]=(0,l.useState)(!1),{t:A}=(0,eL.s)(),T=(0,l.useRef)(null),L=()=>{let e=s.replace("#","#clone:");navigator.clipboard.writeText(e)},M=!!k,D=e=>{e&&e(),j(null)},N=(0,eU.jsxs)(ng,{id:"more-menu",MenuListProps:{"aria-labelledby":"more-menu-button"},anchorEl:k,open:M,onClose:()=>{j(null)},children:[(0,eU.jsx)(tr.A,{disableRipple:!0,onClick:()=>D(()=>C(!0)),children:A("header.getCloneUrl","Get Clone URL")}),(0,eU.jsx)(no.A,{}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>o()),disableRipple:!0,children:A("export.png","Download as PNG")}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>v()),disableRipple:!0,children:A("export.svg","Download as SVG")}),(0,eU.jsx)(no.A,{}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>a(!r)),disableRipple:!0,children:r?A("header.hideLineNumbers","Hide Line Numbers"):A("header.showLineNumbers","Show Line Numbers")}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>m(!y)),disableRipple:!0,children:y?A("header.hideEvolvedLinks","Hide Evolved Links"):A("header.showEvolvedLinks","Show Evolved Links")}),(0,eU.jsx)(no.A,{}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>window.open("https://docs.onlinewardleymaps.com")),disableRipple:!0,children:A("header.usageGuide","Usage Guide")}),(0,eU.jsx)(no.A,{}),(0,eU.jsx)(tr.A,{onClick:()=>D(()=>window.open("https://www.patreon.com/mapsascode")),disableRipple:!0,children:A("header.becomePatron","Become a Patron ❤️")})]});return(0,eU.jsxs)(nv,{toggleMenu:b,children:[(0,eU.jsxs)(nc.A,{direction:"row",alignItems:"flex-start",spacing:.5,divider:(0,eU.jsx)(no.A,{orientation:"vertical",flexItem:!0}),children:[(0,eU.jsx)(x.A,{color:"inherit",size:"small",onClick:()=>g(!f),children:f?A("header.editorMode","Editor Mode"):A("header.presentationMode","Presentation Mode")}),(0,eU.jsx)(x.A,{color:"inherit",size:"small",onClick:()=>{i(S)},children:A("header.exampleMap","Example Map")}),(0,eU.jsx)(x.A,{color:"inherit",size:"small",variant:"text",id:"new-menu-button",onClick:()=>n(w.Legacy),children:A("common.new","New")}),(0,eU.jsx)(x.A,{color:e?"error":"inherit",size:"small",onClick:t,variant:e?"outlined":"text",sx:e?{backgroundColor:"#d32f2f",color:"white"}:null,children:A("common.save","Save")}),(0,eU.jsx)(x.A,{color:"inherit",size:"small",variant:"text",onClick:e=>{j(e.currentTarget)},id:"more-menu-button","aria-controls":M?"more-menu":void 0,"aria-haspopup":"true","aria-expanded":M?"true":void 0,children:(0,eU.jsx)(nd.A,{})})]}),N,(0,eU.jsxs)(p.A,{open:E,onClose:()=>C(!1),children:[(0,eU.jsx)(d.A,{children:A("sharing.cloneUrl","Clone URL")}),(0,eU.jsxs)(c.A,{children:[(0,eU.jsx)(h.A,{children:A("sharing.cloneDescription","You can share this URL with others to allow them to create a new map using this map as its initial state.")}),(0,eU.jsx)(ts.A,{autoFocus:!0,margin:"dense",ref:T,id:"name",label:A("sharing.url","URL"),fullWidth:!0,variant:"standard",value:s.replace("#","#clone:")}),(0,eU.jsx)(x.A,{onClick:()=>L(),children:A("sharing.copy","Copy")})]}),(0,eU.jsxs)(u.A,{children:[(0,eU.jsx)(x.A,{onClick:()=>C(!1),children:A("common.cancel","Cancel")}),(0,eU.jsx)(x.A,{onClick:t,children:A("map.saveMap","Save Map")})]})]})]})},nb=[{title:"To set the title",summary:"",examples:["title My Wardley Map"]},{toolbarButtonText:"Create Component",Icon:e3,title:"To create a component",summary:"component Name [Visibility (Y Axis), Maturity (X Axis)]",examples:["component Customer [0.9, 0.5]","component Cup of Tea [0.9, 0.5]"]},{toolbarButtonText:"Inertia",Icon:e6,title:"Inertia - component likely to face resistance to change.",summary:"component Name [Visibility (Y Axis), Maturity (X Axis)] inertia",examples:["component Customer [0.95, 0.5] inertia","component Cup of Tea [0.9, 0.5] inertia"]},{Icon:e8,title:"To evolve a component",summary:"evole Name (X Axis)",examples:["evolve Physical 0.8","evolve Cup of Tea evolve 0.8"]},{Icon:e8,title:"To evolve a component with new name",summary:"evole Name->NewName (X Axis)",examples:["evolve Physical->Virtual 0.8"]},{title:"To link components",summary:"",examples:["Start Component->End Component","Customer->Cup of Tea"]},{title:"To indicate flow",summary:"",examples:["Start Component+<>End Component","Customer+<>Cup of Tea"]},{toolbarButtonText:"Create Market",Icon:e3,title:"To create a market",summary:"component Name [Visibility (Y Axis), Maturity (X Axis)] (market)",examples:["component Customer [0.9, 0.5] (market)","component Cup of Tea [0.9, 0.5] (market)","evolve Customer 0.9 (market)"]},{title:"To set component as pipeline:",summary:"pipeline Component Name [X Axis (start), X Axis (end)]",examples:["pipeline Customer [0.15, 0.9]","pipeline Customer"]},{title:"To indicate flow - past components only",summary:"",examples:["Start Component+<End Component","Hot Water+<Kettle"]},{title:"To indicate flow - future components only",summary:"",examples:["Start Component+>End Component","Hot Water+>Kettle"]},{title:"To indicate flow - with label",summary:"",examples:["Start Component+'insert text'>End Component","Hot Water+'$0.10'>Kettle"]},{title:"Pioneers, Settlers, Townplanners area",summary:"Add areas indicating which type of working approach supports component development",examples:["pioneers [<visibility>, <maturity>, <visibility2>, <maturity2>]","settlers [0.59, 0.43, 0.49, 0.63]","townplanners [0.31, 0.74, 0.15, 0.95]"]},{title:"Build, buy, outsource components",summary:"Highlight a component with a build, buy, or outsource method of execution",examples:["component Customer [0.9, 0.2] (buy)","component Customer [0.9, 0.2] (build)","component Customer [0.9, 0.2] (outsource)","evolve Customer 0.9 (outsource)","evolve Customer 0.9 (buy)","evolve Customer 0.9 (build)"]},{title:"Link submap to a component",summary:"Add a reference link to a submap. A component becomes a link to another Wardley Map",examples:["submap Component [<visibility>, <maturity>] url(urlName)","url urlName [URL]","submap Website [0.83, 0.50] url(submapUrl)","url submapUrl [https://onlinewardleymaps.com/#clone:qu4VDDQryoZEnuw0ZZ]"]},{title:"Stages of Evolution",summary:"Change the stages of evolution labels on the map",examples:["evolution First->Second->Third->Fourth","evolution Novel->Emerging->Good->Best"]},{title:"Add notes",summary:"Add text to any part of the map",examples:["note Note Text [0.9, 0.5]","note +future development [0.9, 0.5]"]},{title:"Available styles",summary:"Change the look and feel of a map",examples:["style wardley","style handwritten","style colour","style dark"]},{title:"Accelerator/Deaccelerator",summary:"An attempt to alter the map",examples:["accelerator foobar [0.1, 0.8]","deaccelerator barbaz [0.2, 0.7]"]}],nk=e=>{let{Icon:t,mapStyleDefs:i}=e,{t:n}=(0,eL.s)();return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsx)(tu.A,{variant:"h3",children:n(`editor.usages.${e.title.toLowerCase().replace(/\s+/g,"_")}`,e.title)}),e.summary.length>0?(0,eU.jsxs)(tu.A,{variant:"body1",children:[n(`editor.usages.${e.summary.toLowerCase().replace(/\s+/g,"_")}`,e.summary)," "]}):null,(0,eU.jsx)(tu.A,{variant:"h5",children:n("editor.example","Example")}),e.examples&&e.examples.map((t,i)=>(0,eU.jsx)(l.Fragment,{children:(0,eU.jsx)(nw,{addOnClick:e.addOnClick,example:t})},i)),null,(0,eU.jsx)(no.A,{sx:{marginTop:2,marginBottom:2}})]})},nw=e=>(0,eU.jsx)(tu.A,{children:(0,eU.jsx)(tx.A,{sx:{cursor:"pointer"},onClick:()=>e.addOnClick(e.example),className:"add clickable",children:e.example})}),nj=function(e){let t=t=>{let i=e.mapText;i=i+(e.mapText.trim().length>0?"\n":"")+t.trim(),e.mutateMapText(i)};return(0,eU.jsx)(eU.Fragment,{children:nb.map((i,n)=>(0,eU.jsx)(nk,{title:i.title,Icon:i.Icon,mapStyleDefs:e.mapStyleDefs,summary:i.summary,examples:i.examples,addOnClick:t},n))})},nE=({mapText:e,mutateMapText:t,mapStyleDefs:i})=>(0,eU.jsx)("div",{className:"row usage no-gutters",children:(0,eU.jsx)("div",{className:"col",children:(0,eU.jsx)(nj,{mapStyleDefs:i,mapText:e,mutateMapText:t})})});function nC(e,t){let i;return function(...n){clearTimeout(i),i=setTimeout(()=>{i=null,e.apply(this,n)},t)}}let nS=()=>{let e=document.getElementById("map"),t=e?.clientHeight;if(!t||t<100){let e=window.innerHeight;return e-(document.getElementById("top-nav-wrapper")?.clientHeight||0)-(document.getElementById("title")?.clientHeight||0)-65}return Math.max(t-60,400)},nA=()=>{let e=document.getElementById("map"),t=e?.clientWidth;return!t||t<100?Math.max(window.innerWidth-100,800):Math.max(t-10,600)},nT=({toggleMenu:e,menuVisible:t,toggleTheme:i,isLightTheme:n,mapPersistenceStrategy:o,setMapPersistenceStrategy:s,shouldLoad:g,currentId:b,setCurrentId:k,setShouldLoad:S})=>{let A=(0,eR.YY)(),O=(0,l.useRef)(null),{t:F}=(0,eL.s)(),$=eN({mapText:"",showUsage:!1,isLoading:!1,errors:[],mapDimensions:C,mapCanvasDimensions:C,mapStyleDefs:T,mapEvolutionStates:E,highlightedLine:0,newComponentContext:null,showLinkedEvolved:!1}),{state:W,actions:_}=$,I=eW($),[P,z]=(0,l.useState)(""),[H,Y]=(0,l.useState)("Untitled Map"),[R,B]=(0,l.useState)("Untitled Map"),[U,X]=(0,l.useState)(!1),[V,G]=(0,l.useState)({maturity:0,visibility:0}),[K,Z]=(0,l.useState)([]),[q,Q]=(0,l.useState)({width:0,height:0}),[J,ee]=(0,l.useState)("plain"),[et,ei]=(0,l.useState)(!1),[en,eo]=(0,l.useState)([]),[es,ea]=(0,l.useState)(!1),[el,er]=(0,l.useState)(!1),[em,ep]=(0,l.useState)(-1),[ed,ec]=(0,l.useState)(!1),[eh,eu]=(0,l.useState)(!1),ex=e=>{if(I.mutateMapText(e),ei(!0),null!==em&&em>-1){let t=[...K],i=t[em];i.mapText=e,t.splice(em,1),t.splice(em,0,i),Z(t)}},ey=e=>{let t=I.mapUrls.find(t=>t.name===e);t&&window.open(t.url)},ev=()=>{_.setShowUsage(!W.showUsage)},eg=async function(e){ec(!0);let t={mapText:I.mapText,imageData:"",mapIterations:K,readOnly:!1},i=async function(e){""===b&&(console.log("[followOnActions::switch]",{mapPersistenceStrategy:o,currentId:b,id:e}),o===w.Legacy&&(window.location.hash="#"+e)),k(e),ec(!1),z(window.location.href),ei(!1),console.log("saveToPrivateDataStore",{mapPersistenceStrategy:o})};await eY(o,t,e,i)},ef=async function(){ec(!0),z("(loading...)"),console.log("--- Set Load Strategy: ",o),await eP(o,(e,t)=>{s(e),S(!1),I.mutateMapText(t.mapText),t.mapIterations&&t.mapIterations.length>0&&(Z(t.mapIterations),ep(0),I.mutateMapText(t.mapIterations[0].mapText)),z(window.location.href),0===window.location.hash.indexOf("#clone:")&&(z(`(${F("map.unsaved","unsaved")})`),ei(!0),k(""),window.location.hash=""),ei(!1),ec(!1),e===w.Legacy||s(e)},b)};async function eb(){z(`(${F("map.saving","saving...")})`),eg(b)}let ek=(e,t)=>{let i=document.createElement("a");document.body.appendChild(i),i.setAttribute("style","display: none");let n=new Blob([e],{type:"data:attachment/xml"}),o=window.URL.createObjectURL(n);i.href=o,i.download=t,i.click(),window.URL.revokeObjectURL(o)};(0,l.useEffect)(()=>{window.addEventListener("beforeunload",e=>{et&&(e.preventDefault(),e.returnValue="")})}),(0,l.useEffect)(()=>{try{eo([]),X(!1);let e=new eE(A).parse(I.mapText);console.log("MapEnvironment",e),B(e.title),G(e.presentation.annotations),ee(e.presentation.style),Q(e.presentation.size),_.setMapEvolutionStates({genesis:{l1:e.evolution[0].line1,l2:e.evolution[0].line2},custom:{l1:e.evolution[1].line1,l2:e.evolution[1].line2},product:{l1:e.evolution[2].line1,l2:e.evolution[2].line2},commodity:{l1:e.evolution[3].line1,l2:e.evolution[3].line2}}),e.errors.length>0&&eo(e.errors.map(e=>e.line));let t=new eT(A).parse(I.mapText);_.setMap(t)}catch(e){console.log("Error:",e)}},[I.mapText,A,_]),(0,l.useEffect)(()=>{document.title=H+" - OnlineWardleyMaps - Draw Wardley Maps in seconds using this free online tool"},[H]),(0,l.useEffect)(()=>{_.setMapDimensions({width:q.width>0?q.width:100+nA(),height:q.height>0?q.height:nS()})},[el,eh,q,_]),(0,l.useEffect)(()=>{em>-1?Y(R+" ["+K[em].name+"]"):Y(R)},[em,R,K]),(0,l.useEffect)(()=>{switch(J){case"colour":case"color":_.setMapStyleDefs(N);break;case"wardley":_.setMapStyleDefs(M);break;case"dark":_.setMapStyleDefs(D);break;case"handwritten":_.setMapStyleDefs(L);break;default:_.setMapStyleDefs(T)}},[J,_]),(0,l.useEffect)(()=>{g&&ef()},[g]),(0,l.useEffect)(()=>{let e=nC(()=>{let e={width:q.width>0?q.width:100+nA(),height:q.height>0?q.height:nS()};_.setMapDimensions(e)},1),t=t=>{t.isTrusted&&e()};return window.addEventListener("resize",t),e(),function(){window.removeEventListener("resize",t)}},[q,_]),(0,l.useEffect)(()=>{let e={width:q.width>0?q.width:100+nA(),height:q.height>0?q.height:nS()};_.setMapDimensions(e),_.setMapCanvasDimensions({width:nA(),height:nS()})},[el,eh,_]),(0,l.useEffect)(()=>{let e=()=>{_.setMapCanvasDimensions({width:nA(),height:nS()})},t=nC(()=>{_.setMapCanvasDimensions({width:nA(),height:nS()})},500),i=e=>{setTimeout(()=>{let e=nA(),t=nS(),i={width:q.width>0?q.width:100+e,height:q.height>0?q.height:t};_.setMapDimensions(i),_.setMapCanvasDimensions({width:e,height:t})},200)},n=e=>{e.isTrusted&&t()};return window.addEventListener("load",e),window.addEventListener("resize",n),window.addEventListener("panelResize",i),function(){window.removeEventListener("resize",n),window.removeEventListener("load",e),window.removeEventListener("panelResize",i)}},[_]);let ew=[{name:W.showUsage?F("editor.hideUsage","Hide Usage"):F("editor.showUsage","Show Usage"),icon:(0,eU.jsx)(r.A,{}),action:()=>{ev()}}],ej=()=>{eu(!eh)};return(0,eU.jsxs)(m.A,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[(0,eU.jsx)(np,{toggleMenu:e,menuVisible:t,submenu:ew,toggleTheme:i,isLightTheme:n}),(0,eU.jsxs)(m.A,{id:"top-nav-wrapper",sx:{display:eh?"none":"block",flexShrink:0},children:[(0,eU.jsx)(nf,{mapOnlyView:el,setMapOnlyView:er,currentUrl:P,saveOutstanding:et,mutateMapText:ex,newMapClick:function(e){I.mutateMapText(""),k(""),z(`(${F("map.unsaved","unsaved")})`),ei(!1),ep(-1),Z([]),s(e),a().push({pathname:"/"},void 0,{shallow:!0})},saveMapClick:eb,downloadMapImage:function(){if(null===O.current)return;let e=O.current.getElementsByTagName("svg")[0].outerHTML,t=document.createElement("div");t.innerHTML=e,t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),f()(t,{useCORS:!0,allowTaint:!0}).then(e=>{let i=e.toDataURL("image/png"),n=document.createElement("a");n.download=H,n.href=i,n.click(),t.remove()}).catch(e=>{t.remove()})},showLineNumbers:es,setShowLineNumbers:ea,showLinkedEvolved:I.showLinkedEvolved,setShowLinkedEvolved:I.setShowLinkedEvolved,downloadMapAsSVG:function(){if(null===O.current)return;let e=O.current.getElementsByTagName("svg")[0].outerHTML.replace(/&nbsp;/g," ").replace(/<svg([^>]*)>/,'<svg xmlns="http://www.w3.org/2000/svg"$1>');ek(`<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">${e}`,`${H}.svg`)},toggleMenu:e}),(0,eU.jsx)(ty,{currentUrl:P}),(0,eU.jsx)(tN,{mapIterations:K,currentIteration:em,setMapIterations:Z,setMapText:I.mutateMapText,addIteration:()=>{let e=[...K];e.push({name:`Iteration ${e.length+1}`,mapText:I.mapText}),Z(e)},setCurrentIteration:ep})]}),(0,eU.jsx)(m.A,{sx:{flexGrow:1,height:"100%",overflow:"hidden"},children:!1===el?(0,eU.jsx)(th,{defaultLeftWidth:33,minLeftWidth:20,maxLeftWidth:60,storageKey:"wardleyMapEditor_splitPaneWidth",isDarkTheme:!n,leftPanel:(0,eU.jsx)(tw,{wardleyMap:$.getUnifiedMap(),hideNav:eh,isLightTheme:n,highlightLine:I.highlightedLine,mapText:I.mapText,invalid:U,mutateMapText:ex,errorLine:en,showLineNumbers:es}),rightPanel:(0,eU.jsx)(m.A,{className:"map-view",sx:{backgroundColor:I.mapStyleDefs.containerBackground,width:"100%",height:"100%"},children:(0,eU.jsx)(eB.Zw,{children:(0,eU.jsx)(i4,{wardleyMap:$.getUnifiedMap(),shouldHideNav:ej,hideNav:eh,mapTitle:H,mapAnnotationsPresentation:V,mapStyleDefs:I.mapStyleDefs,mapCanvasDimensions:I.mapCanvasDimensions,mapDimensions:I.mapDimensions,mapEvolutionStates:I.mapEvolutionStates,mapRef:O,mapText:I.mapText,mutateMapText:ex,evolutionOffsets:j,launchUrl:ey,setHighlightLine:I.setHighlightLine,setNewComponentContext:I.setNewComponentContext,showLinkedEvolved:I.showLinkedEvolved})})})}):(0,eU.jsx)(m.A,{className:"map-view",sx:{backgroundColor:I.mapStyleDefs.containerBackground,width:"100%",height:"100%"},children:(0,eU.jsx)(eB.Zw,{children:(0,eU.jsx)(i4,{wardleyMap:$.getUnifiedMap(),shouldHideNav:ej,hideNav:eh,mapTitle:H,mapAnnotationsPresentation:V,mapStyleDefs:I.mapStyleDefs,mapCanvasDimensions:I.mapCanvasDimensions,mapDimensions:I.mapDimensions,mapEvolutionStates:I.mapEvolutionStates,mapRef:O,mapText:I.mapText,mutateMapText:ex,evolutionOffsets:j,launchUrl:ey,setHighlightLine:I.setHighlightLine,setNewComponentContext:I.setNewComponentContext,showLinkedEvolved:I.showLinkedEvolved})})})}),(0,eU.jsxs)(p.A,{maxWidth:"lg",open:W.showUsage,onClose:()=>_.setShowUsage(!1),children:[(0,eU.jsx)(d.A,{children:F("editor.usage","Usage")}),(0,eU.jsxs)(c.A,{children:[(0,eU.jsx)(h.A,{children:F("editor.usageDescription","Quick reference of all available map elements. You can add an example to your map by clicking the available links.")}),(0,eU.jsx)(m.A,{marginTop:2,children:(0,eU.jsx)(nE,{mapStyleDefs:I.mapStyleDefs,mutateMapText:ex,mapText:I.mapText})})]}),(0,eU.jsx)(u.A,{children:(0,eU.jsx)(x.A,{onClick:()=>_.setShowUsage(!1),children:F("common.close","Close")})})]}),(0,eU.jsx)(tc,{newComponentContext:I.newComponentContext,mutateMapText:ex,setNewComponentContext:I.setNewComponentContext,mapText:I.mapText,mapStyleDefs:I.mapStyleDefs}),(0,eU.jsx)(y.A,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:ed,children:(0,eU.jsx)(v.A,{color:"inherit"})})]})};var nL=!0;let nM=e=>{let t=(0,s.useRouter)(),{slug:i}=t.query,{t:n,currentLanguage:a}=(0,eL.s)(),[r,m]=(0,l.useState)(""),[p,d]=(0,l.useState)(w.Legacy),[c,h]=(0,l.useState)(!1);(0,l.useEffect)(()=>{"undefined"!=typeof document&&(document.documentElement.lang=a)},[a]),(0,l.useEffect)(()=>{if(void 0===i){if(window.location.hash.length>0){d(w.Legacy);let e=window.location.hash.replace("#","");e.includes(":")&&(e=e.split(":")[1]),m(e),h(!0)}return}},[i]);let u=`${n("app.title","Wardley Maps")} - ${n("app.name","Online Wardley Maps")}`,x=n("app.description","Create and share Wardley Maps online");return(0,eU.jsxs)(eU.Fragment,{children:[(0,eU.jsxs)(o(),{children:[(0,eU.jsx)("title",{children:u}),(0,eU.jsx)("meta",{name:"description",content:x}),(0,eU.jsx)("meta",{property:"og:title",content:u}),(0,eU.jsx)("meta",{property:"og:description",content:x}),(0,eU.jsx)("meta",{property:"og:locale",content:a}),(0,eU.jsx)("meta",{name:"twitter:title",content:u}),(0,eU.jsx)("meta",{name:"twitter:description",content:x}),(0,eU.jsx)("link",{rel:"canonical",href:`https://onlinewardleymaps.com${t.asPath}`})]}),(0,eU.jsx)(nT,{toggleMenu:e.toggleMenu,toggleTheme:e.toggleTheme,menuVisible:e.menuVisible,isLightTheme:e.isLightTheme,currentId:r,setCurrentId:m,mapPersistenceStrategy:p,setMapPersistenceStrategy:d,shouldLoad:c,setShouldLoad:h})]})}},6760:(e,t,i)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(1675)}])}},e=>{var t=t=>e(e.s=t);e.O(0,[366,636,792],()=>t(6760)),_N_E=e.O()}]);